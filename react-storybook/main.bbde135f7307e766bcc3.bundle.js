/*! For license information please see main.bbde135f7307e766bcc3.bundle.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1049:function(module,exports){},1051:function(module,exports){},1083:function(module,exports){},1085:function(module,exports){},1086:function(module,exports){},1091:function(module,exports){},1093:function(module,exports){},1100:function(module,exports){},1102:function(module,exports){},1120:function(module,exports){},1123:function(module,exports){},1139:function(module,exports){},1142:function(module,exports){},1148:function(module,exports){},1150:function(module,exports){},1171:function(module,exports){},1172:function(module,exports){},1193:function(module,exports){},1195:function(module,exports){},1335:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(119),_src_balance__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(199),_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(34),_taquito_taquito__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(90),_src_tezos_context__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(65),stories=Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("Balance component",module);function createTK(){var tk=new _taquito_taquito__WEBPACK_IMPORTED_MODULE_4__.b;return tk.setProvider({rpc:"https://api.tez.ie/rpc/mainnet"}),tk}stories.addDecorator(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.withKnobs),stories.add("default",(function(){var tk=createTK();return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_tezos_context__WEBPACK_IMPORTED_MODULE_5__.a.Provider,{value:tk},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_balance__WEBPACK_IMPORTED_MODULE_2__.a,{format:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.select)("Format",{None:void 0,"mꜩ":"mtz","ꜩ":"tz"},void 0),address:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.text)("Address","KT1SawqvsVdAbDzqc4KwPpaS1S1veuFgF9AN")}))})),stories.add("mꜩ formatted",(function(){var tk=createTK();return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_tezos_context__WEBPACK_IMPORTED_MODULE_5__.a.Provider,{value:tk},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_balance__WEBPACK_IMPORTED_MODULE_2__.a,{format:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.select)("Format",{None:void 0,"mꜩ":"mtz","ꜩ":"tz"},"mtz"),address:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.text)("Address","KT1SawqvsVdAbDzqc4KwPpaS1S1veuFgF9AN")}))})),stories.add("ꜩ formatted",(function(){var tk=createTK();return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_tezos_context__WEBPACK_IMPORTED_MODULE_5__.a.Provider,{value:tk},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_balance__WEBPACK_IMPORTED_MODULE_2__.a,{format:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.select)("Format",{None:void 0,"mꜩ":"mtz","ꜩ":"tz"},"tz"),address:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.text)("Address","KT1SawqvsVdAbDzqc4KwPpaS1S1veuFgF9AN")}))})),stories.add("Errored",(function(){var tk=createTK();return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_tezos_context__WEBPACK_IMPORTED_MODULE_5__.a.Provider,{value:tk},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_balance__WEBPACK_IMPORTED_MODULE_2__.a,{address:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.text)("Address","KT1SawqvsVdAbDzqc4KwPpaS1S1veuFgF9A")}))}))}.call(this,__webpack_require__(295)(module))},194:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(process){var STATUS_CODE;__webpack_require__.d(__webpack_exports__,"a",(function(){return HttpBackend})),__webpack_require__.d(__webpack_exports__,"b",(function(){return HttpResponseError})),__webpack_require__.d(__webpack_exports__,"c",(function(){return STATUS_CODE})),function(STATUS_CODE){STATUS_CODE[STATUS_CODE.CONTINUE=100]="CONTINUE",STATUS_CODE[STATUS_CODE.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",STATUS_CODE[STATUS_CODE.PROCESSING=102]="PROCESSING",STATUS_CODE[STATUS_CODE.OK=200]="OK",STATUS_CODE[STATUS_CODE.CREATED=201]="CREATED",STATUS_CODE[STATUS_CODE.ACCEPTED=202]="ACCEPTED",STATUS_CODE[STATUS_CODE.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",STATUS_CODE[STATUS_CODE.NO_CONTENT=204]="NO_CONTENT",STATUS_CODE[STATUS_CODE.RESET_CONTENT=205]="RESET_CONTENT",STATUS_CODE[STATUS_CODE.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",STATUS_CODE[STATUS_CODE.MULTI_STATUS=207]="MULTI_STATUS",STATUS_CODE[STATUS_CODE.ALREADY_REPORTED=208]="ALREADY_REPORTED",STATUS_CODE[STATUS_CODE.IM_USED=226]="IM_USED",STATUS_CODE[STATUS_CODE.MULTIPLE_CHOICES=300]="MULTIPLE_CHOICES",STATUS_CODE[STATUS_CODE.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",STATUS_CODE[STATUS_CODE.FOUND=302]="FOUND",STATUS_CODE[STATUS_CODE.SEE_OTHER=303]="SEE_OTHER",STATUS_CODE[STATUS_CODE.NOT_MODIFIED=304]="NOT_MODIFIED",STATUS_CODE[STATUS_CODE.USE_PROXY=305]="USE_PROXY",STATUS_CODE[STATUS_CODE.SWITCH_PROXY=306]="SWITCH_PROXY",STATUS_CODE[STATUS_CODE.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",STATUS_CODE[STATUS_CODE.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",STATUS_CODE[STATUS_CODE.BAD_REQUEST=400]="BAD_REQUEST",STATUS_CODE[STATUS_CODE.UNAUTHORIZED=401]="UNAUTHORIZED",STATUS_CODE[STATUS_CODE.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",STATUS_CODE[STATUS_CODE.FORBIDDEN=403]="FORBIDDEN",STATUS_CODE[STATUS_CODE.NOT_FOUND=404]="NOT_FOUND",STATUS_CODE[STATUS_CODE.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",STATUS_CODE[STATUS_CODE.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",STATUS_CODE[STATUS_CODE.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",STATUS_CODE[STATUS_CODE.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",STATUS_CODE[STATUS_CODE.CONFLICT=409]="CONFLICT",STATUS_CODE[STATUS_CODE.GONE=410]="GONE",STATUS_CODE[STATUS_CODE.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",STATUS_CODE[STATUS_CODE.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",STATUS_CODE[STATUS_CODE.PAYLOAD_TOO_LARGE=413]="PAYLOAD_TOO_LARGE",STATUS_CODE[STATUS_CODE.URI_TOO_LONG=414]="URI_TOO_LONG",STATUS_CODE[STATUS_CODE.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",STATUS_CODE[STATUS_CODE.RANGE_NOT_SATISFIABLE=416]="RANGE_NOT_SATISFIABLE",STATUS_CODE[STATUS_CODE.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",STATUS_CODE[STATUS_CODE.I_AM_A_TEAPOT=418]="I_AM_A_TEAPOT",STATUS_CODE[STATUS_CODE.MISDIRECTED_REQUEST=421]="MISDIRECTED_REQUEST",STATUS_CODE[STATUS_CODE.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",STATUS_CODE[STATUS_CODE.LOCKED=423]="LOCKED",STATUS_CODE[STATUS_CODE.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",STATUS_CODE[STATUS_CODE.UPGRADE_REQUIRED=426]="UPGRADE_REQUIRED",STATUS_CODE[STATUS_CODE.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",STATUS_CODE[STATUS_CODE.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",STATUS_CODE[STATUS_CODE.REQUEST_HEADER_FIELDS_TOO_LARGE=431]="REQUEST_HEADER_FIELDS_TOO_LARGE",STATUS_CODE[STATUS_CODE.UNAVAILABLE_FOR_LEGAL_REASONS=451]="UNAVAILABLE_FOR_LEGAL_REASONS",STATUS_CODE[STATUS_CODE.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",STATUS_CODE[STATUS_CODE.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",STATUS_CODE[STATUS_CODE.BAD_GATEWAY=502]="BAD_GATEWAY",STATUS_CODE[STATUS_CODE.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",STATUS_CODE[STATUS_CODE.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",STATUS_CODE[STATUS_CODE.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",STATUS_CODE[STATUS_CODE.VARIANT_ALSO_NEGOTIATES=506]="VARIANT_ALSO_NEGOTIATES",STATUS_CODE[STATUS_CODE.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",STATUS_CODE[STATUS_CODE.LOOP_DETECTED=508]="LOOP_DETECTED",STATUS_CODE[STATUS_CODE.NOT_EXTENDED=510]="NOT_EXTENDED",STATUS_CODE[STATUS_CODE.NETWORK_AUTHENTICATION_REQUIRED=511]="NETWORK_AUTHENTICATION_REQUIRED"}(STATUS_CODE||(STATUS_CODE={}));var XMLHttpRequestCTOR=void 0!==process&&null!=process.versions&&null!=process.versions.node?__webpack_require__(978).XMLHttpRequest:XMLHttpRequest,HttpResponseError=function HttpResponseError(message,status,statusText,body,url){this.message=message,this.status=status,this.statusText=statusText,this.body=body,this.url=url,this.name="HttpResponse"},HttpRequestFailed=function HttpRequestFailed(url,innerEvent){this.url=url,this.innerEvent=innerEvent,this.name="HttpRequestFailed",this.message="Request to "+url+" failed"},HttpBackend=function(){function HttpBackend(){}return HttpBackend.prototype.serialize=function(obj){if(!obj)return"";var str=[],_loop_1=function(p){if(obj.hasOwnProperty(p)&&obj[p]){var prop="function"==typeof obj[p].toJSON?obj[p].toJSON():obj[p];if(null===prop)return str.push(encodeURIComponent(p)),"continue";if(Array.isArray(prop))return prop.forEach((function(item){str.push(encodeURIComponent(p)+"="+encodeURIComponent(item))})),"continue";str.push(encodeURIComponent(p)+"="+encodeURIComponent(prop))}};for(var p in obj)_loop_1(p);var serialized=str.join("&");return serialized?"?"+serialized:""},HttpBackend.prototype.createXHR=function(){return new XMLHttpRequestCTOR},HttpBackend.prototype.createRequest=function(_a,data){var _this=this,url=_a.url,method=_a.method,timeout=_a.timeout,query=_a.query,_b=_a.headers,headers=void 0===_b?{}:_b,_c=_a.json,json=void 0===_c||_c;return new Promise((function(resolve,reject){var request=_this.createXHR();for(var k in request.open(method||"GET",""+url+_this.serialize(query)),request.setRequestHeader("Content-Type","application/json"),headers)request.setRequestHeader(k,headers[k]);if(request.timeout=timeout||3e4,request.onload=function(){if(this.status>=200&&this.status<300)if(json)try{resolve(JSON.parse(request.response))}catch(ex){reject(new Error("Unable to parse response: "+request.response))}else resolve(request.response);else reject(new HttpResponseError("Http error response: ("+this.status+") "+request.response,this.status,request.statusText,request.response,url))},request.ontimeout=function(){reject(new Error("Request timed out after: "+request.timeout+"ms"))},request.onerror=function(err){reject(new HttpRequestFailed(url,err))},data){var dataStr=JSON.stringify(data);request.send(dataStr)}else request.send()}))},HttpBackend}()}).call(this,__webpack_require__(9))},196:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return tzFormatter}));var bignumber_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(634),bignumber_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(bignumber_js__WEBPACK_IMPORTED_MODULE_0__),_taquito_taquito__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(90);function tzFormatter(amount,format){var bigNum=new bignumber_js__WEBPACK_IMPORTED_MODULE_0___default.a(amount);return bigNum.isNaN()?amount:"tz"===format?_taquito_taquito__WEBPACK_IMPORTED_MODULE_1__.a.format("mutez","tz",amount)+" ꜩ":"mtz"===format?_taquito_taquito__WEBPACK_IMPORTED_MODULE_1__.a.format("mutez","mtz",amount)+" mꜩ":bigNum.toString()}},199:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Balance}));var extendStatics,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_tezos_context__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(65),_format__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(196),__extends=(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},Balance=function(_super){function Balance(props){var _this=_super.call(this,props)||this;return _this.state={balance:null,error:!1},_this}return __extends(Balance,_super),Balance.prototype.refreshBalance=function(){return __awaiter(this,void 0,void 0,(function(){var balance;return __generator(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,this.context.tz.getBalance(this.props.address)];case 1:return balance=_a.sent(),this.setState({balance:balance,error:!1}),[3,3];case 2:return _a.sent(),this.setState({error:!0}),[3,3];case 3:return[2]}}))}))},Balance.prototype.componentDidMount=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,this.refreshBalance()];case 1:return _a.sent(),[2]}}))}))},Balance.prototype.componentDidUpdate=function(prevProps){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return prevProps.address===this.props.address?[3,2]:[4,this.refreshBalance()];case 1:_a.sent(),_a.label=2;case 2:return[2]}}))}))},Balance.prototype.render=function(){return this.state.error?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Error fetching balance"):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,Object(_format__WEBPACK_IMPORTED_MODULE_2__.a)(this.state.balance||"",this.props.format))},Balance.contextType=_tezos_context__WEBPACK_IMPORTED_MODULE_1__.a,Balance}(react__WEBPACK_IMPORTED_MODULE_0___default.a.Component)},498:function(module,exports){},619:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return BalanceHistory}));var extendStatics,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_tezos_context__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(65),recharts__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(123),_format__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(196),__extends=(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}},BalanceHistory=function(_super){function BalanceHistory(props){var _this=_super.call(this,props)||this;return _this.state={error:!1},_this}return __extends(BalanceHistory,_super),BalanceHistory.prototype.refreshBalance=function(){return __awaiter(this,void 0,void 0,(function(){var _a,value,timestamp_1,values;return __generator(this,(function(_b){switch(_b.label){case 0:return _b.trys.push([0,2,,3]),[4,this.context.query.balanceHistory(this.props.address,{start:new Date(this.props.start),end:new Date(this.props.end)})];case 1:return _a=_b.sent(),value=_a.value,timestamp_1=_a.timestamp,values=value.map((function(val,i){return{value:val,timestamp:timestamp_1[i]}})).sort((function(_a,_b){return _a.timestamp1<_b.timestamp2?1:-1})),this.setState({balance:values,error:!1}),[3,3];case 2:return _b.sent(),this.setState({error:!0}),[3,3];case 3:return[2]}}))}))},BalanceHistory.prototype.componentDidMount=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,this.refreshBalance()];case 1:return _a.sent(),[2]}}))}))},BalanceHistory.prototype.componentDidUpdate=function(prevProps){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return prevProps.end===this.props.end&&prevProps.address===this.props.address&&prevProps.start===this.props.start?[3,2]:[4,this.refreshBalance()];case 1:_a.sent(),_a.label=2;case 2:return[2]}}))}))},BalanceHistory.prototype.render=function(){return this.state.error?react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,"Error fetching balance"):react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(recharts__WEBPACK_IMPORTED_MODULE_2__.c,{width:"100%",height:400},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(recharts__WEBPACK_IMPORTED_MODULE_2__.b,{data:this.state.balance},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(recharts__WEBPACK_IMPORTED_MODULE_2__.e,{dataKey:"timestamp"}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(recharts__WEBPACK_IMPORTED_MODULE_2__.d,{formatter:function(val){return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span",null,Object(_format__WEBPACK_IMPORTED_MODULE_3__.a)(val,"tz"))}}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(recharts__WEBPACK_IMPORTED_MODULE_2__.f,{tickFormatter:function(val){return Object(_format__WEBPACK_IMPORTED_MODULE_3__.a)(val,"tz")}}),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(recharts__WEBPACK_IMPORTED_MODULE_2__.a,{type:"monotone",dataKey:"value",stroke:"#ff7300",yAxisId:0})))},BalanceHistory.contextType=_tezos_context__WEBPACK_IMPORTED_MODULE_1__.a,BalanceHistory}(react__WEBPACK_IMPORTED_MODULE_0___default.a.Component)},635:function(module,__webpack_exports__,__webpack_require__){"use strict";var _storybook_theming__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(636);__webpack_exports__.a=Object(_storybook_theming__WEBPACK_IMPORTED_MODULE_0__.create)({base:"light",brandTitle:"Taquito react components demo"})},65:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return TezosContext}));var _taquito_taquito__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(90),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1),TezosContext=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__).a.createContext(new _taquito_taquito__WEBPACK_IMPORTED_MODULE_0__.b)},669:function(module,exports,__webpack_require__){__webpack_require__(670),__webpack_require__(820),module.exports=__webpack_require__(821)},736:function(module,exports){},821:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(119),_theme__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(635),req=__webpack_require__(976);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.addParameters)({options:{theme:_theme__WEBPACK_IMPORTED_MODULE_1__.a}}),Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.configure)((function loadStories(){req.keys().forEach(req)}),module)}.call(this,__webpack_require__(295)(module))},90:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Tezos})),__webpack_require__.d(__webpack_exports__,"b",(function(){return taquito_es5_TezosToolkit}));var taquito_http_utils_es5=__webpack_require__(194),bignumber=__webpack_require__(52),bignumber_default=__webpack_require__.n(bignumber),__assign=function(){return(__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}function __awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))}function __generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}var OpKind,getByPath=__webpack_require__(1001),setByPath=__webpack_require__(1040);!function(OpKind){OpKind.ORIGINATION="origination",OpKind.DELEGATION="delegation",OpKind.REVEAL="reveal",OpKind.TRANSACTION="transaction",OpKind.ACTIVATION="activate_account",OpKind.ENDORSEMENT="endorsement",OpKind.SEED_NONCE_REVELATION="seed_nonce_revelation",OpKind.DOUBLE_ENDORSEMENT_EVIDENCE="double_endorsement_evidence",OpKind.DOUBLE_BAKING_EVIDENCE="double_baking_evidence",OpKind.PROPOSALS="proposals",OpKind.BALLOT="ballot"}(OpKind||(OpKind={}));var taquito_utils_es5_a,taquito_utils_es5_b,Prefix,defaultRPCOptions={block:"head"},taquito_rpc_es5_RpcClient=function(){function RpcClient(url,chain,httpBackend){void 0===url&&(url="https://api.tez.ie/rpc/mainnet"),void 0===chain&&(chain="main"),void 0===httpBackend&&(httpBackend=new taquito_http_utils_es5.a),this.url=url,this.chain=chain,this.httpBackend=httpBackend}return RpcClient.prototype.createURL=function(path){return""+this.url.replace(/\/+$/g,"")+path},RpcClient.prototype.getBlockHash=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/hash"),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getLiveBlocks=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/live_blocks"),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getBalance=function(address,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){var balance;return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/context/contracts/"+address+"/balance"),method:"GET"})];case 1:return balance=_b.sent(),[2,new bignumber_default.a(balance)]}}))}))},RpcClient.prototype.getStorage=function(address,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/context/contracts/"+address+"/storage"),method:"GET"})]}))}))},RpcClient.prototype.getScript=function(address,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/context/contracts/"+address+"/script"),method:"GET"})]}))}))},RpcClient.prototype.getContract=function(address,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){var contractResponse;return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/context/contracts/"+address),method:"GET"})];case 1:return contractResponse=_b.sent(),[2,__assign(__assign({},contractResponse),{balance:new bignumber_default.a(contractResponse.balance)})]}}))}))},RpcClient.prototype.getManagerKey=function(address,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/context/contracts/"+address+"/manager_key"),method:"GET"})]}))}))},RpcClient.prototype.getDelegate=function(address,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/context/contracts/"+address+"/delegate"),method:"GET"})]}))}))},RpcClient.prototype.getBigMapKey=function(address,key,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/context/contracts/"+address+"/big_map_get"),method:"POST"},key)]}))}))},RpcClient.prototype.getBigMapExpr=function(id,expr,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/context/big_maps/"+id+"/"+expr),method:"GET"})]}))}))},RpcClient.prototype.getDelegates=function(address,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){var response;return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/context/delegates/"+address),method:"GET"})];case 1:return[2,{deactivated:(response=_b.sent()).deactivated,balance:new bignumber_default.a(response.balance),frozen_balance:new bignumber_default.a(response.frozen_balance),frozen_balance_by_cycle:response.frozen_balance_by_cycle.map((function(_a){var deposit=_a.deposit,fees=_a.fees,rewards=_a.rewards,rest=__rest(_a,["deposit","fees","rewards"]);return __assign(__assign({},rest),{deposit:new bignumber_default.a(deposit),fees:new bignumber_default.a(fees),rewards:new bignumber_default.a(rewards)})})),staking_balance:new bignumber_default.a(response.staking_balance),delegated_contracts:response.delegated_contracts,delegated_balance:new bignumber_default.a(response.delegated_balance),grace_period:response.grace_period}]}}))}))},RpcClient.prototype.getConstants=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){var response,castedResponse;return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/context/constants"),method:"GET"})];case 1:return response=_b.sent(),castedResponse=function castToBigNumber(data,keys){var returnArray=Array.isArray(data);void 0===keys&&(keys=Object.keys(data));var response=returnArray?[]:{};return keys.forEach((function(key){var res,item=getByPath(data,key);if(void 0!==item){if(Array.isArray(item))return res=castToBigNumber(item),void setByPath(response,key,res);res=new bignumber_default.a(item),setByPath(response,key,res)}})),response}(response,["time_between_blocks","hard_gas_limit_per_operation","hard_gas_limit_per_block","proof_of_work_threshold","tokens_per_roll","block_security_deposit","endorsement_security_deposit","block_reward","endorsement_reward","cost_per_byte","hard_storage_limit_per_operation"]),[2,__assign(__assign({},response),castedResponse)]}}))}))},RpcClient.prototype.getBlock=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getBlockHeader=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/header"),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getBlockMetadata=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/metadata"),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getBakingRights=function(args,_a){void 0===args&&(args={});var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/helpers/baking_rights"),method:"GET",query:args})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getEndorsingRights=function(args,_a){void 0===args&&(args={});var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/helpers/endorsing_rights"),method:"GET",query:args})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getBallotList=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/votes/ballot_list"),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getBallots=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/votes/ballots"),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getCurrentPeriodKind=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/votes/current_period_kind"),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getCurrentProposal=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/votes/current_proposal"),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getCurrentQuorum=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/votes/current_quorum"),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getVotesListings=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/votes/listings"),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getProposals=function(_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/votes/proposals"),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.forgeOperations=function(data,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/helpers/forge/operations"),method:"POST"},data)]}))}))},RpcClient.prototype.injectOperation=function(signedOpBytes){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,this.httpBackend.createRequest({url:this.createURL("/injection/operation"),method:"POST"},signedOpBytes)]}))}))},RpcClient.prototype.preapplyOperations=function(ops,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/helpers/preapply/operations"),method:"POST"},ops)];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getEntrypoints=function(contract,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/context/contracts/"+contract+"/entrypoints"),method:"GET"})];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.runOperation=function(op,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_b){switch(_b.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/helpers/scripts/run_operation"),method:"POST"},op)];case 1:return[2,_b.sent()]}}))}))},RpcClient.prototype.getChainId=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/chain_id"),method:"GET"})]}))}))},RpcClient.prototype.packData=function(data,_a){var block=(void 0===_a?defaultRPCOptions:_a).block;return __awaiter(this,void 0,void 0,(function(){var _b,gas,rest,formattedGas,tryBigNumber;return __generator(this,(function(_c){switch(_c.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+block+"/helpers/scripts/pack_data"),method:"POST"},data)];case 1:return _b=_c.sent(),gas=_b.gas,rest=__rest(_b,["gas"]),formattedGas=gas,(tryBigNumber=new bignumber_default.a(gas||"")).isNaN()||(formattedGas=tryBigNumber),[2,__assign({gas:formattedGas},rest)]}}))}))},RpcClient}(),libsodium_wrappers=__webpack_require__(37),libsodium_wrappers_default=__webpack_require__.n(libsodium_wrappers),buffer=__webpack_require__(8);!function(Prefix){Prefix.TZ1="tz1",Prefix.TZ2="tz2",Prefix.TZ3="tz3",Prefix.KT="KT",Prefix.KT1="KT1",Prefix.EDSK2="edsk2",Prefix.SPSK="spsk",Prefix.P2SK="p2sk",Prefix.EDPK="edpk",Prefix.SPPK="sppk",Prefix.P2PK="p2pk",Prefix.EDESK="edesk",Prefix.SPESK="spesk",Prefix.P2ESK="p2esk",Prefix.EDSK="edsk",Prefix.EDSIG="edsig",Prefix.SPSIG="spsig",Prefix.P2SIG="p2sig",Prefix.SIG="sig",Prefix.NET="Net",Prefix.NCE="nce",Prefix.B="b",Prefix.O="o",Prefix.LO="Lo",Prefix.LLO="LLo",Prefix.P="P",Prefix.CO="Co",Prefix.ID="id",Prefix.EXPR="expr",Prefix.TZ="TZ"}(Prefix||(Prefix={}));var taquito_utils_es5_prefix=((taquito_utils_es5_a={})[Prefix.TZ1]=new Uint8Array([6,161,159]),taquito_utils_es5_a[Prefix.TZ2]=new Uint8Array([6,161,161]),taquito_utils_es5_a[Prefix.TZ3]=new Uint8Array([6,161,164]),taquito_utils_es5_a[Prefix.KT]=new Uint8Array([2,90,121]),taquito_utils_es5_a[Prefix.KT1]=new Uint8Array([2,90,121]),taquito_utils_es5_a[Prefix.EDSK]=new Uint8Array([43,246,78,7]),taquito_utils_es5_a[Prefix.EDSK2]=new Uint8Array([13,15,58,7]),taquito_utils_es5_a[Prefix.SPSK]=new Uint8Array([17,162,224,201]),taquito_utils_es5_a[Prefix.P2SK]=new Uint8Array([16,81,238,189]),taquito_utils_es5_a[Prefix.EDPK]=new Uint8Array([13,15,37,217]),taquito_utils_es5_a[Prefix.SPPK]=new Uint8Array([3,254,226,86]),taquito_utils_es5_a[Prefix.P2PK]=new Uint8Array([3,178,139,127]),taquito_utils_es5_a[Prefix.EDESK]=new Uint8Array([7,90,60,179,41]),taquito_utils_es5_a[Prefix.SPESK]=new Uint8Array([9,237,241,174,150]),taquito_utils_es5_a[Prefix.P2ESK]=new Uint8Array([9,48,57,115,171]),taquito_utils_es5_a[Prefix.EDSIG]=new Uint8Array([9,245,205,134,18]),taquito_utils_es5_a[Prefix.SPSIG]=new Uint8Array([13,115,101,19,63]),taquito_utils_es5_a[Prefix.P2SIG]=new Uint8Array([54,240,44,52]),taquito_utils_es5_a[Prefix.SIG]=new Uint8Array([4,130,43]),taquito_utils_es5_a[Prefix.NET]=new Uint8Array([87,82,0]),taquito_utils_es5_a[Prefix.NCE]=new Uint8Array([69,220,169]),taquito_utils_es5_a[Prefix.B]=new Uint8Array([1,52]),taquito_utils_es5_a[Prefix.O]=new Uint8Array([5,116]),taquito_utils_es5_a[Prefix.LO]=new Uint8Array([133,233]),taquito_utils_es5_a[Prefix.LLO]=new Uint8Array([29,159,109]),taquito_utils_es5_a[Prefix.P]=new Uint8Array([2,170]),taquito_utils_es5_a[Prefix.CO]=new Uint8Array([79,179]),taquito_utils_es5_a[Prefix.ID]=new Uint8Array([153,103]),taquito_utils_es5_a[Prefix.EXPR]=new Uint8Array([13,44,64,27]),taquito_utils_es5_a[Prefix.TZ]=new Uint8Array([2,90,121]),taquito_utils_es5_a),prefixLength=((taquito_utils_es5_b={})[Prefix.TZ1]=20,taquito_utils_es5_b[Prefix.TZ2]=20,taquito_utils_es5_b[Prefix.TZ3]=20,taquito_utils_es5_b[Prefix.KT]=20,taquito_utils_es5_b[Prefix.KT1]=20,taquito_utils_es5_b[Prefix.EDPK]=32,taquito_utils_es5_b[Prefix.SPPK]=33,taquito_utils_es5_b[Prefix.P2PK]=33,taquito_utils_es5_b[Prefix.EDSIG]=64,taquito_utils_es5_b[Prefix.SPSIG]=64,taquito_utils_es5_b[Prefix.P2SIG]=64,taquito_utils_es5_b[Prefix.SIG]=64,taquito_utils_es5_b[Prefix.NET]=4,taquito_utils_es5_b[Prefix.B]=32,taquito_utils_es5_b[Prefix.P]=32,taquito_utils_es5_b);function __read(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar}var ValidationResult,bs58check=__webpack_require__(548);function isValidPrefix(value){return"string"==typeof value&&value in taquito_utils_es5_prefix}function validatePrefixedValue(value,prefixes){var match=new RegExp("^("+prefixes.join("|")+")").exec(value);if(!match||0===match.length)return ValidationResult.NO_PREFIX_MATCHED;var prefixKey=match[0];if(!isValidPrefix(prefixKey))return ValidationResult.NO_PREFIX_MATCHED;var decoded=bs58check.decodeUnsafe(value);return decoded?(decoded=decoded.slice(taquito_utils_es5_prefix[prefixKey].length)).length!==prefixLength[prefixKey]?ValidationResult.INVALID_LENGTH:ValidationResult.VALID:ValidationResult.INVALID_CHECKSUM}!function(ValidationResult){ValidationResult[ValidationResult.NO_PREFIX_MATCHED=0]="NO_PREFIX_MATCHED",ValidationResult[ValidationResult.INVALID_CHECKSUM=1]="INVALID_CHECKSUM",ValidationResult[ValidationResult.INVALID_LENGTH=2]="INVALID_LENGTH",ValidationResult[ValidationResult.VALID=3]="VALID"}(ValidationResult||(ValidationResult={}));var implicitPrefix=[Prefix.TZ1,Prefix.TZ2,Prefix.TZ3],contractPrefix=[Prefix.KT1],signaturePrefix=[Prefix.EDSIG,Prefix.P2SIG,Prefix.SPSIG,Prefix.SIG],pkPrefix=[Prefix.EDPK,Prefix.SPPK,Prefix.P2PK];function validateAddress(value){return validatePrefixedValue(value,function __spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar}(implicitPrefix,contractPrefix))}var blake=__webpack_require__(1166),bs58check$1=__webpack_require__(548);function b58cencode(value,prefix){var payloadAr="string"==typeof value?Uint8Array.from(buffer.Buffer.from(value,"hex")):value,n=new Uint8Array(prefix.length+payloadAr.length);return n.set(prefix),n.set(payloadAr,prefix.length),bs58check$1.encode(buffer.Buffer.from(n.buffer))}var b58cdecode=function(enc,prefixArg){return bs58check$1.decode(enc).slice(prefixArg.length)};function encodePubKey(value){if("00"===value.substring(0,2)){var pref={"0000":taquito_utils_es5_prefix.tz1,"0001":taquito_utils_es5_prefix.tz2,"0002":taquito_utils_es5_prefix.tz3};return b58cencode(value.substring(4),pref[value.substring(0,4)])}return b58cencode(value.substring(2,42),taquito_utils_es5_prefix.KT)}function encodeKeyHash(value){if("0"===value[0]){var pref={"00":new Uint8Array([6,161,159]),"01":new Uint8Array([6,161,161]),"02":new Uint8Array([6,161,164])};return b58cencode(value.substring(2),pref[value.substring(0,2)])}}var hex2buf=function(hex){return new Uint8Array(hex.match(/[\da-f]{2}/gi).map((function(h){return parseInt(h,16)})))},buf2hex=function(buffer){var byteArray=new Uint8Array(buffer),hexParts=[];return byteArray.forEach((function(byte){var paddedHex=("00"+byte.toString(16)).slice(-2);hexParts.push(paddedHex)})),hexParts.join("")},typedarray_to_buffer=__webpack_require__(158),typedarray_to_buffer_default=__webpack_require__.n(typedarray_to_buffer),elliptic=__webpack_require__(371),elliptic_default=__webpack_require__.n(elliptic),browser=__webpack_require__(370),browser_default=__webpack_require__.n(browser),src=__webpack_require__(620);function taquito_signer_es5_awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))}function taquito_signer_es5_generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}var taquito_signer_es5_Tz1=function(){function Tz1(key,encrypted,decrypt){this.key=key;var keyPrefix=key.substr(0,encrypted?5:4);if(!isValidPrefix(keyPrefix))throw new Error("key contains invalid prefix");if(this._key=decrypt(b58cdecode(this.key,taquito_utils_es5_prefix[keyPrefix])),this._publicKey=this._key.slice(32),!this._key)throw new Error("Unable to decode key");this.isInit=this.init()}return Tz1.prototype.init=function(){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){var _a,publicKey,privateKey;return taquito_signer_es5_generator(this,(function(_b){switch(_b.label){case 0:return[4,libsodium_wrappers_default.a.ready];case 1:return _b.sent(),64!==this._key.length&&(_a=libsodium_wrappers_default.a.crypto_sign_seed_keypair(new Uint8Array(this._key),"uint8array"),publicKey=_a.publicKey,privateKey=_a.privateKey,this._publicKey=publicKey,this._key=privateKey),[2,!0]}}))}))},Tz1.prototype.sign=function(bytes,bytesHash){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){var signature,signatureBuffer,sbytes;return taquito_signer_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.isInit];case 1:return _a.sent(),signature=libsodium_wrappers_default.a.crypto_sign_detached(new Uint8Array(bytesHash),new Uint8Array(this._key)),signatureBuffer=typedarray_to_buffer_default()(signature),sbytes=bytes+buf2hex(signatureBuffer),[2,{bytes:bytes,sig:b58cencode(signature,taquito_utils_es5_prefix.sig),prefixSig:b58cencode(signature,taquito_utils_es5_prefix.edsig),sbytes:sbytes}]}}))}))},Tz1.prototype.publicKey=function(){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){return taquito_signer_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.isInit];case 1:return _a.sent(),[2,b58cencode(this._publicKey,taquito_utils_es5_prefix.edpk)]}}))}))},Tz1.prototype.publicKeyHash=function(){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){return taquito_signer_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.isInit];case 1:return _a.sent(),[4,libsodium_wrappers_default.a.ready];case 2:return _a.sent(),[2,b58cencode(libsodium_wrappers_default.a.crypto_generichash(20,new Uint8Array(this._publicKey)),taquito_utils_es5_prefix.tz1)]}}))}))},Tz1.prototype.secretKey=function(){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){var key,privateKey;return taquito_signer_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.isInit];case 1:return _a.sent(),[4,libsodium_wrappers_default.a.ready];case 2:return _a.sent(),key=this._key,privateKey=libsodium_wrappers_default.a.crypto_sign_seed_keypair(new Uint8Array(key).slice(0,32),"uint8array").privateKey,[2,b58cencode(key=typedarray_to_buffer_default()(privateKey),taquito_utils_es5_prefix.edsk)]}}))}))},Tz1}(),taquito_signer_es5_pref={p256:{pk:taquito_utils_es5_prefix.p2pk,sk:taquito_utils_es5_prefix.p2sk,pkh:taquito_utils_es5_prefix.tz3,sig:taquito_utils_es5_prefix.p2sig},secp256k1:{pk:taquito_utils_es5_prefix.sppk,sk:taquito_utils_es5_prefix.spsk,pkh:taquito_utils_es5_prefix.tz2,sig:taquito_utils_es5_prefix.spsig}},taquito_signer_es5_ECKey=function(){function ECKey(curve,key,encrypted,decrypt){this.curve=curve,this.key=key;var keyPrefix=key.substr(0,encrypted?5:4);if(!isValidPrefix(keyPrefix))throw new Error("key contains invalid prefix");this._key=decrypt(b58cdecode(this.key,taquito_utils_es5_prefix[keyPrefix]));var keyPair=new elliptic_default.a.ec(this.curve).keyFromPrivate(this._key),pref=keyPair.getPublic().getY().toArray()[31]%2?3:2,pad=new Array(32).fill(0);this._publicKey=typedarray_to_buffer_default()(new Uint8Array([pref].concat(pad.concat(keyPair.getPublic().getX().toArray()).slice(-32))))}return ECKey.prototype.sign=function(bytes,bytesHash){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){var key,sig,signature,sbytes;return taquito_signer_es5_generator(this,(function(_a){return key=new elliptic_default.a.ec(this.curve).keyFromPrivate(this._key),sig=key.sign(bytesHash,{canonical:!0}),signature=sig.r.toString("hex",64)+sig.s.toString("hex",64),sbytes=bytes+signature,[2,{bytes:bytes,sig:b58cencode(signature,taquito_utils_es5_prefix.sig),prefixSig:b58cencode(signature,taquito_signer_es5_pref[this.curve].sig),sbytes:sbytes}]}))}))},ECKey.prototype.publicKey=function(){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){return taquito_signer_es5_generator(this,(function(_a){return[2,b58cencode(this._publicKey,taquito_signer_es5_pref[this.curve].pk)]}))}))},ECKey.prototype.publicKeyHash=function(){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){return taquito_signer_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,libsodium_wrappers_default.a.ready];case 1:return _a.sent(),[2,b58cencode(libsodium_wrappers_default.a.crypto_generichash(20,new Uint8Array(this._publicKey)),taquito_signer_es5_pref[this.curve].pkh)]}}))}))},ECKey.prototype.secretKey=function(){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){return taquito_signer_es5_generator(this,(function(_a){return[2,b58cencode(this._key,taquito_signer_es5_pref[this.curve].sk)]}))}))},ECKey}(),Tz3=taquito_signer_es5_ECKey.bind(null,"p256"),Tz2=taquito_signer_es5_ECKey.bind(null,"secp256k1");var taquito_signer_es5_InMemorySigner=function(){function InMemorySigner(key,passphrase){var encrypted="e"===key.substring(2,3),decrypt=function(k){return k};if(encrypted){if(!passphrase)throw new Error("Encrypted key provided without a passphrase.");decrypt=function(constructedKey){var salt=typedarray_to_buffer_default()(constructedKey.slice(0,8)),encryptedSk=constructedKey.slice(8),encryptionKey=browser_default.a.pbkdf2Sync(passphrase,salt,32768,32,"sha512");return libsodium_wrappers_default.a.crypto_secretbox_open_easy(new Uint8Array(encryptedSk),new Uint8Array(24),new Uint8Array(encryptionKey))}}switch(key.substr(0,4)){case"edes":case"edsk":this._key=new taquito_signer_es5_Tz1(key,encrypted,decrypt);break;case"spsk":case"spes":this._key=new Tz2(key,encrypted,decrypt);break;case"p2sk":case"p2es":this._key=new Tz3(key,encrypted,decrypt);break;default:throw new Error("Unsupported key type")}}return InMemorySigner.fromFundraiser=function(email,password,mnemonic){return new InMemorySigner(b58cencode(Object(src.mnemonicToSeedSync)(mnemonic,""+email+password).slice(0,32),taquito_utils_es5_prefix.edsk2))},InMemorySigner.fromSecretKey=function(key,passphrase){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){return taquito_signer_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,libsodium_wrappers_default.a.ready];case 1:return _a.sent(),[2,new InMemorySigner(key,passphrase)]}}))}))},InMemorySigner.prototype.sign=function(bytes,watermark){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){var bb,bytesHash;return taquito_signer_es5_generator(this,(function(_a){switch(_a.label){case 0:return bb=hex2buf(bytes),void 0!==watermark&&(b1=watermark,b2=bb,(r=new Uint8Array(b1.length+b2.length)).set(b1),r.set(b2,b1.length),bb=r),[4,libsodium_wrappers_default.a.ready];case 1:return _a.sent(),bytesHash=typedarray_to_buffer_default()(libsodium_wrappers_default.a.crypto_generichash(32,bb)),[2,this._key.sign(bytes,bytesHash)]}var b1,b2,r}))}))},InMemorySigner.prototype.publicKey=function(){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){return taquito_signer_es5_generator(this,(function(_a){return[2,this._key.publicKey()]}))}))},InMemorySigner.prototype.publicKeyHash=function(){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){return taquito_signer_es5_generator(this,(function(_a){return[2,this._key.publicKeyHash()]}))}))},InMemorySigner.prototype.secretKey=function(){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){return taquito_signer_es5_generator(this,(function(_a){return[2,this._key.secretKey()]}))}))},InMemorySigner}(),ReplaySubject=__webpack_require__(261),combineLatest=__webpack_require__(1357),observable_from=__webpack_require__(154),defer=__webpack_require__(1359),throwError=__webpack_require__(622),timer=__webpack_require__(1370),of=__webpack_require__(248),range=__webpack_require__(1361),concat=__webpack_require__(375),Subject=__webpack_require__(251),Observable=__webpack_require__(15),tap=__webpack_require__(1371),shareReplay=__webpack_require__(1356),map=__webpack_require__(150),operators_filter=__webpack_require__(623),first=__webpack_require__(1368),distinctUntilChanged=__webpack_require__(624),takeWhile=__webpack_require__(1358),switchMap=__webpack_require__(372),distinctUntilKeyChanged=__webpack_require__(1360),timeoutWith=__webpack_require__(1372),startWith=__webpack_require__(1362),concatMap=__webpack_require__(1363),mapTo=__webpack_require__(1364),switchMapTo=__webpack_require__(1365),takeUntil=__webpack_require__(1366),publishReplay=__webpack_require__(1369),refCount=__webpack_require__(625),pluck=__webpack_require__(1367),bignumber_js_bignumber=__webpack_require__(53),bignumber_js_bignumber_default=__webpack_require__.n(bignumber_js_bignumber),fast_json_stable_stringify=__webpack_require__(621),fast_json_stable_stringify_default=__webpack_require__.n(fast_json_stable_stringify),node_modules_bignumber_js_bignumber=__webpack_require__(122),node_modules_bignumber_js_bignumber_default=__webpack_require__.n(node_modules_bignumber_js_bignumber),extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)};function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var taquito_michelson_encoder_es5_a,taquito_michelson_encoder_es5_assign=function(){return(taquito_michelson_encoder_es5_assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function taquito_michelson_encoder_es5_generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}function __values(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}function taquito_michelson_encoder_es5_read(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar}function taquito_michelson_encoder_es5_spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(taquito_michelson_encoder_es5_read(arguments[i]));return ar}var michelsonMapTypeSymbol=Symbol.for("taquito-michelson-map-type-symbol"),MapTypecheckError=function MapTypecheckError(value,type,errorType){this.value=value,this.type=type,this.name="MapTypecheckError",this.message=errorType+" not compliant with underlying michelson type"},taquito_michelson_encoder_es5_MichelsonMap=function(){function MichelsonMap(mapType){this.valueMap=new Map,this.keyMap=new Map,this[taquito_michelson_encoder_es5_a]=!0,mapType&&this.setType(mapType)}return MichelsonMap.isMichelsonMap=function(obj){return obj&&!0===obj[michelsonMapTypeSymbol]},MichelsonMap.prototype.setType=function(mapType){if(!("args"in(value=mapType))||!Array.isArray(value.args)||2!==value.args.length)throw new Error("mapType is not a valid michelson map type");var value;this.keySchema=new Schema(mapType.args[0]),this.valueSchema=new Schema(mapType.args[1])},MichelsonMap.prototype.removeType=function(){this.keySchema=void 0,this.valueSchema=void 0},MichelsonMap.fromLiteral=function(obj,mapType){var map=new MichelsonMap(mapType);return Object.keys(obj).forEach((function(key){map.set(key,obj[key])})),map},MichelsonMap.prototype.typecheckKey=function(key){return!this.keySchema||this.keySchema.Typecheck(key)},MichelsonMap.prototype.typecheckValue=function(value){return!this.valueSchema||this.valueSchema.Typecheck(value)},MichelsonMap.prototype.assertTypecheckValue=function(value){if(!this.typecheckValue(value))throw new MapTypecheckError(value,this.valueSchema,"value")},MichelsonMap.prototype.assertTypecheckKey=function(key){if(!this.typecheckKey(key))throw new MapTypecheckError(key,this.keySchema,"key")},MichelsonMap.prototype.serializeDeterministically=function(key){return fast_json_stable_stringify_default()(key)},MichelsonMap.prototype.keys=function(){var _b,_c,_d,e_1_1,e_1,_e;return taquito_michelson_encoder_es5_generator(this,(function(_f){switch(_f.label){case 0:_f.trys.push([0,5,6,7]),_b=__values(this.entries()),_c=_b.next(),_f.label=1;case 1:return _c.done?[3,4]:(_d=taquito_michelson_encoder_es5_read(_c.value,1),[4,_d[0]]);case 2:_f.sent(),_f.label=3;case 3:return _c=_b.next(),[3,1];case 4:return[3,7];case 5:return e_1_1=_f.sent(),e_1={error:e_1_1},[3,7];case 6:try{_c&&!_c.done&&(_e=_b.return)&&_e.call(_b)}finally{if(e_1)throw e_1.error}return[7];case 7:return[2]}}))},MichelsonMap.prototype.values=function(){var _b,_c,_d,e_2_1,e_2,_e;return taquito_michelson_encoder_es5_generator(this,(function(_f){switch(_f.label){case 0:_f.trys.push([0,5,6,7]),_b=__values(this.entries()),_c=_b.next(),_f.label=1;case 1:return _c.done?[3,4]:(_d=taquito_michelson_encoder_es5_read(_c.value,2),[4,_d[1]]);case 2:_f.sent(),_f.label=3;case 3:return _c=_b.next(),[3,1];case 4:return[3,7];case 5:return e_2_1=_f.sent(),e_2={error:e_2_1},[3,7];case 6:try{_c&&!_c.done&&(_e=_b.return)&&_e.call(_b)}finally{if(e_2)throw e_2.error}return[7];case 7:return[2]}}))},MichelsonMap.prototype.entries=function(){var _b,_c,key,e_3_1,e_3,_d;return taquito_michelson_encoder_es5_generator(this,(function(_e){switch(_e.label){case 0:_e.trys.push([0,5,6,7]),_b=__values(this.valueMap.keys()),_c=_b.next(),_e.label=1;case 1:return _c.done?[3,4]:(key=_c.value,[4,[this.keyMap.get(key),this.valueMap.get(key)]]);case 2:_e.sent(),_e.label=3;case 3:return _c=_b.next(),[3,1];case 4:return[3,7];case 5:return e_3_1=_e.sent(),e_3={error:e_3_1},[3,7];case 6:try{_c&&!_c.done&&(_d=_b.return)&&_d.call(_b)}finally{if(e_3)throw e_3.error}return[7];case 7:return[2]}}))},MichelsonMap.prototype.get=function(key){this.assertTypecheckKey(key);var strKey=this.serializeDeterministically(key);return this.valueMap.get(strKey)},MichelsonMap.prototype.set=function(key,value){this.assertTypecheckKey(key),this.assertTypecheckValue(value);var strKey=this.serializeDeterministically(key);this.keyMap.set(strKey,key),this.valueMap.set(strKey,value)},MichelsonMap.prototype.delete=function(key){this.assertTypecheckKey(key),this.keyMap.delete(this.serializeDeterministically(key)),this.valueMap.delete(this.serializeDeterministically(key))},MichelsonMap.prototype.has=function(key){this.assertTypecheckKey(key);var strKey=this.serializeDeterministically(key);return this.keyMap.has(strKey)&&this.valueMap.has(strKey)},MichelsonMap.prototype.clear=function(){this.keyMap.clear(),this.valueMap.clear()},Object.defineProperty(MichelsonMap.prototype,"size",{get:function(){return this.keyMap.size},enumerable:!1,configurable:!0}),MichelsonMap.prototype.forEach=function(cb){var e_4,_b;try{for(var _c=__values(this.entries()),_d=_c.next();!_d.done;_d=_c.next()){var _e=taquito_michelson_encoder_es5_read(_d.value,2),key=_e[0];cb(_e[1],key,this)}}catch(e_4_1){e_4={error:e_4_1}}finally{try{_d&&!_d.done&&(_b=_c.return)&&_b.call(_c)}finally{if(e_4)throw e_4.error}}},MichelsonMap}();taquito_michelson_encoder_es5_a=michelsonMapTypeSymbol;var _a$1,TokenValidationError=function TokenValidationError(value,token,baseMessage){this.value=value,this.token=token,this.name="ValidationError";var annot=this.token.annot(),annotText=annot?"["+annot+"] ":"";this.message=""+annotText+baseMessage},Token=function(){function Token(val,idx,fac){this.val=val,this.idx=idx,this.fac=fac,this.createToken=this.fac}return Token.prototype.typeWithoutAnnotations=function(){var removeArgsRec=function(val){return val.args?{prim:val.prim,args:val.args.map((function(x){return removeArgsRec(x)}))}:{prim:val.prim}};return removeArgsRec(this.val)},Token.prototype.annot=function(){return(Array.isArray(this.val.annots)&&this.val.annots.length>0?this.val.annots[0]:String(this.idx)).replace(/(%|\:)(_Liq_entry_)?/,"")},Token.prototype.hasAnnotations=function(){return Array.isArray(this.val.annots)&&this.val.annots.length},Token.prototype.ExtractSignature=function(){return[[this.ExtractSchema()]]},Token}(),ComparableToken=function(_super){function ComparableToken(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(ComparableToken,_super),ComparableToken.prototype.compare=function(o1,o2){return o1===o2?0:o1<o2?-1:1},ComparableToken}(Token),BigMapValidationError=function(_super){function BigMapValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="BigMapValidationError",_this}return __extends(BigMapValidationError,_super),BigMapValidationError}(TokenValidationError),BigMapToken=function(_super){function BigMapToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(BigMapToken,_super),Object.defineProperty(BigMapToken.prototype,"ValueSchema",{get:function(){return this.createToken(this.val.args[1],0)},enumerable:!1,configurable:!0}),Object.defineProperty(BigMapToken.prototype,"KeySchema",{get:function(){return this.createToken(this.val.args[0],0)},enumerable:!1,configurable:!0}),BigMapToken.prototype.ExtractSchema=function(){var _a;return(_a={})[this.KeySchema.ExtractSchema()]=this.ValueSchema.ExtractSchema(),_a},BigMapToken.prototype.isValid=function(value){return taquito_michelson_encoder_es5_MichelsonMap.isMichelsonMap(value)?null:new BigMapValidationError(value,this,"Value must be a MichelsonMap")},BigMapToken.prototype.Encode=function(args){var _this=this,val=args.pop(),err=this.isValid(val);if(err)throw err;return Array.from(val.keys()).sort((function(a,b){return _this.KeySchema.compare(a,b)})).map((function(key){return{prim:"Elt",args:[_this.KeySchema.EncodeObject(key),_this.ValueSchema.EncodeObject(val.get(key))]}}))},BigMapToken.prototype.EncodeObject=function(args){var _this=this,val=args,err=this.isValid(val);if(err)throw err;return Array.from(val.keys()).sort((function(a,b){return _this.KeySchema.compare(a,b)})).map((function(key){return{prim:"Elt",args:[_this.KeySchema.EncodeObject(key),_this.ValueSchema.EncodeObject(val.get(key))]}}))},BigMapToken.prototype.Execute=function(val,semantic){var _this=this;if(semantic&&semantic[BigMapToken.prim])return semantic[BigMapToken.prim](val,this.val);if(Array.isArray(val)){var map_1=new taquito_michelson_encoder_es5_MichelsonMap(this.val);return val.forEach((function(current){map_1.set(_this.KeySchema.ToKey(current.args[0]),_this.ValueSchema.Execute(current.args[1]))})),map_1}if("int"in val)return val.int;throw new Error("Big map is expecting either an array (Athens) or an object with an int property (Babylon). Got "+JSON.stringify(val))},BigMapToken.prim="big_map",BigMapToken}(Token),OrToken=function(_super){function OrToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(OrToken,_super),OrToken.prototype.Encode=function(args){var label=args[args.length-1],leftToken=this.createToken(this.val.args[0],this.idx),keyCount=1;leftToken instanceof OrToken&&(keyCount=Object.keys(leftToken.ExtractSchema()).length);var rightToken=this.createToken(this.val.args[1],this.idx+keyCount);if(String(leftToken.annot())!==String(label)||leftToken instanceof OrToken){if(String(rightToken.annot())!==String(label)||rightToken instanceof OrToken){var val;if(leftToken instanceof OrToken)if(val=leftToken.Encode(args))return{prim:"Left",args:[val]};if(rightToken instanceof OrToken)if(val=rightToken.Encode(args))return{prim:"Right",args:[val]};return null}return args.pop(),{prim:"Right",args:[rightToken.Encode(args)]}}return args.pop(),{prim:"Left",args:[leftToken.Encode(args)]}},OrToken.prototype.ExtractSignature=function(){var e_1,_a,e_2,_b,leftToken=this.createToken(this.val.args[0],this.idx),keyCount=1;leftToken instanceof OrToken&&(keyCount=Object.keys(leftToken.ExtractSchema()).length);var rightToken=this.createToken(this.val.args[1],this.idx+keyCount),newSig=[];if(leftToken instanceof OrToken)newSig.push.apply(newSig,taquito_michelson_encoder_es5_spread(leftToken.ExtractSignature()));else try{for(var _c=__values(leftToken.ExtractSignature()),_d=_c.next();!_d.done;_d=_c.next()){var sig=_d.value;newSig.push(taquito_michelson_encoder_es5_spread([leftToken.annot()],sig))}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_1)throw e_1.error}}if(rightToken instanceof OrToken)newSig.push.apply(newSig,taquito_michelson_encoder_es5_spread(rightToken.ExtractSignature()));else try{for(var _e=__values(rightToken.ExtractSignature()),_f=_e.next();!_f.done;_f=_e.next()){sig=_f.value;newSig.push(taquito_michelson_encoder_es5_spread([rightToken.annot()],sig))}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_f&&!_f.done&&(_b=_e.return)&&_b.call(_e)}finally{if(e_2)throw e_2.error}}return newSig},OrToken.prototype.EncodeObject=function(args){var label=Object.keys(args)[0],leftToken=this.createToken(this.val.args[0],this.idx),keyCount=1;leftToken instanceof OrToken&&(keyCount=Object.keys(leftToken.ExtractSchema()).length);var rightToken=this.createToken(this.val.args[1],this.idx+keyCount);if(String(leftToken.annot())!==String(label)||leftToken instanceof OrToken){if(String(rightToken.annot())!==String(label)||rightToken instanceof OrToken){var val;if(leftToken instanceof OrToken)if(val=leftToken.EncodeObject(args))return{prim:"Left",args:[val]};if(rightToken instanceof OrToken)if(val=rightToken.EncodeObject(args))return{prim:"Right",args:[val]};return null}return{prim:"Right",args:[rightToken.EncodeObject(args[label])]}}return{prim:"Left",args:[leftToken.EncodeObject(args[label])]}},OrToken.prototype.Execute=function(val,semantics){var _a,leftToken=this.createToken(this.val.args[0],this.idx),keyCount=1;leftToken instanceof OrToken&&(keyCount=Object.keys(leftToken.ExtractSchema()).length);var rightToken=this.createToken(this.val.args[1],this.idx+keyCount);if("Right"===val.prim)return rightToken.Execute(val.args[0],semantics);if("Left"===val.prim)return(_a={})[leftToken.annot()]=leftToken.Execute(val.args[0],semantics),_a;throw new Error("Was expecting Left or Right prim but got: "+val.prim)},OrToken.prototype.traversal=function(getLeftValue,getRightValue,concat){var _a,_b,leftValue,leftToken=this.createToken(this.val.args[0],this.idx),keyCount=1;leftToken instanceof OrToken&&!leftToken.hasAnnotations()?(leftValue=getLeftValue(leftToken),keyCount=Object.keys(leftToken.ExtractSchema()).length):((_a={})[leftToken.annot()]=getLeftValue(leftToken),leftValue=_a);var rightValue,rightToken=this.createToken(this.val.args[1],this.idx+keyCount);return rightToken instanceof OrToken&&!rightToken.hasAnnotations()?rightValue=getRightValue(rightToken):((_b={})[rightToken.annot()]=getRightValue(rightToken),rightValue=_b),concat(leftValue,rightValue)},OrToken.prototype.ExtractSchema=function(){return this.traversal((function(leftToken){return leftToken.ExtractSchema()}),(function(rightToken){return rightToken.ExtractSchema()}),(function(leftValue,rightValue){return taquito_michelson_encoder_es5_assign(taquito_michelson_encoder_es5_assign({},leftValue),rightValue)}))},OrToken.prim="or",OrToken}(Token),PairToken=function(_super){function PairToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(PairToken,_super),PairToken.prototype.Encode=function(args){var leftToken=this.createToken(this.val.args[0],this.idx),keyCount=1;leftToken instanceof PairToken&&(keyCount=Object.keys(leftToken.ExtractSchema()).length);var rightToken=this.createToken(this.val.args[1],this.idx+keyCount);return{prim:"Pair",args:[leftToken.Encode(args),rightToken.Encode(args)]}},PairToken.prototype.ExtractSignature=function(){var e_1,_a,e_2,_b,leftToken=this.createToken(this.val.args[0],this.idx),keyCount=1;leftToken instanceof OrToken&&(keyCount=Object.keys(leftToken.ExtractSchema()).length);var rightToken=this.createToken(this.val.args[1],this.idx+keyCount),newSig=[];try{for(var _c=__values(leftToken.ExtractSignature()),_d=_c.next();!_d.done;_d=_c.next()){var leftSig=_d.value;try{for(var _e=(e_2=void 0,__values(rightToken.ExtractSignature())),_f=_e.next();!_f.done;_f=_e.next()){var rightSig=_f.value;newSig.push(taquito_michelson_encoder_es5_spread(leftSig,rightSig))}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_f&&!_f.done&&(_b=_e.return)&&_b.call(_e)}finally{if(e_2)throw e_2.error}}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_1)throw e_1.error}}return newSig},PairToken.prototype.ToBigMapKey=function(val){return{key:this.EncodeObject(val),type:this.typeWithoutAnnotations()}},PairToken.prototype.ToKey=function(val){return this.Execute(val)},PairToken.prototype.EncodeObject=function(args){var leftToken=this.createToken(this.val.args[0],this.idx),keyCount=1;leftToken instanceof PairToken&&(keyCount=Object.keys(leftToken.ExtractSchema()).length);var leftValue,rightValue,rightToken=this.createToken(this.val.args[1],this.idx+keyCount);return leftValue=leftToken instanceof PairToken&&!leftToken.hasAnnotations()?args:args[leftToken.annot()],rightValue=rightToken instanceof PairToken&&!rightToken.hasAnnotations()?args:args[rightToken.annot()],{prim:"Pair",args:[leftToken.EncodeObject(leftValue),rightToken.EncodeObject(rightValue)]}},PairToken.prototype.traversal=function(getLeftValue,getRightValue){var _a,_b,leftValue,leftToken=this.createToken(this.val.args[0],this.idx),keyCount=1;leftToken instanceof PairToken&&!leftToken.hasAnnotations()?(leftValue=getLeftValue(leftToken),keyCount=Object.keys(leftToken.ExtractSchema()).length):((_a={})[leftToken.annot()]=getLeftValue(leftToken),leftValue=_a);var rightValue,rightToken=this.createToken(this.val.args[1],this.idx+keyCount);return rightToken instanceof PairToken&&!rightToken.hasAnnotations()?rightValue=getRightValue(rightToken):((_b={})[rightToken.annot()]=getRightValue(rightToken),rightValue=_b),taquito_michelson_encoder_es5_assign(taquito_michelson_encoder_es5_assign({},leftValue),rightValue)},PairToken.prototype.Execute=function(val,semantics){return this.traversal((function(leftToken){return leftToken.Execute(val.args[0],semantics)}),(function(rightToken){return rightToken.Execute(val.args[1],semantics)}))},PairToken.prototype.ExtractSchema=function(){return this.traversal((function(leftToken){return leftToken.ExtractSchema()}),(function(rightToken){return rightToken.ExtractSchema()}))},PairToken.prototype.compare=function(val1,val2){var leftToken=this.createToken(this.val.args[0],this.idx),keyCount=1;leftToken instanceof PairToken&&(keyCount=Object.keys(leftToken.ExtractSchema()).length);var rightToken=this.createToken(this.val.args[1],this.idx+keyCount),getValue=function(token,args){return token instanceof PairToken&&!token.hasAnnotations()?args:args[token.annot()]};if(leftToken instanceof ComparableToken&&rightToken instanceof ComparableToken){var result=leftToken.compare(getValue(leftToken,val1),getValue(leftToken,val2));return 0===result?rightToken.compare(getValue(rightToken,val1),getValue(rightToken,val2)):result}throw new Error("Not a comparable pair")},PairToken.prim="pair",PairToken}(ComparableToken),NatValidationError=function(_super){function NatValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="NatValidationError",_this}return __extends(NatValidationError,_super),NatValidationError}(TokenValidationError),taquito_michelson_encoder_es5_NatToken=function(_super){function NatToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(NatToken,_super),NatToken.prototype.Execute=function(val){return new node_modules_bignumber_js_bignumber_default.a(val[Object.keys(val)[0]])},NatToken.prototype.Encode=function(args){var val=args.pop(),err=this.isValid(val);if(err)throw err;return{int:String(val).toString()}},NatToken.prototype.isValid=function(val){var bigNumber=new node_modules_bignumber_js_bignumber_default.a(val);return bigNumber.isNaN()?new NatValidationError(val,this,"Value is not a number: "+val):bigNumber.isNegative()?new NatValidationError(val,this,"Value cannot be negative: "+val):null},NatToken.prototype.EncodeObject=function(val){var err=this.isValid(val);if(err)throw err;return{int:String(val).toString()}},NatToken.prototype.ExtractSchema=function(){return NatToken.prim},NatToken.prototype.ToBigMapKey=function(val){return{key:{int:val},type:{prim:NatToken.prim}}},NatToken.prototype.ToKey=function(_a){return _a.int},NatToken.prim="nat",NatToken}(ComparableToken),StringToken=function(_super){function StringToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(StringToken,_super),StringToken.prototype.Execute=function(val){return val[Object.keys(val)[0]]},StringToken.prototype.ExtractSchema=function(){return StringToken.prim},StringToken.prototype.Encode=function(args){return{string:args.pop()}},StringToken.prototype.EncodeObject=function(val){return{string:val}},StringToken.prototype.ToKey=function(_a){return _a.string},StringToken.prototype.ToBigMapKey=function(val){return{key:{string:val},type:{prim:StringToken.prim}}},StringToken.prim="string",StringToken}(ComparableToken),AddressValidationError=function(_super){function AddressValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="AddressValidationError",_this}return __extends(AddressValidationError,_super),AddressValidationError}(TokenValidationError),taquito_michelson_encoder_es5_AddressToken=function(_super){function AddressToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(AddressToken,_super),AddressToken.prototype.ToBigMapKey=function(val){return{key:{bytes:function b58decode(payload){var _a,buf=bs58check$1.decode(payload),pref=((_a={})[taquito_utils_es5_prefix.tz1.toString()]="0000",_a[taquito_utils_es5_prefix.tz2.toString()]="0001",_a[taquito_utils_es5_prefix.tz3.toString()]="0002",_a)[new Uint8Array(buf.slice(0,3)).toString()];return pref?pref+buf2hex(buf.slice(3)):"01"+buf2hex(buf.slice(3,42))+"00"}(val)},type:{prim:"bytes"}}},AddressToken.prototype.isValid=function(value){return validateAddress(value)!==ValidationResult.VALID?new AddressValidationError(value,this,"Address is not valid: "+value):null},AddressToken.prototype.Encode=function(args){var val=args.pop(),err=this.isValid(val);if(err)throw err;return{string:val}},AddressToken.prototype.EncodeObject=function(val){var err=this.isValid(val);if(err)throw err;return{string:val}},AddressToken.prototype.Execute=function(val){return val.string?val.string:encodePubKey(val.bytes)},AddressToken.prototype.ExtractSchema=function(){return AddressToken.prim},AddressToken.prototype.ToKey=function(_a){var bytes=_a.bytes,string=_a.string;return string||encodePubKey(bytes)},AddressToken.prototype.compare=function(address1,address2){var isImplicit=function(address){return address.startsWith("tz")};return isImplicit(address1)&&isImplicit(address2)?_super.prototype.compare.call(this,address1,address2):isImplicit(address1)?-1:isImplicit(address2)?1:_super.prototype.compare.call(this,address1,address2)},AddressToken.prim="address",AddressToken}(ComparableToken),MapValidationError=function(_super){function MapValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="MapValidationError",_this}return __extends(MapValidationError,_super),MapValidationError}(TokenValidationError),MapToken=function(_super){function MapToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(MapToken,_super),Object.defineProperty(MapToken.prototype,"ValueSchema",{get:function(){return this.createToken(this.val.args[1],0)},enumerable:!1,configurable:!0}),Object.defineProperty(MapToken.prototype,"KeySchema",{get:function(){return this.createToken(this.val.args[0],0)},enumerable:!1,configurable:!0}),MapToken.prototype.isValid=function(value){return taquito_michelson_encoder_es5_MichelsonMap.isMichelsonMap(value)?null:new MapValidationError(value,this,"Value must be a MichelsonMap")},MapToken.prototype.Execute=function(val,semantics){var _this=this,map=new taquito_michelson_encoder_es5_MichelsonMap(this.val);return val.forEach((function(current){map.set(_this.KeySchema.ToKey(current.args[0]),_this.ValueSchema.Execute(current.args[1],semantics))})),map},MapToken.prototype.Encode=function(args){var _this=this,val=args.pop(),err=this.isValid(val);if(err)throw err;return Array.from(val.keys()).sort((function(a,b){return _this.KeySchema.compare(a,b)})).map((function(key){return{prim:"Elt",args:[_this.KeySchema.EncodeObject(key),_this.ValueSchema.EncodeObject(val.get(key))]}}))},MapToken.prototype.EncodeObject=function(args){var _this=this,val=args,err=this.isValid(val);if(err)throw err;return Array.from(val.keys()).sort((function(a,b){return _this.KeySchema.compare(a,b)})).map((function(key){return{prim:"Elt",args:[_this.KeySchema.EncodeObject(key),_this.ValueSchema.EncodeObject(val.get(key))]}}))},MapToken.prototype.ExtractSchema=function(){return{map:{key:this.KeySchema.ExtractSchema(),value:this.ValueSchema.ExtractSchema()}}},MapToken.prim="map",MapToken}(Token),BoolToken=function(_super){function BoolToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(BoolToken,_super),BoolToken.prototype.Execute=function(val){return"true"===String(val.prim).toLowerCase()},BoolToken.prototype.Encode=function(args){return{prim:args.pop()?"True":"False"}},BoolToken.prototype.EncodeObject=function(val){return{prim:val?"True":"False"}},BoolToken.prototype.ExtractSchema=function(){return BoolToken.prim},BoolToken.prototype.ToBigMapKey=function(val){return{key:this.EncodeObject(val),type:{prim:BoolToken.prim}}},BoolToken.prototype.ToKey=function(val){return this.EncodeObject(val)},BoolToken.prototype.compare=function(val1,val2){return val1&&val2||!val1&&!val2?0:val1?1:-1},BoolToken.prim="bool",BoolToken}(ComparableToken),ContractValidationError=function(_super){function ContractValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="ContractValidationError",_this}return __extends(ContractValidationError,_super),ContractValidationError}(TokenValidationError),taquito_michelson_encoder_es5_ContractToken=function(_super){function ContractToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(ContractToken,_super),ContractToken.prototype.isValid=function(value){return validateAddress(value)!==ValidationResult.VALID?new ContractValidationError(value,this,"Contract address is not valid"):null},ContractToken.prototype.Execute=function(val){return val.string?val.string:encodePubKey(val.bytes)},ContractToken.prototype.Encode=function(args){var val=args.pop(),err=this.isValid(val);if(err)throw err;return{string:val}},ContractToken.prototype.EncodeObject=function(val){var err=this.isValid(val);if(err)throw err;return{string:val}},ContractToken.prototype.ExtractSchema=function(){return ContractToken.prim},ContractToken.prim="contract",ContractToken}(Token),ListValidationError=function(_super){function ListValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="ListValidationError",_this}return __extends(ListValidationError,_super),ListValidationError}(TokenValidationError),ListToken=function(_super){function ListToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(ListToken,_super),ListToken.prototype.isValid=function(value){return Array.isArray(value)?null:new ListValidationError(value,this,"Value must be an array")},ListToken.prototype.Encode=function(args){var val=args.pop(),err=this.isValid(val);if(err)throw err;var schema=this.createToken(this.val.args[0],0);return val.reduce((function(prev,current){return taquito_michelson_encoder_es5_spread(prev,[schema.EncodeObject(current)])}),[])},ListToken.prototype.Execute=function(val,semantics){var schema=this.createToken(this.val.args[0],0),err=this.isValid(val);if(err)throw err;return val.reduce((function(prev,current){return taquito_michelson_encoder_es5_spread(prev,[schema.Execute(current,semantics)])}),[])},ListToken.prototype.EncodeObject=function(args){var schema=this.createToken(this.val.args[0],0),err=this.isValid(args);if(err)throw err;return args.reduce((function(prev,current){return taquito_michelson_encoder_es5_spread(prev,[schema.EncodeObject(current)])}),[])},ListToken.prototype.ExtractSchema=function(){return ListToken.prim},ListToken.prim="list",ListToken}(Token),MutezValidationError=function(_super){function MutezValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="MutezValidationError",_this}return __extends(MutezValidationError,_super),MutezValidationError}(TokenValidationError),taquito_michelson_encoder_es5_MutezToken=function(_super){function MutezToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(MutezToken,_super),MutezToken.prototype.Execute=function(val){return new node_modules_bignumber_js_bignumber_default.a(val[Object.keys(val)[0]])},MutezToken.prototype.ExtractSchema=function(){return MutezToken.prim},MutezToken.prototype.isValid=function(val){return new node_modules_bignumber_js_bignumber_default.a(val).isNaN()?new MutezValidationError(val,this,"Value is not a number: "+val):null},MutezToken.prototype.Encode=function(args){var val=args.pop(),err=this.isValid(val);if(err)throw err;return{int:String(val).toString()}},MutezToken.prototype.EncodeObject=function(val){var err=this.isValid(val);if(err)throw err;return{int:String(val).toString()}},MutezToken.prototype.ToBigMapKey=function(val){return{key:{int:val},type:{prim:MutezToken.prim}}},MutezToken.prototype.ToKey=function(_a){return _a.int},MutezToken.prim="mutez",MutezToken}(ComparableToken),BytesValidationError=function(_super){function BytesValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="BytesValidationError",_this}return __extends(BytesValidationError,_super),BytesValidationError}(TokenValidationError),BytesToken=function(_super){function BytesToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(BytesToken,_super),BytesToken.prototype.ToBigMapKey=function(val){return{key:{bytes:val},type:{prim:BytesToken.prim}}},BytesToken.prototype.isValid=function(val){return"string"==typeof val&&/^[0-9a-fA-F]*$/.test(val)&&val.length%2==0?null:new BytesValidationError(val,this,"Invalid bytes: "+val)},BytesToken.prototype.Encode=function(args){var val=args.pop(),err=this.isValid(val);if(err)throw err;return{bytes:String(val).toString()}},BytesToken.prototype.EncodeObject=function(val){var err=this.isValid(val);if(err)throw err;return{bytes:String(val).toString()}},BytesToken.prototype.Execute=function(val){return val.bytes},BytesToken.prototype.ExtractSchema=function(){return BytesToken.prim},BytesToken.prototype.ToKey=function(_a){var bytes=_a.bytes,string=_a.string;return string||bytes},BytesToken.prim="bytes",BytesToken}(ComparableToken),OptionToken=function(_super){function OptionToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(OptionToken,_super),OptionToken.prototype.subToken=function(){return this.createToken(this.val.args[0],this.idx)},OptionToken.prototype.annot=function(){return Array.isArray(this.val.annots)?_super.prototype.annot.call(this):this.createToken(this.val.args[0],this.idx).annot()},OptionToken.prototype.Encode=function(args){var value=args;return null==value||Array.isArray(value)&&(void 0===value[0]||null===value[0])?{prim:"None"}:{prim:"Some",args:[this.createToken(this.val.args[0],0).Encode(args)]}},OptionToken.prototype.EncodeObject=function(args){var schema=this.createToken(this.val.args[0],0),value=args;return null==value?{prim:"None"}:{prim:"Some",args:[schema.EncodeObject(value)]}},OptionToken.prototype.Execute=function(val,semantics){return"None"===val.prim?null:this.createToken(this.val.args[0],0).Execute(val.args[0],semantics)},OptionToken.prototype.ExtractSchema=function(){return this.createToken(this.val.args[0],0).ExtractSchema()},OptionToken.prototype.ExtractSignature=function(){return taquito_michelson_encoder_es5_spread(this.createToken(this.val.args[0],0).ExtractSignature(),[[]])},OptionToken.prim="option",OptionToken}(Token),TimestampToken=function(_super){function TimestampToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(TimestampToken,_super),TimestampToken.prototype.Execute=function(val){return val.string?new Date(val.string).toISOString():val.int?new Date(1e3*Number(val.int)).toISOString():void 0},TimestampToken.prototype.Encode=function(args){return{string:args.pop()}},TimestampToken.prototype.EncodeObject=function(val){return{string:val}},TimestampToken.prototype.ExtractSchema=function(){return TimestampToken.prim},TimestampToken.prototype.ToKey=function(_a){return _a.string},TimestampToken.prototype.ToBigMapKey=function(val){return{key:{string:val},type:{prim:TimestampToken.prim}}},TimestampToken.prim="timestamp",TimestampToken}(ComparableToken),IntValidationError=function(_super){function IntValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="IntValidationError",_this}return __extends(IntValidationError,_super),IntValidationError}(TokenValidationError),taquito_michelson_encoder_es5_IntToken=function(_super){function IntToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(IntToken,_super),IntToken.prototype.Execute=function(val){return new node_modules_bignumber_js_bignumber_default.a(val[Object.keys(val)[0]])},IntToken.prototype.ExtractSchema=function(){return IntToken.prim},IntToken.prototype.isValid=function(val){return new node_modules_bignumber_js_bignumber_default.a(val).isNaN()?new IntValidationError(val,this,"Value is not a number: "+val):null},IntToken.prototype.Encode=function(args){var val=args.pop(),err=this.isValid(val);if(err)throw err;return{int:String(val).toString()}},IntToken.prototype.EncodeObject=function(val){var err=this.isValid(val);if(err)throw err;return{int:String(val).toString()}},IntToken.prototype.ToBigMapKey=function(val){return{key:{int:val},type:{prim:IntToken.prim}}},IntToken.prototype.ToKey=function(_a){return _a.int},IntToken.prim="int",IntToken}(ComparableToken),UnitToken=function(_super){function UnitToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(UnitToken,_super),UnitToken.prototype.Encode=function(args){return args.pop(),{prim:"Unit"}},UnitToken.prototype.EncodeObject=function(_val){return{prim:"Unit"}},UnitToken.prototype.Execute=function(){return UnitValue},UnitToken.prototype.ExtractSchema=function(){return UnitToken.prim},UnitToken.prim="unit",UnitToken}(Token),KeyValidationError=function(_super){function KeyValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="KeyValidationError",_this}return __extends(KeyValidationError,_super),KeyValidationError}(TokenValidationError),taquito_michelson_encoder_es5_KeyToken=function(_super){function KeyToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(KeyToken,_super),KeyToken.prototype.Execute=function(val){return val.string?val.string:function encodeKey(value){if("0"===value[0]){var pref={"00":new Uint8Array([13,15,37,217]),"01":new Uint8Array([3,254,226,86]),"02":new Uint8Array([3,178,139,127])};return b58cencode(value.substring(2),pref[value.substring(0,2)])}}(val.bytes)},KeyToken.prototype.isValid=function(value){return function validatePublicKey(value){return validatePrefixedValue(value,pkPrefix)}(value)!==ValidationResult.VALID?new KeyValidationError(value,this,"Key is not valid"):null},KeyToken.prototype.Encode=function(args){var val=args.pop(),err=this.isValid(val);if(err)throw err;return{string:val}},KeyToken.prototype.EncodeObject=function(val){var err=this.isValid(val);if(err)throw err;return{string:val}},KeyToken.prototype.ExtractSchema=function(){return KeyToken.prim},KeyToken.prim="key",KeyToken}(Token),KeyHashValidationError=function(_super){function KeyHashValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="KeyHashValidationError",_this}return __extends(KeyHashValidationError,_super),KeyHashValidationError}(TokenValidationError),taquito_michelson_encoder_es5_KeyHashToken=function(_super){function KeyHashToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(KeyHashToken,_super),KeyHashToken.prototype.Execute=function(val){return val.string?val.string:encodeKeyHash(val.bytes)},KeyHashToken.prototype.isValid=function(value){return function validateKeyHash(value){return validatePrefixedValue(value,implicitPrefix)}(value)!==ValidationResult.VALID?new KeyHashValidationError(value,this,"KeyHash is not valid: "+value):null},KeyHashToken.prototype.Encode=function(args){var val=args.pop(),err=this.isValid(val);if(err)throw err;return{string:val}},KeyHashToken.prototype.EncodeObject=function(val){var err=this.isValid(val);if(err)throw err;return{string:val}},KeyHashToken.prototype.ExtractSchema=function(){return KeyHashToken.prim},KeyHashToken.prototype.ToKey=function(_a){var string=_a.string,bytes=_a.bytes;return string||encodeKeyHash(bytes)},KeyHashToken.prototype.ToBigMapKey=function(val){return{key:{string:val},type:{prim:KeyHashToken.prim}}},KeyHashToken.prim="key_hash",KeyHashToken}(ComparableToken),SignatureValidationError=function(_super){function SignatureValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="SignatureValidationError",_this}return __extends(SignatureValidationError,_super),SignatureValidationError}(TokenValidationError),taquito_michelson_encoder_es5_SignatureToken=function(_super){function SignatureToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(SignatureToken,_super),SignatureToken.prototype.Execute=function(val){return val.string},SignatureToken.prototype.isValid=function(value){return function validateSignature(value){return validatePrefixedValue(value,signaturePrefix)}(value)!==ValidationResult.VALID?new SignatureValidationError(value,this,"Signature is not valid"):null},SignatureToken.prototype.Encode=function(args){var val=args.pop(),err=this.isValid(val);if(err)throw err;return{string:val}},SignatureToken.prototype.EncodeObject=function(val){var err=this.isValid(val);if(err)throw err;return{string:val}},SignatureToken.prototype.ExtractSchema=function(){return SignatureToken.prim},SignatureToken.prim="signature",SignatureToken}(Token),LambdaToken=function(_super){function LambdaToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(LambdaToken,_super),LambdaToken.prototype.Execute=function(val){return val.string},LambdaToken.prototype.Encode=function(args){return args.pop()},LambdaToken.prototype.EncodeObject=function(val){return val},LambdaToken.prototype.ExtractSchema=function(){var _a,leftToken=this.createToken(this.val.args[0],this.idx),rightToken=this.createToken(this.val.args[1],this.idx+1);return(_a={})[LambdaToken.prim]={parameters:leftToken.ExtractSchema(),returns:rightToken.ExtractSchema()},_a},LambdaToken.prim="lambda",LambdaToken}(Token),OperationToken=function(_super){function OperationToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(OperationToken,_super),OperationToken.prototype.Execute=function(val){return val.string},OperationToken.prototype.Encode=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var val=args.pop();return{string:val}},OperationToken.prototype.EncodeObject=function(val){return{string:val}},OperationToken.prototype.ExtractSchema=function(){return OperationToken.prim},OperationToken.prim="operation",OperationToken}(Token),SetValidationError=function(_super){function SetValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="SetValidationError",_this}return __extends(SetValidationError,_super),SetValidationError}(TokenValidationError),SetToken=function(_super){function SetToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(SetToken,_super),Object.defineProperty(SetToken.prototype,"KeySchema",{get:function(){return this.createToken(this.val.args[0],0)},enumerable:!1,configurable:!0}),SetToken.prototype.isValid=function(value){return Array.isArray(value)?null:new SetValidationError(value,this,"Value must be an array")},SetToken.prototype.Encode=function(args){var _this=this,val=args.pop(),err=this.isValid(val);if(err)throw err;return val.sort((function(a,b){return _this.KeySchema.compare(a,b)})).reduce((function(prev,current){return taquito_michelson_encoder_es5_spread(prev,[_this.KeySchema.EncodeObject(current)])}),[])},SetToken.prototype.Execute=function(val,semantics){var _this=this;return val.reduce((function(prev,current){return taquito_michelson_encoder_es5_spread(prev,[_this.KeySchema.Execute(current,semantics)])}),[])},SetToken.prototype.EncodeObject=function(args){var _this=this,err=this.isValid(args);if(err)throw err;return args.sort((function(a,b){return _this.KeySchema.compare(a,b)})).reduce((function(prev,current){return taquito_michelson_encoder_es5_spread(prev,[_this.KeySchema.EncodeObject(current)])}),[])},SetToken.prototype.ExtractSchema=function(){return SetToken.prim},SetToken.prim="set",SetToken}(Token),ChainIDValidationError=function(_super){function ChainIDValidationError(value,token,message){var _this=_super.call(this,value,token,message)||this;return _this.value=value,_this.token=token,_this.name="ChainIDValidationError",_this}return __extends(ChainIDValidationError,_super),ChainIDValidationError}(TokenValidationError),taquito_michelson_encoder_es5_ChainIDToken=function(_super){function ChainIDToken(val,idx,fac){var _this=_super.call(this,val,idx,fac)||this;return _this.val=val,_this.idx=idx,_this.fac=fac,_this}return __extends(ChainIDToken,_super),ChainIDToken.prototype.isValid=function(value){return function validateChain(value){return validatePrefixedValue(value,[Prefix.NET])}(value)!==ValidationResult.VALID?new ChainIDValidationError(value,this,"ChainID is not valid"):null},ChainIDToken.prototype.Execute=function(val){return val[Object.keys(val)[0]]},ChainIDToken.prototype.ExtractSchema=function(){return ChainIDToken.prim},ChainIDToken.prototype.Encode=function(args){var val=args.pop(),err=this.isValid(val);if(err)throw err;return{string:val}},ChainIDToken.prototype.EncodeObject=function(val){var err=this.isValid(val);if(err)throw err;return{string:val}},ChainIDToken.prototype.ToKey=function(_a){return _a.string},ChainIDToken.prototype.ToBigMapKey=function(val){return{key:{string:val},type:{prim:ChainIDToken.prim}}},ChainIDToken.prim="chain_id",ChainIDToken}(ComparableToken),tokens=[PairToken,taquito_michelson_encoder_es5_NatToken,StringToken,BigMapToken,taquito_michelson_encoder_es5_AddressToken,MapToken,BoolToken,OrToken,taquito_michelson_encoder_es5_ContractToken,ListToken,taquito_michelson_encoder_es5_MutezToken,BytesToken,OptionToken,TimestampToken,taquito_michelson_encoder_es5_IntToken,UnitToken,taquito_michelson_encoder_es5_KeyToken,taquito_michelson_encoder_es5_KeyHashToken,taquito_michelson_encoder_es5_SignatureToken,LambdaToken,OperationToken,SetToken,taquito_michelson_encoder_es5_ChainIDToken],InvalidTokenError=function InvalidTokenError(message,data){this.message=message,this.data=data,this.name="Invalid token error"};function createToken(val,idx){var t=tokens.find((function(x){return x.prim===val.prim}));if(!t)throw new InvalidTokenError("Malformed data expected a value with a valid prim property",val);return new t(val,idx,createToken)}var schemaTypeSymbol=Symbol.for("taquito-schema-type-symbol"),Schema=function(){function Schema(val){if(this[_a$1]=!0,this.root=createToken(val,0),this.root instanceof BigMapToken)this.bigMap=this.root;else if(this.isExpressionExtended(val)&&"pair"===val.prim){var exp=val.args[0];this.isExpressionExtended(exp)&&"big_map"===exp.prim&&(this.bigMap=new BigMapToken(exp,0,createToken))}}return Schema.isSchema=function(obj){return obj&&!0===obj[schemaTypeSymbol]},Schema.fromRPCResponse=function(val){var storage=val&&val.script&&Array.isArray(val.script.code)&&val.script.code.find((function(x){return"storage"===x.prim}));if(!storage||!Array.isArray(storage.args))throw new Error("Invalid rpc response passed as arguments");return new Schema(storage.args[0])},Schema.prototype.isExpressionExtended=function(val){return"prim"in val&&Array.isArray(val.args)},Schema.prototype.removeTopLevelAnnotation=function(obj){return(this.root instanceof PairToken||this.root instanceof OrToken)&&this.root.hasAnnotations()&&"object"==typeof obj&&1===Object.keys(obj).length?obj[Object.keys(obj)[0]]:obj},Schema.prototype.Execute=function(val,semantics){var storage=this.root.Execute(val,semantics);return this.removeTopLevelAnnotation(storage)},Schema.prototype.Typecheck=function(val){try{return this.root.EncodeObject(val),!0}catch(ex){return!1}},Schema.prototype.ExecuteOnBigMapDiff=function(diff,semantics){if(!this.bigMap)throw new Error("No big map schema");if(!Array.isArray(diff))throw new Error("Invalid big map diff. It must be an array");var eltFormat=diff.map((function(_b){return{args:[_b.key,_b.value]}}));return this.bigMap.Execute(eltFormat,semantics)},Schema.prototype.ExecuteOnBigMapValue=function(key,semantics){if(!this.bigMap)throw new Error("No big map schema");return this.bigMap.ValueSchema.Execute(key,semantics)},Schema.prototype.EncodeBigMapKey=function(key){if(!this.bigMap)throw new Error("No big map schema");try{return this.bigMap.KeySchema.ToBigMapKey(key)}catch(ex){throw new Error("Unable to encode big map key: "+ex)}},Schema.prototype.Encode=function(_value){try{return this.root.EncodeObject(_value)}catch(ex){if(ex instanceof TokenValidationError)throw ex;throw new Error("Unable to encode storage object. "+ex)}},Schema.prototype.ExtractSchema=function(){return this.removeTopLevelAnnotation(this.root.ExtractSchema())},Schema.prototype.ComputeState=function(tx,state){var _b,_this=this;if(!this.bigMap)throw new Error("No big map schema");var bigMap=tx.reduce((function(prev,current){return taquito_michelson_encoder_es5_assign(taquito_michelson_encoder_es5_assign({},prev),_this.ExecuteOnBigMapDiff(current.contents[0].metadata.operation_result.big_map_diff))}),{});return taquito_michelson_encoder_es5_assign(taquito_michelson_encoder_es5_assign({},this.Execute(state)),((_b={})[this.bigMap.annot()]=bigMap,_b))},Schema}();_a$1=schemaTypeSymbol;var ParameterSchema=function(){function ParameterSchema(val){this.root=createToken(val,0)}return ParameterSchema.fromRPCResponse=function(val){var parameter=val&&val.script&&Array.isArray(val.script.code)&&val.script.code.find((function(x){return"parameter"===x.prim}));if(!parameter||!Array.isArray(parameter.args))throw new Error("Invalid rpc response passed as arguments");return new ParameterSchema(parameter.args[0])},Object.defineProperty(ParameterSchema.prototype,"isMultipleEntryPoint",{get:function(){return this.root instanceof OrToken||this.root instanceof OptionToken&&this.root.subToken()instanceof OrToken},enumerable:!1,configurable:!0}),Object.defineProperty(ParameterSchema.prototype,"hasAnnotation",{get:function(){return!this.isMultipleEntryPoint||"0"!==Object.keys(this.ExtractSchema())[0]},enumerable:!1,configurable:!0}),ParameterSchema.prototype.Execute=function(val,semantics){return this.root.Execute(val,semantics)},ParameterSchema.prototype.Encode=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];try{return this.root.Encode(args.reverse())}catch(ex){if(ex instanceof TokenValidationError)throw ex;throw new Error("Unable to encode storage object. "+ex)}},ParameterSchema.prototype.ExtractSchema=function(){return this.root.ExtractSchema()},ParameterSchema.prototype.ExtractSignatures=function(){return this.root.ExtractSignature()},ParameterSchema}(),UnitValue=Symbol(),taquito_michel_codec_es5_extendStatics=function(d,b){return(taquito_michel_codec_es5_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)};function taquito_michel_codec_es5_extends(d,b){function __(){this.constructor=d}taquito_michel_codec_es5_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var taquito_michel_codec_es5_assign=function(){return(taquito_michel_codec_es5_assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function taquito_michel_codec_es5_generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}function taquito_michel_codec_es5_values(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}function taquito_michel_codec_es5_read(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar}function taquito_michel_codec_es5_spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(taquito_michel_codec_es5_read(arguments[i]));return ar}var Literal,ScanError=function(_super){function ScanError(src,idx,message){var _this=_super.call(this,message)||this;return _this.src=src,_this.idx=idx,_this}return taquito_michel_codec_es5_extends(ScanError,_super),ScanError}(Error);!function(Literal){Literal[Literal.Comment=0]="Comment",Literal[Literal.Number=1]="Number",Literal[Literal.String=2]="String",Literal[Literal.Bytes=3]="Bytes",Literal[Literal.Ident=4]="Ident"}(Literal||(Literal={}));var isSpace=new RegExp("\\s"),isIdentStart=new RegExp("[:@%_A-Za-z]"),isIdent=new RegExp("[@%_\\.A-Za-z0-9]"),isDigit=new RegExp("[0-9]"),isHex=new RegExp("[0-9a-fA-F]");function scan(src,scanComments){var i,s,start,ii,esc;return void 0===scanComments&&(scanComments=!1),taquito_michel_codec_es5_generator(this,(function(_a){switch(_a.label){case 0:i=0,_a.label=1;case 1:if(!(i<src.length))return[3,16];for(;i<src.length&&isSpace.test(src[i]);)i++;if(i===src.length)return[2];if(s=src[i],start=i,!isIdentStart.test(s))return[3,3];for(i++;i<src.length&&isIdent.test(src[i]);)i++;return[4,{t:Literal.Ident,v:src.slice(start,i),offset:i}];case 2:return _a.sent(),[3,15];case 3:if(!(src.length-i>1&&"0x"===src.substr(i,2)))return[3,5];for(i+=2;i<src.length&&isHex.test(src[i]);)i++;if(i-start==2)throw new ScanError(src,i,"Bytes literal is too short");if(0!=(i-start&1))throw new ScanError(src,i,"Bytes literal length is expected to be power of two");return[4,{t:Literal.Bytes,v:src.slice(start,i),offset:i}];case 4:return _a.sent(),[3,15];case 5:if(!isDigit.test(s)&&"-"!==s)return[3,7];for("-"===s&&i++,ii=i;i<src.length&&isDigit.test(src[i]);)i++;if(ii===i)throw new ScanError(src,i,"Number literal is too short");return[4,{t:Literal.Number,v:src.slice(start,i),offset:i}];case 6:return _a.sent(),[3,15];case 7:if('"'!==s)return[3,9];for(i++,esc=!1;i<src.length&&(esc||'"'!==src[i]);i++)esc=!esc&&"\\"===src[i];if(i===src.length)throw new ScanError(src,i,"Unterminated string literal");return i++,[4,{t:Literal.String,v:src.slice(start,i),offset:i}];case 8:return _a.sent(),[3,15];case 9:if("#"!==s)return[3,12];for(i++;i<src.length&&"\n"!==src[i];)i++;return scanComments?[4,{t:Literal.Comment,v:src.slice(start,i),offset:i}]:[3,11];case 10:_a.sent(),_a.label=11;case 11:return[3,15];case 12:return"("!==s&&")"!==s&&"{"!==s&&"}"!==s&&";"!==s?[3,14]:(i++,[4,{t:s,v:s,offset:i}]);case 13:return _a.sent(),[3,15];case 14:throw new ScanError(src,i,"Invalid character at offset "+i+": `"+s+"'");case 15:return[3,1];case 16:return[2]}}))}var MacroError=function(_super){function MacroError(prim,message){var _this=_super.call(this,message)||this;return _this.prim=prim,_this}return taquito_michel_codec_es5_extends(MacroError,_super),MacroError}(Error);function assertArgs(ex,n){var _a,_b;if(0===n&&void 0===ex.args||(null===(_a=ex.args)||void 0===_a?void 0:_a.length)===n)return!0;throw new MacroError(ex,"macro "+ex.prim+" expects "+n+" arguments, was given "+(null===(_b=ex.args)||void 0===_b?void 0:_b.length))}function assertNoAnnots(ex){if(void 0===ex.annots)return!0;throw new MacroError(ex,"unexpected annotation on macro "+ex.prim+": "+ex.annots)}function parsePairUnpairExpr(p,expr,annotations,agg){var res=[],i=0,ai=0,ann=[null,null];if(i===expr.length)throw new MacroError(p,"unexpected end: "+p.prim);var c=expr[i++];switch(c){case"P":var _a=parsePairUnpairExpr(p,expr.slice(i),annotations.slice(ai),agg),r=_a.r,n=_a.n,an=_a.an;res.push.apply(res,taquito_michel_codec_es5_spread(r)),i+=n,ai+=an;break;case"A":ai!==annotations.length&&(ann[0]=annotations[ai++]);break;default:throw new MacroError(p,p.prim+": unexpected character: "+c)}if(i===expr.length)throw new MacroError(p,"unexpected end: "+p.prim);switch(c=expr[i++]){case"P":var _b=parsePairUnpairExpr(p,expr.slice(i),annotations.slice(ai),agg);r=_b.r,n=_b.n,an=_b.an;res.push.apply(res,taquito_michel_codec_es5_spread(r.map((function(_a){var _b=taquito_michel_codec_es5_read(_a,2);return[_b[0]+1,_b[1]]})))),i+=n,ai+=an;break;case"I":ai!==annotations.length&&(ann[1]=annotations[ai++]);break;default:throw new MacroError(p,p.prim+": unexpected character: "+c)}return{r:agg(res,[0,ann]),n:i,an:ai}}function parseSetMapCadr(p,expr,vann,term){var c=expr[0];switch(c){case"A":return expr.length>1?[{prim:"DUP"},{prim:"DIP",args:[[{prim:"CAR",annots:["@%%"]},parseSetMapCadr(p,expr.slice(1),[],term)]]},{prim:"CDR",annots:["@%%"]},{prim:"SWAP"},{prim:"PAIR",annots:taquito_michel_codec_es5_spread(["%@","%@"],vann)}]:term.a;case"D":return expr.length>1?[{prim:"DUP"},{prim:"DIP",args:[[{prim:"CDR",annots:["@%%"]},parseSetMapCadr(p,expr.slice(1),[],term)]]},{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:taquito_michel_codec_es5_spread(["%@","%@"],vann)}]:term.d;default:throw new MacroError(p,p.prim+": unexpected character: "+c)}}function filterAnnotations(a){var e_1,_a,fields=[],rest=[];if(void 0!==a)try{for(var a_1=taquito_michel_codec_es5_values(a),a_1_1=a_1.next();!a_1_1.done;a_1_1=a_1.next()){var v=a_1_1.value;(0!==v.length&&"%"===v[0]?fields:rest).push(v)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{a_1_1&&!a_1_1.done&&(_a=a_1.return)&&_a.call(a_1)}finally{if(e_1)throw e_1.error}}return{fields:fields,rest:rest}}function mkPrim(_a){var prim=_a.prim,annots=_a.annots,args=_a.args;return taquito_michel_codec_es5_assign(taquito_michel_codec_es5_assign({prim:prim},annots&&{annots:annots}),args&&{args:args})}var pairRe=/^P[PAI]{3,}R$/,unpairRe=/^UNP[PAI]{2,}R$/,cadrRe=/^C[AD]{2,}R$/,setCadrRe=/^SET_C[AD]+R$/,mapCadrRe=/^MAP_C[AD]+R$/;function expandMacros(ex){function mayRename(annots){return void 0!==annots?[{prim:"RENAME",annots:annots}]:[]}switch(ex.prim){case"CMPEQ":case"CMPNEQ":case"CMPLT":case"CMPGT":case"CMPLE":case"CMPGE":if(assertArgs(ex,0))return[{prim:"COMPARE"},mkPrim({prim:ex.prim.slice(3),annots:ex.annots})];break;case"IFEQ":case"IFNEQ":case"IFLT":case"IFGT":case"IFLE":case"IFGE":if(assertArgs(ex,2))return[{prim:ex.prim.slice(2)},mkPrim({prim:"IF",annots:ex.annots,args:ex.args})];break;case"IFCMPEQ":case"IFCMPNEQ":case"IFCMPLT":case"IFCMPGT":case"IFCMPLE":case"IFCMPGE":if(assertArgs(ex,2))return[{prim:"COMPARE"},{prim:ex.prim.slice(5)},mkPrim({prim:"IF",annots:ex.annots,args:ex.args})];break;case"FAIL":if(assertArgs(ex,0)&&assertNoAnnots(ex))return[{prim:"UNIT"},{prim:"FAILWITH"}];break;case"ASSERT":if(assertArgs(ex,0)&&assertNoAnnots(ex))return[{prim:"IF",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_EQ":case"ASSERT_NEQ":case"ASSERT_LT":case"ASSERT_GT":case"ASSERT_LE":case"ASSERT_GE":if(assertArgs(ex,0)&&assertNoAnnots(ex))return[{prim:ex.prim.slice(7)},{prim:"IF",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_CMPEQ":case"ASSERT_CMPNEQ":case"ASSERT_CMPLT":case"ASSERT_CMPGT":case"ASSERT_CMPLE":case"ASSERT_CMPGE":if(assertArgs(ex,0)&&assertNoAnnots(ex))return[[{prim:"COMPARE"},{prim:ex.prim.slice(10)}],{prim:"IF",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_NONE":if(assertArgs(ex,0)&&assertNoAnnots(ex))return[{prim:"IF_NONE",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_SOME":if(assertArgs(ex,0))return[{prim:"IF_NONE",args:[[[{prim:"UNIT"},{prim:"FAILWITH"}]],mayRename(ex.annots)]}];break;case"ASSERT_LEFT":if(assertArgs(ex,0))return[{prim:"IF_LEFT",args:[mayRename(ex.annots),[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_RIGHT":if(assertArgs(ex,0))return[{prim:"IF_LEFT",args:[[[{prim:"UNIT"},{prim:"FAILWITH"}]],mayRename(ex.annots)]}];break;case"DUP":if(void 0===ex.args)return ex;if(assertArgs(ex,1)&&function assertIntArg(ex,arg){if("int"in arg)return!0;throw new MacroError(ex,"macro "+ex.prim+" expects int argument")}(ex,ex.args[0])){var n=parseInt(ex.args[0].int,10);return 1===n?[mkPrim({prim:"DUP",annots:ex.annots})]:2===n?[{prim:"DIP",args:[[mkPrim({prim:"DUP",annots:ex.annots})]]},{prim:"SWAP"}]:[{prim:"DIP",args:[{int:String(n-1)},[mkPrim({prim:"DUP",annots:ex.annots})]]},{prim:"DIG",args:[{int:String(n)}]}]}break;case"IF_SOME":if(assertArgs(ex,2))return[mkPrim({prim:"IF_NONE",annots:ex.annots,args:[ex.args[1],ex.args[0]]})];break;case"IF_RIGHT":if(assertArgs(ex,2))return[mkPrim({prim:"IF_LEFT",annots:ex.annots,args:[ex.args[1],ex.args[0]]})]}if(pairRe.test(ex.prim)&&assertArgs(ex,0)){var _a=filterAnnotations(ex.annots),fields=_a.fields,rest_1=_a.rest,r_1=parsePairUnpairExpr(ex,ex.prim.slice(1),fields,(function(a,v){return taquito_michel_codec_es5_spread(a,[v])})).r;return r_1.map((function(_a,i){var _b=taquito_michel_codec_es5_read(_a,2),v=_b[0],ann=taquito_michel_codec_es5_spread(function trimLast(a,v){for(var l=a.length;l>0&&a[l-1]===v;)l--;return a.slice(0,l)}(_b[1],null).map((function(v){return null===v?"%":v})),0===v&&i===r_1.length-1?rest_1:[]),leaf=mkPrim({prim:"PAIR",annots:0!==ann.length?ann:void 0});return 0===v?leaf:{prim:"DIP",args:1===v?[[leaf]]:[{int:String(v)},[leaf]]}}))}if(unpairRe.test(ex.prim)&&assertArgs(ex,0))return parsePairUnpairExpr(ex,ex.prim.slice(3),ex.annots||[],(function(a,v){return taquito_michel_codec_es5_spread([v],a)})).r.map((function(_a){var _b=taquito_michel_codec_es5_read(_a,2),v=_b[0],a=_b[1],leaf=[{prim:"DUP"},mkPrim({prim:"CAR",annots:null!==a[0]?[a[0]]:void 0}),{prim:"DIP",args:[[mkPrim({prim:"CDR",annots:null!==a[1]?[a[1]]:void 0})]]}];return 0===v?leaf:{prim:"DIP",args:1===v?[[leaf]]:[{int:String(v)},[leaf]]}}));if(cadrRe.test(ex.prim)&&assertArgs(ex,0)){var ch_1=taquito_michel_codec_es5_spread(ex.prim.slice(1,ex.prim.length-1));return ch_1.map((function(c,i){var ann=i===ch_1.length-1?ex.annots:void 0;switch(c){case"A":return mkPrim({prim:"CAR",annots:ann});case"D":return mkPrim({prim:"CDR",annots:ann});default:throw new MacroError(ex,"unexpected character: "+c)}}))}if(setCadrRe.test(ex.prim)&&assertArgs(ex,0)){var _b=filterAnnotations(ex.annots),rest=(fields=_b.fields,_b.rest);if(fields.length>1)throw new MacroError(ex,"unexpected annotation on macro "+ex.prim+": "+fields);var term=0!==fields.length?{a:[{prim:"DUP"},{prim:"CAR",annots:fields},{prim:"DROP"},{prim:"CDR",annots:["@%%"]},{prim:"SWAP"},{prim:"PAIR",annots:[fields[0],"%@"]}],d:[{prim:"DUP"},{prim:"CDR",annots:fields},{prim:"DROP"},{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@",fields[0]]}]}:{a:[{prim:"CDR",annots:["@%%"]},{prim:"SWAP"},{prim:"PAIR",annots:["%","%@"]}],d:[{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@","%"]}]};return parseSetMapCadr(ex,ex.prim.slice(5,ex.prim.length-1),rest,term)}if(mapCadrRe.test(ex.prim)&&assertArgs(ex,1)){if((fields=filterAnnotations(ex.annots).fields).length>1)throw new MacroError(ex,"unexpected annotation on macro "+ex.prim+": "+fields);term={a:[{prim:"DUP"},{prim:"CDR",annots:["@%%"]},{prim:"DIP",args:[[mkPrim({prim:"CAR",annots:0!==fields.length?["@"+fields[0].slice(1)]:void 0}),ex.args[0]]]},{prim:"SWAP"},{prim:"PAIR",annots:[0!==fields.length?fields[0]:"%","%@"]}],d:[{prim:"DUP"},mkPrim({prim:"CDR",annots:0!==fields.length?["@"+fields[0].slice(1)]:void 0}),ex.args[0],{prim:"SWAP"},{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@",0!==fields.length?fields[0]:"%"]}]};return parseSetMapCadr(ex,ex.prim.slice(5,ex.prim.length-1),[],term)}return ex}var MichelineParseError=function(_super){function MichelineParseError(token,message){var _this=_super.call(this,message)||this;return _this.token=token,_this}return taquito_michel_codec_es5_extends(MichelineParseError,_super),MichelineParseError}(Error),JSONParseError=function(_super){function JSONParseError(node,message){var _this=_super.call(this,message)||this;return _this.node=node,_this}return taquito_michel_codec_es5_extends(JSONParseError,_super),JSONParseError}(Error),errEOF=new MichelineParseError(null,"Unexpected EOF");function isAnnotation(tok){return tok.t===Literal.Ident&&("@"===tok.v[0]||"%"===tok.v[0]||":"===tok.v[0])}var intRe=new RegExp("^-?[0-9]+$"),bytesRe=new RegExp("^([0-9a-fA-F]{2})+$"),Parser=function(){function Parser(opt){this.opt=opt}return Parser.prototype.expand=function(ex){var _a;return(null===(_a=this.opt)||void 0===_a?void 0:_a.expandMacros)?expandMacros(ex):ex},Parser.prototype.parseList=function(scanner){var tok=scanner.next();if(tok.done)throw errEOF;if(tok.value.t!==Literal.Ident)throw new MichelineParseError(tok.value,"List: not an identifier: "+tok.value.v);for(var ret={prim:tok.value.v};;){var tok_1=scanner.next();if(tok_1.done)throw errEOF;if(")"===tok_1.value.t)break;isAnnotation(tok_1.value)?(ret.annots=ret.annots||[],ret.annots.push(tok_1.value.v)):(ret.args=ret.args||[],ret.args.push(this.parseExpr(scanner,tok_1.value)))}return this.expand(ret)},Parser.prototype.parseArgs=function(scanner,prim,expectBracket){for(var p={prim:prim};;){var t=scanner.next();if(t.done){if(expectBracket)throw errEOF;return[p,!0]}if("}"===t.value.t){if(expectBracket)return[p,!0];throw new MichelineParseError(t.value,"Seq: unexpected token: "+t.value.v)}if(";"===t.value.t)return[p,!1];isAnnotation(t.value)?(p.annots=p.annots||[],p.annots.push(t.value.v)):(p.args=p.args||[],p.args.push(this.parseExpr(scanner,t.value)))}},Parser.prototype.parseSequence=function(scanner,initialToken,expectBracket){for(var seq=[];;){var tok=void 0;if(null!==initialToken)tok=initialToken,initialToken=null;else{if((t=scanner.next()).done){if(expectBracket)throw errEOF;return seq}tok=t.value}if("}"===tok.t){if(expectBracket)return seq;throw new MichelineParseError(tok,"Seq: unexpected token: "+tok.v)}if(tok.t===Literal.Ident){var _a=taquito_michel_codec_es5_read(this.parseArgs(scanner,tok.v,expectBracket),2),itm=_a[0],done=_a[1];if(seq.push(this.expand(itm)),done)return seq}else{var t;if(seq.push(this.parseExpr(scanner,tok)),(t=scanner.next()).done){if(expectBracket)throw errEOF;return seq}if("}"===t.value.t){if(expectBracket)return seq;throw new MichelineParseError(t.value,"Seq: unexpected token: "+t.value.v)}if(";"!==t.value.t)throw new MichelineParseError(t.value,"Seq: unexpected token: "+t.value.v)}}},Parser.prototype.parseExpr=function(scanner,tok){switch(tok.t){case Literal.Ident:return this.expand({prim:tok.v});case Literal.Number:return{int:tok.v};case Literal.String:return{string:JSON.parse(tok.v)};case Literal.Bytes:return{bytes:tok.v.substr(2)};case"(":return this.parseList(scanner);case"{":return this.parseSequence(scanner,null,!0);default:throw new MichelineParseError(tok,"Expr: unexpected token: "+tok.v)}},Parser.prototype.parseScript=function(src){var scanner=scan(src),tok=scanner.next();return tok.done?null:"{"===tok.value.t?this.parseSequence(scanner,null,!0):this.parseSequence(scanner,tok.value,!1)},Parser.prototype.parseMichelineExpression=function(src){var scanner=scan(src),tok=scanner.next();return tok.done?null:this.parseExpr(scanner,tok.value)},Parser.prototype.parseJSON=function(src){var e_1,_a,e_2,_b,e_3,_c;if(Array.isArray(src)){var ret=[];try{for(var src_1=taquito_michel_codec_es5_values(src),src_1_1=src_1.next();!src_1_1.done;src_1_1=src_1.next()){var n=src_1_1.value;if(null===n||"object"!=typeof n)throw new JSONParseError(n,"unexpected sequence element: "+n);ret.push(this.parseJSON(n))}}catch(e_1_1){e_1={error:e_1_1}}finally{try{src_1_1&&!src_1_1.done&&(_a=src_1.return)&&_a.call(src_1)}finally{if(e_1)throw e_1.error}}return ret}if("prim"in src){var p=src;if("string"==typeof p.prim&&(void 0===p.annots||Array.isArray(p.annots))&&(void 0===p.args||Array.isArray(p.args))){ret={prim:p.prim};if(void 0!==p.annots){try{for(var _d=taquito_michel_codec_es5_values(p.annots),_e=_d.next();!_e.done;_e=_d.next()){if("string"!=typeof(a=_e.value))throw new JSONParseError(a,"string expected: "+a)}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_e&&!_e.done&&(_b=_d.return)&&_b.call(_d)}finally{if(e_2)throw e_2.error}}ret.annots=p.annots}if(void 0!==p.args){ret.args=[];try{for(var _f=taquito_michel_codec_es5_values(p.args),_g=_f.next();!_g.done;_g=_f.next()){var a;if(null===(a=_g.value)||"object"!=typeof a)throw new JSONParseError(a,"unexpected argument: "+a);ret.args.push(this.parseJSON(a))}}catch(e_3_1){e_3={error:e_3_1}}finally{try{_g&&!_g.done&&(_c=_f.return)&&_c.call(_f)}finally{if(e_3)throw e_3.error}}}return this.expand(ret)}throw new JSONParseError(src,"malformed prim expression: "+src)}if("string"in src){if("string"==typeof src.string)return{string:src.string};throw new JSONParseError(src,"malformed string literal: "+src)}if("int"in src){if("string"==typeof src.int&&intRe.test(src.int))return{int:src.int};throw new JSONParseError(src,"malformed int literal: "+src)}if("bytes"in src){if("string"==typeof src.bytes&&bytesRe.test(src.bytes))return{bytes:src.bytes};throw new JSONParseError(src,"malformed bytes literal: "+src)}throw new JSONParseError(src,"unexpected object: "+src)},Parser}();!function(){function Formatter(opt,lev){void 0===lev&&(lev=0),this.opt=opt,this.lev=lev}Formatter.prototype.indent=function(n){var _a;void 0===n&&(n=0);var ret="";if(void 0!==(null===(_a=this.opt)||void 0===_a?void 0:_a.indent))for(var i=this.lev+n;i>0;i--)ret+=this.opt.indent;return ret},Object.defineProperty(Formatter.prototype,"lf",{get:function(){var _a;return(null===(_a=this.opt)||void 0===_a?void 0:_a.newline)||""},enumerable:!1,configurable:!0}),Object.defineProperty(Formatter.prototype,"lfsp",{get:function(){var _a;return(null===(_a=this.opt)||void 0===_a?void 0:_a.newline)||" "},enumerable:!1,configurable:!0}),Formatter.prototype.down=function(n){return new Formatter(this.opt,this.lev+n)}}();!function(_super){function ValidationError(val,path,message){var _this=_super.call(this,message)||this;return _this.val=val,_this.path=path,_this}taquito_michel_codec_es5_extends(ValidationError,_super)}(Error);var unaryInstructionTable={DUP:!0,SWAP:!0,SOME:!0,UNIT:!0,PAIR:!0,CAR:!0,CDR:!0,CONS:!0,SIZE:!0,MEM:!0,GET:!0,UPDATE:!0,EXEC:!0,FAILWITH:!0,RENAME:!0,CONCAT:!0,SLICE:!0,PACK:!0,ADD:!0,SUB:!0,MUL:!0,EDIV:!0,ABS:!0,ISNAT:!0,INT:!0,NEG:!0,LSL:!0,LSR:!0,OR:!0,AND:!0,XOR:!0,NOT:!0,COMPARE:!0,EQ:!0,NEQ:!0,LT:!0,GT:!0,LE:!0,GE:!0,SELF:!0,TRANSFER_TOKENS:!0,SET_DELEGATE:!0,CREATE_ACCOUNT:!0,IMPLICIT_ACCOUNT:!0,NOW:!0,AMOUNT:!0,BALANCE:!0,CHECK_SIGNATURE:!0,BLAKE2B:!0,SHA256:!0,SHA512:!0,HASH_KEY:!0,STEPS_TO_QUOTA:!0,SOURCE:!0,SENDER:!0,ADDRESS:!0,CHAIN_ID:!0};Object.assign({},unaryInstructionTable,{DROP:!0,DIG:!0,DUG:!0,NONE:!0,LEFT:!0,RIGHT:!0,NIL:!0,UNPACK:!0,CONTRACT:!0,CAST:!0,IF_NONE:!0,IF_LEFT:!0,IF_CONS:!0,IF:!0,MAP:!0,ITER:!0,LOOP:!0,LOOP_LEFT:!0,DIP:!0,CREATE_CONTRACT:!0,PUSH:!0,EMPTY_SET:!0,EMPTY_MAP:!0,EMPTY_BIG_MAP:!0,LAMBDA:!0});var taquito_es5_extendStatics=function(d,b){return(taquito_es5_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)};function taquito_es5_extends(d,b){function __(){this.constructor=d}taquito_es5_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var taquito_es5_assign=function(){return(taquito_es5_assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function taquito_es5_rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}function taquito_es5_awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))}function taquito_es5_generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}function taquito_es5_values(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}function taquito_es5_read(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar}function taquito_es5_spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(taquito_es5_read(arguments[i]));return ar}var DEFAULT_GAS_LIMIT,DEFAULT_FEE,DEFAULT_STORAGE_LIMIT,Protocols,RpcForger=function(){function RpcForger(context){this.context=context}return RpcForger.prototype.forge=function(_a){var branch=_a.branch,contents=_a.contents;return this.context.rpc.forgeOperations({branch:branch,contents:contents})},RpcForger}(),RpcInjector=function(){function RpcInjector(context){this.context=context}return RpcInjector.prototype.inject=function(signedOperationBytes){return this.context.rpc.injectOperation(signedOperationBytes)},RpcInjector}(),UnconfiguredSignerError=function UnconfiguredSignerError(){this.name="UnconfiguredSignerError",this.message="No signer has been configured. Please configure one by calling setProvider({signer}) on your TezosToolkit instance."},NoopSigner=function(){function NoopSigner(){}return NoopSigner.prototype.publicKey=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){throw new UnconfiguredSignerError}))}))},NoopSigner.prototype.publicKeyHash=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){throw new UnconfiguredSignerError}))}))},NoopSigner.prototype.secretKey=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){throw new UnconfiguredSignerError}))}))},NoopSigner.prototype.sign=function(_bytes,_watermark){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){throw new UnconfiguredSignerError}))}))},NoopSigner}(),attachKind=function(op,kind){return taquito_es5_assign(taquito_es5_assign({},op),{kind:kind})},findWithKind=function(arr,kind){if(Array.isArray(arr)){var found=arr.find((function(op){return op.kind===kind}));if(found&&isKind(found,kind))return found}},isKind=function(op,kind){return op.kind===kind},isOpWithFee=function(op){return-1!==["transaction","delegation","origination","reveal"].indexOf(op.kind)},hasMetadata=function(op){return"metadata"in op},hasMetadataWithResult=function(op){return hasMetadata(op)&&"operation_result"in op.metadata},TezosOperationError=function TezosOperationError(errors){this.errors=errors,this.name="TezosOperationError";var lastError=errors[errors.length-1];this.id=lastError.id,this.kind=lastError.kind,this.message="("+this.kind+") "+this.id,"with"in lastError&&lastError.with.string&&(this.message=lastError.with.string)},TezosPreapplyFailureError=function TezosPreapplyFailureError(result){this.result=result,this.name="TezosPreapplyFailureError",this.message="Preapply returned an unexpected result"},flattenOperationResult=function(response){for(var results=Array.isArray(response)?response:[response],returnedResults=[],i=0;i<results.length;i++)for(var j=0;j<results[i].contents.length;j++){var content=results[i].contents[j];hasMetadataWithResult(content)&&(returnedResults.push(taquito_es5_assign({fee:content.fee},content.metadata.operation_result)),Array.isArray(content.metadata.internal_operation_results)&&content.metadata.internal_operation_results.forEach((function(x){return returnedResults.push(x.result)})))}return returnedResults},flattenErrors=function(response,status){var e_1,_a;void 0===status&&(status="failed");for(var op,results=Array.isArray(response)?response:[response],errors=[],i=0;i<results.length;i++)for(var j=0;j<results[i].contents.length;j++){var content=results[i].contents[j];if(hasMetadata(content)&&(hasMetadataWithResult(content)&&content.metadata.operation_result.status===status&&(errors=errors.concat(content.metadata.operation_result.errors||[])),hasMetadata(op=content)&&"internal_operation_results"in op.metadata&&Array.isArray(content.metadata.internal_operation_results)))try{for(var _b=(e_1=void 0,taquito_es5_values(content.metadata.internal_operation_results)),_c=_b.next();!_c.done;_c=_b.next()){var internalResult=_c.value;"result"in internalResult&&internalResult.result.status===status&&(errors=errors.concat(internalResult.result.errors||[]))}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}}return errors},receiptFromOperation=function(op,_a){var _b=void 0===_a?{ALLOCATION_BURN:257,ORIGINATION_BURN:257}:_a,ALLOCATION_BURN=_b.ALLOCATION_BURN,ORIGINATION_BURN=_b.ORIGINATION_BURN,operationResults=flattenOperationResult({contents:op}),totalGas=new bignumber_js_bignumber_default.a(0),totalStorage=new bignumber_js_bignumber_default.a(0),totalFee=new bignumber_js_bignumber_default.a(0),totalOriginationBurn=new bignumber_js_bignumber_default.a(0),totalAllocationBurn=new bignumber_js_bignumber_default.a(0),totalPaidStorageDiff=new bignumber_js_bignumber_default.a(0);return operationResults.forEach((function(result){totalFee=totalFee.plus(result.fee||0),totalOriginationBurn=totalOriginationBurn.plus(Array.isArray(result.originated_contracts)?result.originated_contracts.length*ORIGINATION_BURN:0),totalAllocationBurn=totalAllocationBurn.plus("allocated_destination_contract"in result?ALLOCATION_BURN:0),totalGas=totalGas.plus(result.consumed_gas||0),totalPaidStorageDiff=totalPaidStorageDiff.plus("paid_storage_size_diff"in result&&Number(result.paid_storage_size_diff)||0)})),totalStorage=totalStorage.plus(totalAllocationBurn).plus(totalOriginationBurn).plus(totalPaidStorageDiff),{totalFee:totalFee,totalGas:totalGas,totalStorage:totalStorage,totalAllocationBurn:totalAllocationBurn,totalOriginationBurn:totalOriginationBurn,totalPaidStorageDiff:totalPaidStorageDiff,totalStorageBurn:new bignumber_js_bignumber_default.a(totalStorage.multipliedBy(1e3))}},MissedBlockDuringConfirmationError=function MissedBlockDuringConfirmationError(){this.name="MissedBlockDuringConfirmationError",this.message="Taquito missed a block while waiting for operation confirmation and was not able to find the operation"},taquito_es5_WalletOperation=function(){function WalletOperation(opHash,context,_newHead$){var _this=this;this.opHash=opHash,this.context=context,this._newHead$=_newHead$,this._operationResult=new ReplaySubject.a(1),this._includedInBlock=new ReplaySubject.a(1),this._included=!1,this.newHead$=this._newHead$.pipe(Object(tap.a)((function(newHead){if(!_this._included&&_this.lastHead&&newHead.header.level-_this.lastHead.header.level>1)throw new MissedBlockDuringConfirmationError;_this.lastHead=newHead})),Object(shareReplay.a)({bufferSize:1,refCount:!0})),this.confirmed$=this.newHead$.pipe(Object(map.a)((function(head){var e_1,_a,e_2,_b;try{for(var _c=taquito_es5_values(head.operations),_d=_c.next();!_d.done;_d=_c.next()){var opGroup=_d.value;try{for(var opGroup_1=(e_2=void 0,taquito_es5_values(opGroup)),opGroup_1_1=opGroup_1.next();!opGroup_1_1.done;opGroup_1_1=opGroup_1.next()){var op=opGroup_1_1.value;if(op.hash===_this.opHash)return _this._included=!0,_this._includedInBlock.next(head),_this._operationResult.next(op.contents),head}}catch(e_2_1){e_2={error:e_2_1}}finally{try{opGroup_1_1&&!opGroup_1_1.done&&(_b=opGroup_1.return)&&_b.call(opGroup_1)}finally{if(e_2)throw e_2.error}}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_1)throw e_1.error}}})),Object(operators_filter.a)((function(x){return void 0!==x})),Object(first.a)(),Object(shareReplay.a)({bufferSize:1,refCount:!0})),this.confirmed$.pipe(Object(first.a)()).subscribe()}return WalletOperation.prototype.operationResults=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){return[2,this._operationResult.pipe(Object(first.a)()).toPromise()]}))}))},WalletOperation.prototype.receipt=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){var _a;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return _a=receiptFromOperation,[4,this.operationResults()];case 1:return[2,_a.apply(void 0,[_b.sent()])]}}))}))},WalletOperation.prototype.getCurrentConfirmation=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){return this._included?[2,Object(combineLatest.a)([this._includedInBlock,Object(observable_from.a)(this.context.rpc.getBlock())]).pipe(Object(map.a)((function(_a){var _b=taquito_es5_read(_a,2),foundAtBlock=_b[0];return _b[1].header.level-foundAtBlock.header.level+1})),Object(first.a)()).toPromise()]:[2,0]}))}))},WalletOperation.prototype.isInCurrentBranch=function(tipBlockIdentifier){return void 0===tipBlockIdentifier&&(tipBlockIdentifier="head"),taquito_es5_awaiter(this,void 0,void 0,(function(){var tipBlockHeader,inclusionBlock,levelDiff,tipBlockLevel,_a;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return this._included?[4,this.context.rpc.getBlockHeader({block:tipBlockIdentifier})]:[2,!0];case 1:return tipBlockHeader=_b.sent(),[4,this._includedInBlock.pipe(Object(first.a)()).toPromise()];case 2:return inclusionBlock=_b.sent(),(levelDiff=tipBlockHeader.level-inclusionBlock.header.level)<=0?[2,!0]:(tipBlockLevel=Math.min(inclusionBlock.header.level+levelDiff,inclusionBlock.header.level+60),_a=Set.bind,[4,this.context.rpc.getLiveBlocks({block:String(tipBlockLevel)})]);case 3:return[2,(new(_a.apply(Set,[void 0,_b.sent()]))).has(inclusionBlock.hash)]}}))}))},WalletOperation.prototype.confirmationObservable=function(confirmations){var _this=this;if(void 0!==confirmations&&confirmations<1)throw new Error("Confirmation count must be at least 1");var defaultConfirmationCount=this.context.config.defaultConfirmationCount,conf=void 0!==confirmations?confirmations:defaultConfirmationCount;return Object(combineLatest.a)([this._includedInBlock,this.newHead$]).pipe(Object(distinctUntilChanged.a)((function(_a,_b){var previousHead=taquito_es5_read(_a,2)[1],newHead=taquito_es5_read(_b,2)[1];return previousHead.hash===newHead.hash})),Object(map.a)((function(_a){var _b=taquito_es5_read(_a,2),foundAtBlock=_b[0],head=_b[1];return{block:head,expectedConfirmation:conf,currentConfirmation:head.header.level-foundAtBlock.header.level+1,completed:head.header.level-foundAtBlock.header.level>=conf-1,isInCurrentBranch:function(){return _this.isInCurrentBranch(head.hash)}}})),Object(takeWhile.a)((function(_a){return!_a.completed}),!0))},WalletOperation.prototype.confirmation=function(confirmations){return this.confirmationObservable(confirmations).toPromise()},WalletOperation}(),taquito_es5_DelegationWalletOperation=function(_super){function DelegationWalletOperation(opHash,context,newHead$){var _this=_super.call(this,opHash,context,newHead$)||this;return _this.opHash=opHash,_this.context=context,_this}return taquito_es5_extends(DelegationWalletOperation,_super),DelegationWalletOperation.prototype.revealOperation=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.operationResults()];case 1:return[2,_a.sent().find((function(x){return x.kind===OpKind.REVEAL}))]}}))}))},DelegationWalletOperation.prototype.delegationOperation=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.operationResults()];case 1:return[2,_a.sent().find((function(x){return x.kind===OpKind.DELEGATION}))]}}))}))},DelegationWalletOperation.prototype.status=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){var op;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return this._included?[4,this.delegationOperation()]:[2,"pending"];case 1:return(op=_a.sent())?[2,op.metadata.operation_result.status]:[2,"unknown"]}}))}))},DelegationWalletOperation}(taquito_es5_WalletOperation),taquito_es5_OriginationWalletOperation=function(_super){function OriginationWalletOperation(opHash,context,newHead$){var _this=_super.call(this,opHash,context,newHead$)||this;return _this.opHash=opHash,_this.context=context,_this}return taquito_es5_extends(OriginationWalletOperation,_super),OriginationWalletOperation.prototype.originationOperation=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){var operationResult;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.operationResults()];case 1:return operationResult=_a.sent(),[2,findWithKind(operationResult,OpKind.ORIGINATION)]}}))}))},OriginationWalletOperation.prototype.revealOperation=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){var operationResult;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.operationResults()];case 1:return operationResult=_a.sent(),[2,findWithKind(operationResult,OpKind.REVEAL)]}}))}))},OriginationWalletOperation.prototype.status=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){var op;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return this._included?[4,this.originationOperation()]:[2,"pending"];case 1:return(op=_a.sent())?[2,op.metadata.operation_result.status]:[2,"unknown"]}}))}))},OriginationWalletOperation.prototype.contract=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){var op,address;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.originationOperation()];case 1:return op=_a.sent(),address=(op.metadata.operation_result.originated_contracts||[])[0],[2,this.context.wallet.at(address)]}}))}))},OriginationWalletOperation}(taquito_es5_WalletOperation),taquito_es5_TransactionWalletOperation=function(_super){function TransactionWalletOperation(opHash,context,newHead$){var _this=_super.call(this,opHash,context,newHead$)||this;return _this.opHash=opHash,_this.context=context,_this}return taquito_es5_extends(TransactionWalletOperation,_super),TransactionWalletOperation.prototype.revealOperation=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.operationResults()];case 1:return[2,_a.sent().find((function(x){return x.kind===OpKind.REVEAL}))]}}))}))},TransactionWalletOperation.prototype.transactionOperation=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.operationResults()];case 1:return[2,_a.sent().find((function(x){return x.kind===OpKind.TRANSACTION}))]}}))}))},TransactionWalletOperation.prototype.status=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){var op;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return this._included?[4,this.transactionOperation()]:[2,"pending"];case 1:return(op=_a.sent())?[2,op.metadata.operation_result.status]:[2,"unknown"]}}))}))},TransactionWalletOperation}(taquito_es5_WalletOperation),taquito_es5_OperationFactory=function(){function OperationFactory(context){var cacheUntilObs,_this=this;this.context=context,this.sharedHeadObs=Object(defer.a)((function(){return Object(observable_from.a)(_this.context.rpc.getBlock())})).pipe((cacheUntilObs=Object(timer.a)(0,1e3),function(source){var subject=null;return Object(defer.a)((function(){return subject||(subject=new ReplaySubject.a,source.pipe(Object(first.a)()).subscribe(subject),cacheUntilObs.pipe(Object(first.a)()).subscribe((function(){subject=null}))),subject}))}))}return OperationFactory.prototype.createNewHeadObservable=function(){return pollingTimer=Object(timer.a)(0,1e3*this.context.config.confirmationPollingIntervalSecond),sharedHeadOb=this.sharedHeadObs,context=this.context,pollingTimer.pipe(Object(switchMap.a)((function(){return sharedHeadOb})),Object(distinctUntilKeyChanged.a)("hash"),Object(timeoutWith.a)(1e3*context.config.confirmationPollingTimeoutSecond,Object(throwError.a)(new Error("Confirmation polling timed out")),scheduler),Object(shareReplay.a)({refCount:!0,scheduler:scheduler}));var pollingTimer,sharedHeadOb,context,scheduler},OperationFactory.prototype.createPastBlockWalker=function(startBlock,count){var _this=this;return void 0===count&&(count=1),Object(observable_from.a)(this.context.rpc.getBlock({block:startBlock})).pipe(Object(switchMap.a)((function(block){return 1===count?Object(of.a)(block):Object(range.a)(block.header.level,count-1).pipe(Object(startWith.a)(block),Object(concatMap.a)((function(level){return taquito_es5_awaiter(_this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){return[2,this.context.rpc.getBlock({block:String(level)})]}))}))})))})))},OperationFactory.prototype.createHeadObservableFromConfig=function(_a){var blockIdentifier=_a.blockIdentifier,observableSequence=[];return blockIdentifier&&observableSequence.push(this.createPastBlockWalker(blockIdentifier)),observableSequence.push(this.createNewHeadObservable()),concat.a.apply(void 0,taquito_es5_spread(observableSequence))},OperationFactory.prototype.createOperation=function(hash,config){return void 0===config&&(config={}),new taquito_es5_WalletOperation(hash,this.context.clone(),this.createHeadObservableFromConfig(config))},OperationFactory.prototype.createTransactionOperation=function(hash,config){return void 0===config&&(config={}),new taquito_es5_TransactionWalletOperation(hash,this.context.clone(),this.createHeadObservableFromConfig(config))},OperationFactory.prototype.createDelegationOperation=function(hash,config){return void 0===config&&(config={}),new taquito_es5_DelegationWalletOperation(hash,this.context.clone(),this.createHeadObservableFromConfig(config))},OperationFactory.prototype.createOriginationOperation=function(hash,config){return void 0===config&&(config={}),new taquito_es5_OriginationWalletOperation(hash,this.context.clone(),this.createHeadObservableFromConfig(config))},OperationFactory}();!function(DEFAULT_GAS_LIMIT){DEFAULT_GAS_LIMIT[DEFAULT_GAS_LIMIT.DELEGATION=10600]="DELEGATION",DEFAULT_GAS_LIMIT[DEFAULT_GAS_LIMIT.ORIGINATION=10600]="ORIGINATION",DEFAULT_GAS_LIMIT[DEFAULT_GAS_LIMIT.TRANSFER=10600]="TRANSFER",DEFAULT_GAS_LIMIT[DEFAULT_GAS_LIMIT.REVEAL=10600]="REVEAL"}(DEFAULT_GAS_LIMIT||(DEFAULT_GAS_LIMIT={})),function(DEFAULT_FEE){DEFAULT_FEE[DEFAULT_FEE.DELEGATION=1257]="DELEGATION",DEFAULT_FEE[DEFAULT_FEE.ORIGINATION=1e4]="ORIGINATION",DEFAULT_FEE[DEFAULT_FEE.TRANSFER=1e4]="TRANSFER",DEFAULT_FEE[DEFAULT_FEE.REVEAL=1420]="REVEAL"}(DEFAULT_FEE||(DEFAULT_FEE={})),function(DEFAULT_STORAGE_LIMIT){DEFAULT_STORAGE_LIMIT[DEFAULT_STORAGE_LIMIT.DELEGATION=0]="DELEGATION",DEFAULT_STORAGE_LIMIT[DEFAULT_STORAGE_LIMIT.ORIGINATION=257]="ORIGINATION",DEFAULT_STORAGE_LIMIT[DEFAULT_STORAGE_LIMIT.TRANSFER=257]="TRANSFER",DEFAULT_STORAGE_LIMIT[DEFAULT_STORAGE_LIMIT.REVEAL=0]="REVEAL"}(DEFAULT_STORAGE_LIMIT||(DEFAULT_STORAGE_LIMIT={})),function(Protocols){Protocols.Pt24m4xi="Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd",Protocols.PsBABY5H="PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU",Protocols.PsBabyM1="PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS",Protocols.PsCARTHA="PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb"}(Protocols||(Protocols={}));Protocols.Pt24m4xi,Protocols.PsBABY5H,Protocols.PsBabyM1,Protocols.PsCARTHA;var taquito_es5_OperationEmitter=function(){function OperationEmitter(context){this.context=context}return Object.defineProperty(OperationEmitter.prototype,"rpc",{get:function(){return this.context.rpc},enumerable:!1,configurable:!0}),Object.defineProperty(OperationEmitter.prototype,"signer",{get:function(){return this.context.signer},enumerable:!1,configurable:!0}),OperationEmitter.prototype.prepareOperation=function(_a){var operation=_a.operation,source=_a.source;return taquito_es5_awaiter(this,void 0,void 0,(function(){var counter,counters,requiresReveal,ops,head,blockHeaderPromise,blockMetaPromise,publicKeyHash,counterPromise,managerPromise,i,counter_1,_b,header,metadata,headCounter,manager,reveal,_c,getFee,getSource,constructOps,branch,contents,protocol;return taquito_es5_generator(this,(function(_d){switch(_d.label){case 0:return counters={},requiresReveal=!1,ops=[],blockHeaderPromise=this.rpc.getBlockHeader(),blockMetaPromise=this.rpc.getBlockMetadata(),ops=Array.isArray(operation)?taquito_es5_spread(operation):[operation],[4,this.signer.publicKeyHash()];case 1:publicKeyHash=_d.sent(),counterPromise=Promise.resolve(void 0),managerPromise=Promise.resolve(void 0),i=0,_d.label=2;case 2:return i<ops.length?(op=ops[i],-1===["transaction","delegation","origination"].indexOf(op.kind)?[3,4]:(requiresReveal=!0,[4,this.rpc.getContract(publicKeyHash)])):[3,5];case 3:return counter_1=_d.sent().counter,counterPromise=Promise.resolve(counter_1),managerPromise=this.rpc.getManagerKey(publicKeyHash),[3,5];case 4:return i++,[3,2];case 5:return[4,Promise.all([blockHeaderPromise,blockMetaPromise,counterPromise,managerPromise])];case 6:if(_b=taquito_es5_read.apply(void 0,[_d.sent(),4]),header=_b[0],metadata=_b[1],headCounter=_b[2],manager=_b[3],!header)throw new Error("Unable to fetch latest block header");if(!metadata)throw new Error("Unable to fetch latest metadata");return head=header,requiresReveal?(manager&&"object"==typeof manager?!!manager.key:!!manager)?[3,8]:(_c={kind:OpKind.REVEAL,fee:DEFAULT_FEE.REVEAL},[4,this.signer.publicKey()]):[3,8];case 7:_c.public_key=_d.sent(),_c.source=publicKeyHash,_c.gas_limit=DEFAULT_GAS_LIMIT.REVEAL,_c.storage_limit=DEFAULT_STORAGE_LIMIT.REVEAL,reveal=_c,ops.unshift(reveal),_d.label=8;case 8:return counter=parseInt(headCounter||"0",10),(!counters[publicKeyHash]||counters[publicKeyHash]<counter)&&(counters[publicKeyHash]=counter),getFee=function(op){return{counter:""+ ++counters[publicKeyHash],fee:void 0===op.fee?"0":""+op.fee,gas_limit:void 0===op.gas_limit?"0":""+op.gas_limit,storage_limit:void 0===op.storage_limit?"0":""+op.storage_limit}},getSource=function(op){return{source:void 0===op.source?source||publicKeyHash:op.source}},constructOps=function(cOps){return cOps.map((function(op){switch(op.kind){case OpKind.ACTIVATION:return taquito_es5_assign({},op);case OpKind.REVEAL:return taquito_es5_assign(taquito_es5_assign(taquito_es5_assign({},op),getSource(op)),getFee(op));case OpKind.ORIGINATION:return taquito_es5_assign(taquito_es5_assign(taquito_es5_assign(taquito_es5_assign({},op),{balance:void 0!==op.balance?""+op.balance:"0"}),getSource(op)),getFee(op));case OpKind.TRANSACTION:var cops=taquito_es5_assign(taquito_es5_assign(taquito_es5_assign(taquito_es5_assign({},op),{amount:void 0!==op.amount?""+op.amount:"0"}),getSource(op)),getFee(op));if(cops.source.toLowerCase().startsWith("kt1"))throw new Error("KT1 addresses are not supported as source since "+Protocols.PsBabyM1);return cops;case OpKind.DELEGATION:return taquito_es5_assign(taquito_es5_assign(taquito_es5_assign({},op),getSource(op)),getFee(op));default:throw new Error("Unsupported operation")}}))},branch=head.hash,contents=constructOps(ops),protocol=metadata.next_protocol,[2,{opOb:{branch:branch,contents:contents,protocol:protocol},counter:counter}]}var op}))}))},OperationEmitter.prototype.prepareAndForge=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){var prepared;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.prepareOperation(params)];case 1:return prepared=_a.sent(),[2,this.forge(prepared)]}}))}))},OperationEmitter.prototype.forge=function(_a){var _b=_a.opOb,branch=_b.branch,contents=_b.contents,protocol=_b.protocol,counter=_a.counter;return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_c){switch(_c.label){case 0:return[4,this.context.forger.forge({branch:branch,contents:contents})];case 1:return[2,{opbytes:_c.sent(),opOb:{branch:branch,contents:contents,protocol:protocol},counter:counter}]}}))}))},OperationEmitter.prototype.simulate=function(op){return taquito_es5_awaiter(this,void 0,void 0,(function(){var _a;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return _a={},[4,this.rpc.runOperation(op)];case 1:return[2,(_a.opResponse=_b.sent(),_a.op=op,_a.context=this.context.clone(),_a)]}}))}))},OperationEmitter.prototype.estimate=function(_a,estimator){var fee=_a.fee,gasLimit=_a.gasLimit,storageLimit=_a.storageLimit,rest=taquito_es5_rest(_a,["fee","gasLimit","storageLimit"]);return taquito_es5_awaiter(this,void 0,void 0,(function(){var calculatedFee,calculatedGas,calculatedStorage,estimation;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return calculatedFee=fee,calculatedGas=gasLimit,calculatedStorage=storageLimit,void 0!==fee&&void 0!==gasLimit&&void 0!==storageLimit?[3,2]:[4,estimator(taquito_es5_assign({fee:fee,gasLimit:gasLimit,storageLimit:storageLimit},rest))];case 1:estimation=_b.sent(),void 0===calculatedFee&&(calculatedFee=estimation.suggestedFeeMutez),void 0===calculatedGas&&(calculatedGas=estimation.gasLimit),void 0===calculatedStorage&&(calculatedStorage=estimation.storageLimit),_b.label=2;case 2:return[2,{fee:calculatedFee,gasLimit:calculatedGas,storageLimit:calculatedStorage}]}}))}))},OperationEmitter.prototype.signAndInject=function(forgedBytes){return taquito_es5_awaiter(this,void 0,void 0,(function(){var signed,opResponse,results,i,j,errors,_a;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return[4,this.signer.sign(forgedBytes.opbytes,new Uint8Array([3]))];case 1:return signed=_b.sent(),forgedBytes.opbytes=signed.sbytes,forgedBytes.opOb.signature=signed.prefixSig,opResponse=[],[4,this.rpc.preapplyOperations([forgedBytes.opOb])];case 2:if(results=_b.sent(),!Array.isArray(results))throw new TezosPreapplyFailureError(results);for(i=0;i<results.length;i++)for(j=0;j<results[i].contents.length;j++)opResponse.push(results[i].contents[j]);if((errors=flattenErrors(results)).length)throw new TezosOperationError(errors);return _a={},[4,this.context.injector.inject(forgedBytes.opbytes)];case 3:return[2,(_a.hash=_b.sent(),_a.forgedBytes=forgedBytes,_a.opResponse=opResponse,_a.context=this.context.clone(),_a)]}}))}))},OperationEmitter}(),taquito_es5_Operation=function(){function Operation(hash,raw,results,context){var _this=this;this.hash=hash,this.raw=raw,this.results=results,this.context=context,this._pollingConfig$=new ReplaySubject.a(1),this._currentHeadPromise=void 0,this.currentHead$=Object(defer.a)((function(){return _this._currentHeadPromise||(_this._currentHeadPromise=_this.context.rpc.getBlock(),Object(timer.a)(1e3).pipe(Object(first.a)()).subscribe((function(){_this._currentHeadPromise=void 0}))),Object(observable_from.a)(_this._currentHeadPromise)})),this.polling$=Object(defer.a)((function(){return _this._pollingConfig$.pipe(Object(tap.a)((function(_a){var timeout=_a.timeout,interval=_a.interval;if(timeout<=0)throw new Error("Timeout must be more than 0");if(interval<=0)throw new Error("Interval must be more than 0")})),Object(map.a)((function(config){return taquito_es5_assign(taquito_es5_assign({},config),{timeoutAt:Math.ceil(config.timeout/config.interval)+1,count:0})})),Object(switchMap.a)((function(config){return Object(timer.a)(0,1e3*config.interval).pipe(Object(mapTo.a)(config))})),Object(tap.a)((function(config){if(config.count++,config.count>config.timeoutAt)throw new Error("Confirmation polling timed out")})))})),this.confirmed$=this.polling$.pipe(Object(switchMapTo.a)(this.currentHead$),Object(map.a)((function(head){for(var i=3;i>=0;i--)head.operations[i].forEach((function(op){op.hash===_this.hash&&(_this._foundAt=head.header.level)}));if(head.header.level-_this._foundAt>=0)return _this._foundAt})),Object(operators_filter.a)((function(x){return void 0!==x})),Object(first.a)(),Object(shareReplay.a)()),this._foundAt=Number.POSITIVE_INFINITY,this.confirmed$.pipe(Object(first.a)()).subscribe()}return Object.defineProperty(Operation.prototype,"includedInBlock",{get:function(){return this._foundAt},enumerable:!1,configurable:!0}),Object.defineProperty(Operation.prototype,"revealOperation",{get:function(){return Array.isArray(this.results)&&this.results.find((function(op){return"reveal"===op.kind}))},enumerable:!1,configurable:!0}),Object.defineProperty(Operation.prototype,"revealStatus",{get:function(){return this.revealOperation?this.revealOperation.metadata.operation_result.status:"unknown"},enumerable:!1,configurable:!0}),Object.defineProperty(Operation.prototype,"status",{get:function(){return this.results.map((function(result){return hasMetadataWithResult(result)?result.metadata.operation_result.status:"unknown"}))[0]||"unknown"},enumerable:!1,configurable:!0}),Operation.prototype.confirmation=function(confirmations,interval,timeout){var _this=this;if(void 0!==confirmations&&confirmations<1)throw new Error("Confirmation count must be at least 1");var _a=this.context.config,defaultConfirmationCount=_a.defaultConfirmationCount,confirmationPollingIntervalSecond=_a.confirmationPollingIntervalSecond,confirmationPollingTimeoutSecond=_a.confirmationPollingTimeoutSecond;this._pollingConfig$.next({interval:interval||confirmationPollingIntervalSecond,timeout:timeout||confirmationPollingTimeoutSecond});var conf=void 0!==confirmations?confirmations:defaultConfirmationCount;return new Promise((function(resolve,reject){_this.confirmed$.pipe(Object(switchMap.a)((function(){return _this.polling$})),Object(switchMap.a)((function(){return _this.currentHead$})),Object(operators_filter.a)((function(head){return head.header.level-_this._foundAt>=conf-1})),Object(first.a)()).subscribe((function(_){resolve(_this._foundAt+(conf-1))}),reject)}))},Operation}(),taquito_es5_RpcTzProvider=function(_super){function RpcTzProvider(context){return _super.call(this,context)||this}return taquito_es5_extends(RpcTzProvider,_super),RpcTzProvider.prototype.getBalance=function(address){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){return[2,this.rpc.getBalance(address)]}))}))},RpcTzProvider.prototype.getDelegate=function(address){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){return[2,this.rpc.getDelegate(address)]}))}))},RpcTzProvider.prototype.activate=function(pkh,secret){return taquito_es5_awaiter(this,void 0,void 0,(function(){var operation,forgedBytes,bytes,_a;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return operation={kind:OpKind.ACTIVATION,pkh:pkh,secret:secret},[4,this.prepareAndForge({operation:[operation],source:pkh})];case 1:return forgedBytes=_b.sent(),bytes=forgedBytes.opbytes+"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",_a=taquito_es5_Operation.bind,[4,this.rpc.injectOperation(bytes)];case 2:return[2,new(_a.apply(taquito_es5_Operation,[void 0,_b.sent(),taquito_es5_assign(taquito_es5_assign({},forgedBytes),{opbytes:bytes}),[],this.context.clone()]))]}}))}))},RpcTzProvider}(taquito_es5_OperationEmitter),Estimate=function(){function Estimate(_gasLimit,_storageLimit,opSize,baseFeeMutez){void 0===baseFeeMutez&&(baseFeeMutez=100),this._gasLimit=_gasLimit,this._storageLimit=_storageLimit,this.opSize=opSize,this.baseFeeMutez=baseFeeMutez}return Object.defineProperty(Estimate.prototype,"burnFeeMutez",{get:function(){return this.roundUp(1e3*Number(this.storageLimit))},enumerable:!1,configurable:!0}),Object.defineProperty(Estimate.prototype,"storageLimit",{get:function(){var limit=Math.max(Number(this._storageLimit),0);return limit>0?limit:0},enumerable:!1,configurable:!0}),Object.defineProperty(Estimate.prototype,"gasLimit",{get:function(){return Number(this._gasLimit)+100},enumerable:!1,configurable:!0}),Object.defineProperty(Estimate.prototype,"operationFeeMutez",{get:function(){return.1*this.gasLimit+1*Number(this.opSize)},enumerable:!1,configurable:!0}),Estimate.prototype.roundUp=function(nanotez){return Math.ceil(Number(nanotez))},Object.defineProperty(Estimate.prototype,"minimalFeeMutez",{get:function(){return this.roundUp(100+this.operationFeeMutez)},enumerable:!1,configurable:!0}),Object.defineProperty(Estimate.prototype,"suggestedFeeMutez",{get:function(){return this.roundUp(this.operationFeeMutez+200)},enumerable:!1,configurable:!0}),Object.defineProperty(Estimate.prototype,"usingBaseFeeMutez",{get:function(){return Math.max(Number(this.baseFeeMutez),100)+this.roundUp(this.operationFeeMutez)},enumerable:!1,configurable:!0}),Object.defineProperty(Estimate.prototype,"totalCost",{get:function(){return this.minimalFeeMutez+this.burnFeeMutez},enumerable:!1,configurable:!0}),Estimate}();function getDecimal(format){switch(format){case"tz":return 6;case"mtz":return 3;case"mutez":default:return 0}}function format(from,to,amount){void 0===from&&(from="mutez"),void 0===to&&(to="mutez");var bigNum=new bignumber_js_bignumber_default.a(amount);return bigNum.isNaN()?amount:bigNum.multipliedBy(Math.pow(10,getDecimal(from))).dividedBy(Math.pow(10,getDecimal(to)))}var createOriginationOperation=function(_a){var code=_a.code,init=_a.init,_b=_a.balance,balance=void 0===_b?"0":_b,delegate=_a.delegate,storage=_a.storage,_c=_a.fee,fee=void 0===_c?DEFAULT_FEE.ORIGINATION:_c,_d=_a.gasLimit,gasLimit=void 0===_d?DEFAULT_GAS_LIMIT.ORIGINATION:_d,_e=_a.storageLimit,storageLimit=void 0===_e?DEFAULT_STORAGE_LIMIT.ORIGINATION:_e;return taquito_es5_awaiter(void 0,void 0,void 0,(function(){var parser,contractCode,order_1,contractStorage,storageType,schema,c,script,operation;return taquito_es5_generator(this,(function(_f){if(void 0!==storage&&void 0!==init)throw new Error("Storage and Init cannot be set a the same time. Please either use storage or init but not both.");if(parser=new Parser({expandMacros:!0}),"string"==typeof code){if(null===(c=parser.parseScript(code)))throw new Error("Empty Michelson source");contractCode=c}else{if(c=parser.parseJSON(code),!Array.isArray(c))throw new Error("JSON encoded Michelson script must be an array");order_1=["parameter","storage","code"],contractCode=c.sort((function(a,b){return order_1.indexOf(a.prim)-order_1.indexOf(b.prim)}))}if(void 0!==storage){if(void 0===(null==(storageType=contractCode.find((function(p){return"prim"in p&&"storage"===p.prim})))?void 0:storageType.args))throw new Error("Missing storage section");schema=new Schema(storageType.args[0]),contractStorage=schema.Encode(storage)}else if("string"==typeof init){if(null===(c=parser.parseMichelineExpression(init)))throw new Error("Empty initial storage value");contractStorage=c}else"object"==typeof init&&(contractStorage=parser.parseJSON(init));return script={code:contractCode,storage:contractStorage},operation={kind:OpKind.ORIGINATION,fee:fee,gas_limit:gasLimit,storage_limit:storageLimit,balance:format("tz","mutez",balance).toString(),script:script},delegate&&(operation.delegate=delegate),[2,operation]}))}))},createTransferOperation=function(_a){var to=_a.to,amount=_a.amount,parameter=_a.parameter,_b=_a.fee,fee=void 0===_b?DEFAULT_FEE.TRANSFER:_b,_c=_a.gasLimit,gasLimit=void 0===_c?DEFAULT_GAS_LIMIT.TRANSFER:_c,_d=_a.storageLimit,storageLimit=void 0===_d?DEFAULT_STORAGE_LIMIT.TRANSFER:_d,_e=_a.mutez,mutez=void 0!==_e&&_e;return taquito_es5_awaiter(void 0,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_f){return[2,{kind:OpKind.TRANSACTION,fee:fee,gas_limit:gasLimit,storage_limit:storageLimit,amount:mutez?amount.toString():format("tz","mutez",amount).toString(),destination:to,parameters:parameter}]}))}))},createSetDelegateOperation=function(_a){var delegate=_a.delegate,source=_a.source,_b=_a.fee,fee=void 0===_b?DEFAULT_FEE.DELEGATION:_b,_c=_a.gasLimit,gasLimit=void 0===_c?DEFAULT_GAS_LIMIT.DELEGATION:_c,_d=_a.storageLimit,storageLimit=void 0===_d?DEFAULT_STORAGE_LIMIT.DELEGATION:_d;return taquito_es5_awaiter(void 0,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_e){return[2,{kind:OpKind.DELEGATION,source:source,fee:fee,gas_limit:gasLimit,storage_limit:storageLimit,delegate:delegate}]}))}))},createRegisterDelegateOperation=function(_a,source){var _b=_a.fee,fee=void 0===_b?DEFAULT_FEE.DELEGATION:_b,_c=_a.gasLimit,gasLimit=void 0===_c?DEFAULT_GAS_LIMIT.DELEGATION:_c,_d=_a.storageLimit,storageLimit=void 0===_d?DEFAULT_STORAGE_LIMIT.DELEGATION:_d;return taquito_es5_awaiter(void 0,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_e){return[2,{kind:OpKind.DELEGATION,fee:fee,gas_limit:gasLimit,storage_limit:storageLimit,delegate:source}]}))}))},mergeLimits=function(userDefinedLimit,defaultLimits){return{fee:void 0===userDefinedLimit.fee?defaultLimits.fee:userDefinedLimit.fee,gasLimit:void 0===userDefinedLimit.gasLimit?defaultLimits.gasLimit:userDefinedLimit.gasLimit,storageLimit:void 0===userDefinedLimit.storageLimit?defaultLimits.storageLimit:userDefinedLimit.storageLimit}},taquito_es5_RPCEstimateProvider=function(_super){function RPCEstimateProvider(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.ALLOCATION_STORAGE=257,_this.ORIGINATION_STORAGE=257,_this}return taquito_es5_extends(RPCEstimateProvider,_super),RPCEstimateProvider.prototype.getAccountLimits=function(pkh){return taquito_es5_awaiter(this,void 0,void 0,(function(){var balance,_a,hard_gas_limit_per_operation,hard_storage_limit_per_operation,cost_per_byte;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return[4,this.rpc.getBalance(pkh)];case 1:return balance=_b.sent(),[4,this.rpc.getConstants()];case 2:return _a=_b.sent(),hard_gas_limit_per_operation=_a.hard_gas_limit_per_operation,hard_storage_limit_per_operation=_a.hard_storage_limit_per_operation,cost_per_byte=_a.cost_per_byte,[2,{fee:0,gasLimit:hard_gas_limit_per_operation.toNumber(),storageLimit:Math.floor(bignumber_js_bignumber_default.a.min(balance.dividedBy(cost_per_byte),hard_storage_limit_per_operation).toNumber())}]}}))}))},RPCEstimateProvider.prototype.createEstimateFromOperationContent=function(content,size){var _this=this,operationResults=flattenOperationResult({contents:[content]}),totalGas=0,totalStorage=0;return operationResults.forEach((function(result){totalStorage+="originated_contracts"in result&&void 0!==result.originated_contracts?result.originated_contracts.length*_this.ORIGINATION_STORAGE:0,totalStorage+="allocated_destination_contract"in result?_this.ALLOCATION_STORAGE:0,totalGas+=Number(result.consumed_gas)||0,totalStorage+="paid_storage_size_diff"in result&&Number(result.paid_storage_size_diff)||0})),isOpWithFee(content)?new Estimate(totalGas||0,Number(totalStorage||0),size):new Estimate(0,0,size,0)},RPCEstimateProvider.prototype.createEstimate=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){var _a,opbytes,_b,branch,contents,operation,_c,opResponse,errors,_this=this;return taquito_es5_generator(this,(function(_d){switch(_d.label){case 0:return[4,this.prepareAndForge(params)];case 1:return _a=_d.sent(),opbytes=_a.opbytes,_b=_a.opOb,branch=_b.branch,contents=_b.contents,_c={operation:{branch:branch,contents:contents,signature:"edsigtkpiSSschcaCt9pUVrpNPf7TTcgvgDEDD6NCEHMy8NNQJCGnMfLZzYoQj74yLjo9wx6MPVV29CvVzgi7qEcEUok3k7AuMg"}},[4,this.rpc.getChainId()];case 2:return _c.chain_id=_d.sent(),operation=_c,[4,this.simulate(operation)];case 3:if(opResponse=_d.sent().opResponse,(errors=taquito_es5_spread(flattenErrors(opResponse,"backtracked"),flattenErrors(opResponse))).length)throw new TezosOperationError(errors);for(;opResponse.contents.length!==(Array.isArray(params.operation)?params.operation.length:1);)opResponse.contents.shift();return[2,opResponse.contents.map((function(x){return _this.createEstimateFromOperationContent(x,opbytes.length/2/opResponse.contents.length)}))]}}))}))},RPCEstimateProvider.prototype.originate=function(_a){var fee=_a.fee,storageLimit=_a.storageLimit,gasLimit=_a.gasLimit,rest=taquito_es5_rest(_a,["fee","storageLimit","gasLimit"]);return taquito_es5_awaiter(this,void 0,void 0,(function(){var pkh,DEFAULT_PARAMS,op;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return[4,this.signer.publicKeyHash()];case 1:return pkh=_b.sent(),[4,this.getAccountLimits(pkh)];case 2:return DEFAULT_PARAMS=_b.sent(),[4,createOriginationOperation(taquito_es5_assign(taquito_es5_assign({},rest),mergeLimits({fee:fee,storageLimit:storageLimit,gasLimit:gasLimit},DEFAULT_PARAMS)))];case 3:return op=_b.sent(),[4,this.createEstimate({operation:op,source:pkh})];case 4:return[2,_b.sent()[0]]}}))}))},RPCEstimateProvider.prototype.transfer=function(_a){var fee=_a.fee,storageLimit=_a.storageLimit,gasLimit=_a.gasLimit,rest=taquito_es5_rest(_a,["fee","storageLimit","gasLimit"]);return taquito_es5_awaiter(this,void 0,void 0,(function(){var pkh,DEFAULT_PARAMS,op;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return[4,this.signer.publicKeyHash()];case 1:return pkh=_b.sent(),[4,this.getAccountLimits(pkh)];case 2:return DEFAULT_PARAMS=_b.sent(),[4,createTransferOperation(taquito_es5_assign(taquito_es5_assign({},rest),mergeLimits({fee:fee,storageLimit:storageLimit,gasLimit:gasLimit},DEFAULT_PARAMS)))];case 3:return op=_b.sent(),[4,this.createEstimate({operation:op,source:pkh})];case 4:return[2,_b.sent()[0]]}}))}))},RPCEstimateProvider.prototype.setDelegate=function(_a){var fee=_a.fee,gasLimit=_a.gasLimit,storageLimit=_a.storageLimit,rest=taquito_es5_rest(_a,["fee","gasLimit","storageLimit"]);return taquito_es5_awaiter(this,void 0,void 0,(function(){var sourceOrDefault,_b,DEFAULT_PARAMS,op;return taquito_es5_generator(this,(function(_c){switch(_c.label){case 0:return(_b=rest.source)?[3,2]:[4,this.signer.publicKeyHash()];case 1:_b=_c.sent(),_c.label=2;case 2:return sourceOrDefault=_b,[4,this.getAccountLimits(sourceOrDefault)];case 3:return DEFAULT_PARAMS=_c.sent(),[4,createSetDelegateOperation(taquito_es5_assign(taquito_es5_assign({},rest),mergeLimits({fee:fee,storageLimit:storageLimit,gasLimit:gasLimit},DEFAULT_PARAMS)))];case 4:return op=_c.sent(),[4,this.createEstimate({operation:op,source:sourceOrDefault})];case 5:return[2,_c.sent()[0]]}}))}))},RPCEstimateProvider.prototype.batch=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){var operations,DEFAULT_PARAMS,_a,params_1,params_1_1,param,_c,_d,_e,_f,_g,_h,e_1_1,e_1,_j;return taquito_es5_generator(this,(function(_k){switch(_k.label){case 0:return operations=[],_a=this.getAccountLimits,[4,this.signer.publicKeyHash()];case 1:return[4,_a.apply(this,[_k.sent()])];case 2:DEFAULT_PARAMS=_k.sent(),_k.label=3;case 3:_k.trys.push([3,15,16,17]),params_1=taquito_es5_values(params),params_1_1=params_1.next(),_k.label=4;case 4:if(params_1_1.done)return[3,14];switch(param=params_1_1.value,param.kind){case OpKind.TRANSACTION:return[3,5];case OpKind.ORIGINATION:return[3,7];case OpKind.DELEGATION:return[3,9];case OpKind.ACTIVATION:return[3,11]}return[3,12];case 5:return _d=(_c=operations).push,[4,createTransferOperation(taquito_es5_assign(taquito_es5_assign({},param),mergeLimits(param,DEFAULT_PARAMS)))];case 6:return _d.apply(_c,[_k.sent()]),[3,13];case 7:return _f=(_e=operations).push,[4,createOriginationOperation(taquito_es5_assign(taquito_es5_assign({},param),mergeLimits(param,DEFAULT_PARAMS)))];case 8:return _f.apply(_e,[_k.sent()]),[3,13];case 9:return _h=(_g=operations).push,[4,createSetDelegateOperation(taquito_es5_assign(taquito_es5_assign({},param),mergeLimits(param,DEFAULT_PARAMS)))];case 10:return _h.apply(_g,[_k.sent()]),[3,13];case 11:return operations.push(taquito_es5_assign(taquito_es5_assign({},param),DEFAULT_PARAMS)),[3,13];case 12:throw new Error("Unsupported operation kind: "+param.kind);case 13:return params_1_1=params_1.next(),[3,4];case 14:return[3,17];case 15:return e_1_1=_k.sent(),e_1={error:e_1_1},[3,17];case 16:try{params_1_1&&!params_1_1.done&&(_j=params_1.return)&&_j.call(params_1)}finally{if(e_1)throw e_1.error}return[7];case 17:return[2,this.createEstimate({operation:operations})]}}))}))},RPCEstimateProvider.prototype.registerDelegate=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){var DEFAULT_PARAMS,_a,op,_b,_c,_d,_e;return taquito_es5_generator(this,(function(_f){switch(_f.label){case 0:return _a=this.getAccountLimits,[4,this.signer.publicKeyHash()];case 1:return[4,_a.apply(this,[_f.sent()])];case 2:return DEFAULT_PARAMS=_f.sent(),_b=createRegisterDelegateOperation,_c=[taquito_es5_assign(taquito_es5_assign({},params),DEFAULT_PARAMS)],[4,this.signer.publicKeyHash()];case 3:return[4,_b.apply(void 0,_c.concat([_f.sent()]))];case 4:return op=_f.sent(),_d=this.createEstimate,_e={operation:op},[4,this.signer.publicKeyHash()];case 5:return[4,_d.apply(this,[(_e.source=_f.sent(),_e)])];case 6:return[2,_f.sent()[0]]}}))}))},RPCEstimateProvider}(taquito_es5_OperationEmitter),DelegateOperation=function(_super){function DelegateOperation(hash,params,source,raw,results,context){var _this=_super.call(this,hash,raw,results,context)||this;return _this.params=params,_this.source=source,_this}return taquito_es5_extends(DelegateOperation,_super),Object.defineProperty(DelegateOperation.prototype,"operationResults",{get:function(){var delegationOp=Array.isArray(this.results)&&this.results.find((function(op){return"delegation"===op.kind})),result=delegationOp&&delegationOp.metadata&&delegationOp.metadata.operation_result;return result||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(DelegateOperation.prototype,"status",{get:function(){var operationResults=this.operationResults;return operationResults?operationResults.status:"unknown"},enumerable:!1,configurable:!0}),Object.defineProperty(DelegateOperation.prototype,"delegate",{get:function(){return this.delegate},enumerable:!1,configurable:!0}),Object.defineProperty(DelegateOperation.prototype,"isRegisterOperation",{get:function(){return this.delegate===this.source},enumerable:!1,configurable:!0}),Object.defineProperty(DelegateOperation.prototype,"fee",{get:function(){return this.params.fee},enumerable:!1,configurable:!0}),Object.defineProperty(DelegateOperation.prototype,"gasLimit",{get:function(){return this.params.gas_limit},enumerable:!1,configurable:!0}),Object.defineProperty(DelegateOperation.prototype,"storageLimit",{get:function(){return this.params.storage_limit},enumerable:!1,configurable:!0}),Object.defineProperty(DelegateOperation.prototype,"consumedGas",{get:function(){var consumedGas=this.operationResults&&this.operationResults.consumed_gas;return consumedGas||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(DelegateOperation.prototype,"errors",{get:function(){return this.operationResults&&this.operationResults.errors},enumerable:!1,configurable:!0}),DelegateOperation}(taquito_es5_Operation),OriginationOperation=function(_super){function OriginationOperation(hash,params,raw,results,context,contractProvider){var _this=_super.call(this,hash,raw,results,context)||this;_this.params=params,_this.contractProvider=contractProvider;var originatedContracts=_this.operationResults&&_this.operationResults.originated_contracts;return Array.isArray(originatedContracts)&&(_this.contractAddress=originatedContracts[0]),_this}return taquito_es5_extends(OriginationOperation,_super),Object.defineProperty(OriginationOperation.prototype,"status",{get:function(){var operationResults=this.operationResults;return operationResults?operationResults.status:"unknown"},enumerable:!1,configurable:!0}),Object.defineProperty(OriginationOperation.prototype,"operationResults",{get:function(){var originationOp=Array.isArray(this.results)&&this.results.find((function(op){return"origination"===op.kind})),result=originationOp&&hasMetadataWithResult(originationOp)&&originationOp.metadata.operation_result;return result||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(OriginationOperation.prototype,"fee",{get:function(){return this.params.fee},enumerable:!1,configurable:!0}),Object.defineProperty(OriginationOperation.prototype,"gasLimit",{get:function(){return this.params.gas_limit},enumerable:!1,configurable:!0}),Object.defineProperty(OriginationOperation.prototype,"storageLimit",{get:function(){return this.params.storage_limit},enumerable:!1,configurable:!0}),Object.defineProperty(OriginationOperation.prototype,"consumedGas",{get:function(){var consumedGas=this.operationResults&&this.operationResults.consumed_gas;return consumedGas||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(OriginationOperation.prototype,"storageDiff",{get:function(){var storageDiff=this.operationResults&&this.operationResults.paid_storage_size_diff;return storageDiff||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(OriginationOperation.prototype,"storageSize",{get:function(){var storageSize=this.operationResults&&this.operationResults.storage_size;return storageSize||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(OriginationOperation.prototype,"errors",{get:function(){return this.operationResults&&this.operationResults.errors},enumerable:!1,configurable:!0}),OriginationOperation.prototype.contract=function(confirmations,interval,timeout){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:if(!this.contractAddress)throw new Error("No contract was originated in this operation");return[4,this.confirmation(confirmations,interval,timeout)];case 1:return _a.sent(),[2,this.contractProvider.at(this.contractAddress)]}}))}))},OriginationOperation}(taquito_es5_Operation),taquito_es5_TransactionOperation=function(_super){function TransactionOperation(hash,params,source,raw,results,context){var _this=_super.call(this,hash,raw,results,context)||this;return _this.params=params,_this.source=source,_this}return taquito_es5_extends(TransactionOperation,_super),Object.defineProperty(TransactionOperation.prototype,"operationResults",{get:function(){var transactionOp=Array.isArray(this.results)&&this.results.find((function(op){return"transaction"===op.kind}));return transactionOp?[transactionOp]:[]},enumerable:!1,configurable:!0}),Object.defineProperty(TransactionOperation.prototype,"status",{get:function(){var txResult=this.operationResults[0];return txResult?txResult.metadata.operation_result.status:"unknown"},enumerable:!1,configurable:!0}),Object.defineProperty(TransactionOperation.prototype,"amount",{get:function(){return new bignumber_js_bignumber_default.a(this.params.amount)},enumerable:!1,configurable:!0}),Object.defineProperty(TransactionOperation.prototype,"destination",{get:function(){return this.params.destination},enumerable:!1,configurable:!0}),Object.defineProperty(TransactionOperation.prototype,"fee",{get:function(){return this.params.fee},enumerable:!1,configurable:!0}),Object.defineProperty(TransactionOperation.prototype,"gasLimit",{get:function(){return this.params.gas_limit},enumerable:!1,configurable:!0}),Object.defineProperty(TransactionOperation.prototype,"storageLimit",{get:function(){return this.params.storage_limit},enumerable:!1,configurable:!0}),TransactionOperation.prototype.sumProp=function(arr,prop){return arr.reduce((function(prev,current){return prop in current?Number(current[prop])+prev:prev}),0)},Object.defineProperty(TransactionOperation.prototype,"consumedGas",{get:function(){return String(this.sumProp(flattenOperationResult({contents:this.operationResults}),"consumed_gas"))},enumerable:!1,configurable:!0}),Object.defineProperty(TransactionOperation.prototype,"storageDiff",{get:function(){return String(this.sumProp(flattenOperationResult({contents:this.operationResults}),"paid_storage_size_diff"))},enumerable:!1,configurable:!0}),Object.defineProperty(TransactionOperation.prototype,"storageSize",{get:function(){return String(this.sumProp(flattenOperationResult({contents:this.operationResults}),"storage_size"))},enumerable:!1,configurable:!0}),Object.defineProperty(TransactionOperation.prototype,"errors",{get:function(){return flattenErrors({contents:this.operationResults})},enumerable:!1,configurable:!0}),TransactionOperation}(taquito_es5_Operation),InvalidParameterError=function InvalidParameterError(smartContractMethodName,sigs,args){this.smartContractMethodName=smartContractMethodName,this.sigs=sigs,this.args=args,this.name="Invalid parameters error",this.message=smartContractMethodName+" Received "+args.length+" arguments while expecting one of the following signatures ("+JSON.stringify(sigs)+")"},InvalidDelegationSource=function InvalidDelegationSource(source){this.source=source,this.name="Invalid delegation source error",this.message="Since Babylon delegation source can no longer be a contract address "+source+". Please use the smart contract abstraction to set your delegate."},taquito_es5_WalletOperationBatch=function(){function WalletOperationBatch(walletProvider,operationFactory){this.walletProvider=walletProvider,this.operationFactory=operationFactory,this.operations=[]}return WalletOperationBatch.prototype.withTransfer=function(params){return this.operations.push(taquito_es5_assign({kind:OpKind.TRANSACTION},params)),this},WalletOperationBatch.prototype.withContractCall=function(params){return this.withTransfer(params.toTransferParams())},WalletOperationBatch.prototype.withDelegation=function(params){return this.operations.push(taquito_es5_assign({kind:OpKind.DELEGATION},params)),this},WalletOperationBatch.prototype.withOrigination=function(params){return this.operations.push(taquito_es5_assign({kind:OpKind.ORIGINATION},params)),this},WalletOperationBatch.prototype.mapOperation=function(param){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){switch(param.kind){case OpKind.TRANSACTION:return[2,this.walletProvider.mapTransferParamsToWalletParams(taquito_es5_assign({},param))];case OpKind.ORIGINATION:return[2,this.walletProvider.mapOriginateParamsToWalletParams(taquito_es5_assign({},param))];case OpKind.DELEGATION:return[2,this.walletProvider.mapDelegateParamsToWalletParams(taquito_es5_assign({},param))];default:throw new Error("Unsupported operation kind: "+param.kind)}}))}))},WalletOperationBatch.prototype.with=function(params){var e_1,_a;try{for(var params_1=taquito_es5_values(params),params_1_1=params_1.next();!params_1_1.done;params_1_1=params_1.next()){var param=params_1_1.value;switch(param.kind){case OpKind.TRANSACTION:this.withTransfer(param);break;case OpKind.ORIGINATION:this.withOrigination(param);break;case OpKind.DELEGATION:this.withDelegation(param);break;default:throw new Error("Unsupported operation kind: "+param.kind)}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{params_1_1&&!params_1_1.done&&(_a=params_1.return)&&_a.call(params_1)}finally{if(e_1)throw e_1.error}}return this},WalletOperationBatch.prototype.send=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){var ops,_a,_b,op,_c,_d,e_2_1,opHash,e_2,_e;return taquito_es5_generator(this,(function(_f){switch(_f.label){case 0:ops=[],_f.label=1;case 1:_f.trys.push([1,6,7,8]),_a=taquito_es5_values(this.operations),_b=_a.next(),_f.label=2;case 2:return _b.done?[3,5]:(op=_b.value,_d=(_c=ops).push,[4,this.mapOperation(op)]);case 3:_d.apply(_c,[_f.sent()]),_f.label=4;case 4:return _b=_a.next(),[3,2];case 5:return[3,8];case 6:return e_2_1=_f.sent(),e_2={error:e_2_1},[3,8];case 7:try{_b&&!_b.done&&(_e=_a.return)&&_e.call(_a)}finally{if(e_2)throw e_2.error}return[7];case 8:return[4,this.walletProvider.sendOperations(ops)];case 9:return opHash=_f.sent(),[2,this.operationFactory.createOperation(opHash)]}}))}))},WalletOperationBatch}(),Wallet=function(){function Wallet(context){this.context=context,this.walletCommand=function(send){return{send:send}}}return Object.defineProperty(Wallet.prototype,"walletProvider",{get:function(){return this.context.walletProvider},enumerable:!1,configurable:!0}),Wallet.prototype.pkh=function(_a){var forceRefetch=(void 0===_a?{}:_a).forceRefetch;return taquito_es5_awaiter(this,void 0,void 0,(function(){var _b;return taquito_es5_generator(this,(function(_c){switch(_c.label){case 0:return this._pkh&&!forceRefetch?[3,2]:(_b=this,[4,this.walletProvider.getPKH()]);case 1:_b._pkh=_c.sent(),_c.label=2;case 2:return[2,this._pkh]}}))}))},Wallet.prototype.originate=function(params){var _this=this;return this.walletCommand((function(){return taquito_es5_awaiter(_this,void 0,void 0,(function(){var mappedParams,opHash;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.walletProvider.mapOriginateParamsToWalletParams(taquito_es5_assign({},params))];case 1:return mappedParams=_a.sent(),[4,this.walletProvider.sendOperations([mappedParams])];case 2:return opHash=_a.sent(),[2,this.context.operationFactory.createOriginationOperation(opHash)]}}))}))}))},Wallet.prototype.setDelegate=function(params){var _this=this;return this.walletCommand((function(){return taquito_es5_awaiter(_this,void 0,void 0,(function(){var mappedParams,opHash;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.walletProvider.mapDelegateParamsToWalletParams(taquito_es5_assign({},params))];case 1:return mappedParams=_a.sent(),[4,this.walletProvider.sendOperations([mappedParams])];case 2:return opHash=_a.sent(),[2,this.context.operationFactory.createDelegationOperation(opHash)]}}))}))}))},Wallet.prototype.registerDelegate=function(){var _this=this;return this.walletCommand((function(){return taquito_es5_awaiter(_this,void 0,void 0,(function(){var mappedParams,_a,_b,_c,opHash;return taquito_es5_generator(this,(function(_d){switch(_d.label){case 0:return _b=(_a=this.walletProvider).mapDelegateParamsToWalletParams,_c={},[4,this.pkh()];case 1:return[4,_b.apply(_a,[(_c.delegate=_d.sent(),_c)])];case 2:return mappedParams=_d.sent(),[4,this.walletProvider.sendOperations([mappedParams])];case 3:return opHash=_d.sent(),[2,this.context.operationFactory.createDelegationOperation(opHash)]}}))}))}))},Wallet.prototype.transfer=function(params){var _this=this;return this.walletCommand((function(){return taquito_es5_awaiter(_this,void 0,void 0,(function(){var mappedParams,opHash;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.walletProvider.mapTransferParamsToWalletParams(params)];case 1:return mappedParams=_a.sent(),[4,this.walletProvider.sendOperations([mappedParams])];case 2:return opHash=_a.sent(),[2,this.context.operationFactory.createTransactionOperation(opHash)]}}))}))}))},Wallet.prototype.batch=function(params){var batch=new taquito_es5_WalletOperationBatch(this.walletProvider,this.context.operationFactory);return batch.with(params),batch},Wallet.prototype.at=function(address){return taquito_es5_awaiter(this,void 0,void 0,(function(){var script,entrypoints;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.context.rpc.getScript(address)];case 1:return script=_a.sent(),[4,this.context.rpc.getEntrypoints(address)];case 2:return entrypoints=_a.sent(),[2,new taquito_es5_ContractAbstraction(address,script,this,this.context.contract,entrypoints)]}}))}))},Wallet}(),taquito_es5_LegacyWalletProvider=function(){function LegacyWalletProvider(context){this.context=context}return LegacyWalletProvider.prototype.getPKH=function(){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){return[2,this.context.signer.publicKeyHash()]}))}))},LegacyWalletProvider.prototype.mapTransferParamsToWalletParams=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){return[2,attachKind(params,OpKind.TRANSACTION)]}))}))},LegacyWalletProvider.prototype.mapOriginateParamsToWalletParams=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){return[2,attachKind(params,OpKind.ORIGINATION)]}))}))},LegacyWalletProvider.prototype.mapDelegateParamsToWalletParams=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){return[2,attachKind(params,OpKind.DELEGATION)]}))}))},LegacyWalletProvider.prototype.sendOperations=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.context.batch.batch(params).send()];case 1:return[2,_a.sent().hash]}}))}))},LegacyWalletProvider}(),ContractMethod=function(){function ContractMethod(provider,address,parameterSchema,name,args,isMultipleEntrypoint,isAnonymous){void 0===isMultipleEntrypoint&&(isMultipleEntrypoint=!0),void 0===isAnonymous&&(isAnonymous=!1),this.provider=provider,this.address=address,this.parameterSchema=parameterSchema,this.name=name,this.args=args,this.isMultipleEntrypoint=isMultipleEntrypoint,this.isAnonymous=isAnonymous}return Object.defineProperty(ContractMethod.prototype,"schema",{get:function(){return this.isAnonymous?this.parameterSchema.ExtractSchema()[this.name]:this.parameterSchema.ExtractSchema()},enumerable:!1,configurable:!0}),ContractMethod.prototype.send=function(params){return void 0===params&&(params={}),this.provider instanceof Wallet?this.provider.transfer(this.toTransferParams(params)).send():this.provider.transfer(this.toTransferParams(params))},ContractMethod.prototype.toTransferParams=function(_a){var _b,_c,_d=void 0===_a?{}:_a,fee=_d.fee,gasLimit=_d.gasLimit,storageLimit=_d.storageLimit,source=_d.source,_e=_d.amount,amount=void 0===_e?0:_e,_f=_d.mutez,mutez=void 0!==_f&&_f;return{to:this.address,amount:amount,fee:fee,mutez:mutez,source:source,gasLimit:gasLimit,storageLimit:storageLimit,parameter:{entrypoint:this.isMultipleEntrypoint?this.name:"default",value:this.isAnonymous?(_b=this.parameterSchema).Encode.apply(_b,taquito_es5_spread([this.name],this.args)):(_c=this.parameterSchema).Encode.apply(_c,taquito_es5_spread(this.args))}}},ContractMethod}(),validateArgs=function(args,schema,name){var sigs=schema.ExtractSignatures();if(!sigs.find((function(x){return x.length===args.length})))throw new InvalidParameterError(name,sigs,args)},taquito_es5_ContractAbstraction=function(){function ContractAbstraction(address,script,provider,storageProvider,entrypoints){this.address=address,this.script=script,this.storageProvider=storageProvider,this.entrypoints=entrypoints,this.methods={},this.schema=Schema.fromRPCResponse({script:this.script}),this.parameterSchema=ParameterSchema.fromRPCResponse({script:this.script}),this._initializeMethods(address,provider,this.entrypoints.entrypoints)}return ContractAbstraction.prototype._initializeMethods=function(address,provider,entrypoints){var _this=this,parameterSchema=this.parameterSchema,keys=Object.keys(entrypoints);if(parameterSchema.isMultipleEntryPoint){keys.forEach((function(smartContractMethodName){_this.methods[smartContractMethodName]=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var smartContractMethodSchema=new ParameterSchema(entrypoints[smartContractMethodName]);return validateArgs(args,smartContractMethodSchema,smartContractMethodName),new ContractMethod(provider,address,smartContractMethodSchema,smartContractMethodName,args)}})),Object.keys(parameterSchema.ExtractSchema()).filter((function(key){return-1===Object.keys(entrypoints).indexOf(key)})).forEach((function(smartContractMethodName){_this.methods[smartContractMethodName]=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return validateArgs(taquito_es5_spread([smartContractMethodName],args),parameterSchema,smartContractMethodName),new ContractMethod(provider,address,parameterSchema,smartContractMethodName,args,!1,!0)}}))}else{var smartContractMethodSchema_1=this.parameterSchema;this.methods.main=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return validateArgs(args,parameterSchema,"main"),new ContractMethod(provider,address,smartContractMethodSchema_1,"main",args,!1)}}},ContractAbstraction.prototype.storage=function(){return this.storageProvider.getStorage(this.address,this.schema)},ContractAbstraction.prototype.bigMap=function(key){return this.storageProvider.getBigMapKey(this.address,key,this.schema)},ContractAbstraction}(),taquito_es5_BigMapAbstraction=function(){function BigMapAbstraction(id,schema,provider){this.id=id,this.schema=schema,this.provider=provider}return BigMapAbstraction.prototype.get=function(keyToEncode){return taquito_es5_awaiter(this,void 0,void 0,(function(){var e_1;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,this.provider.getBigMapKeyByID(this.id.toString(),keyToEncode,this.schema)];case 1:return[2,_a.sent()];case 2:if((e_1=_a.sent())instanceof taquito_http_utils_es5.b&&e_1.status===taquito_http_utils_es5.c.NOT_FOUND)return[2,void 0];throw e_1;case 3:return[2]}}))}))},BigMapAbstraction.prototype.toJSON=function(){return this.id.toString()},BigMapAbstraction.prototype.toString=function(){return this.id.toString()},BigMapAbstraction}(),smartContractAbstractionSemantic=function(provider){return{big_map:function(val,code){if(val&&"int"in val&&void 0!==val.int){var schema=new Schema(code);return new taquito_es5_BigMapAbstraction(new bignumber_js_bignumber_default.a(val.int),schema,provider)}return{}}}},taquito_es5_RpcContractProvider=function(_super){function RpcContractProvider(context,estimator){var _this=_super.call(this,context)||this;return _this.estimator=estimator,_this}return taquito_es5_extends(RpcContractProvider,_super),RpcContractProvider.prototype.getStorage=function(contract,schema){return taquito_es5_awaiter(this,void 0,void 0,(function(){var contractSchema,storage;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return schema?[3,2]:[4,this.rpc.getScript(contract)];case 1:schema=_a.sent(),_a.label=2;case 2:return contractSchema=Schema.isSchema(schema)?schema:Schema.fromRPCResponse({script:schema}),[4,this.rpc.getStorage(contract)];case 3:return storage=_a.sent(),[2,contractSchema.Execute(storage,smartContractAbstractionSemantic(this))]}}))}))},RpcContractProvider.prototype.getBigMapKey=function(contract,key,schema){return taquito_es5_awaiter(this,void 0,void 0,(function(){var contractSchema,encodedKey,val;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return schema?[3,2]:[4,this.rpc.getScript(contract)];case 1:schema=_a.sent(),_a.label=2;case 2:return contractSchema=Schema.isSchema(schema)?schema:Schema.fromRPCResponse({script:schema}),encodedKey=contractSchema.EncodeBigMapKey(key),[4,this.rpc.getBigMapKey(contract,encodedKey)];case 3:return val=_a.sent(),[2,contractSchema.ExecuteOnBigMapValue(val)]}}))}))},RpcContractProvider.prototype.getBigMapKeyByID=function(id,keyToEncode,schema){return taquito_es5_awaiter(this,void 0,void 0,(function(){var _a,key,type,packed,encodedExpr,bigMapValue;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return _a=schema.EncodeBigMapKey(keyToEncode),key=_a.key,type=_a.type,[4,this.context.rpc.packData({data:key,type:type})];case 1:return packed=_b.sent().packed,encodedExpr=function encodeExpr(value){return b58cencode(blake.blake2b(hex2buf(value),null,32),taquito_utils_es5_prefix.expr)}(packed),[4,this.context.rpc.getBigMapExpr(id.toString(),encodedExpr)];case 2:return bigMapValue=_b.sent(),[2,schema.ExecuteOnBigMapValue(bigMapValue,smartContractAbstractionSemantic(this))]}}))}))},RpcContractProvider.prototype.originate=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){var estimate,publicKeyHash,operation,preparedOrigination,forgedOrigination,_a,hash,context,forgedBytes,opResponse;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return[4,this.estimate(params,this.estimator.originate.bind(this.estimator))];case 1:return estimate=_b.sent(),[4,this.signer.publicKeyHash()];case 2:return publicKeyHash=_b.sent(),[4,createOriginationOperation(taquito_es5_assign(taquito_es5_assign({},params),estimate))];case 3:return operation=_b.sent(),[4,this.prepareOperation({operation:operation,source:publicKeyHash})];case 4:return preparedOrigination=_b.sent(),[4,this.forge(preparedOrigination)];case 5:return forgedOrigination=_b.sent(),[4,this.signAndInject(forgedOrigination)];case 6:return _a=_b.sent(),hash=_a.hash,context=_a.context,forgedBytes=_a.forgedBytes,opResponse=_a.opResponse,[2,new OriginationOperation(hash,operation,forgedBytes,opResponse,context,this)]}}))}))},RpcContractProvider.prototype.setDelegate=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){var estimate,operation,sourceOrDefault,_a,opBytes,_b,hash,context,forgedBytes,opResponse;return taquito_es5_generator(this,(function(_c){switch(_c.label){case 0:if(/kt1/i.test(params.source))throw new InvalidDelegationSource(params.source);return[4,this.estimate(params,this.estimator.setDelegate.bind(this.estimator))];case 1:return estimate=_c.sent(),[4,createSetDelegateOperation(taquito_es5_assign(taquito_es5_assign({},params),estimate))];case 2:return operation=_c.sent(),(_a=params.source)?[3,4]:[4,this.signer.publicKeyHash()];case 3:_a=_c.sent(),_c.label=4;case 4:return sourceOrDefault=_a,[4,this.prepareAndForge({operation:operation,source:sourceOrDefault})];case 5:return opBytes=_c.sent(),[4,this.signAndInject(opBytes)];case 6:return _b=_c.sent(),hash=_b.hash,context=_b.context,forgedBytes=_b.forgedBytes,opResponse=_b.opResponse,[2,new DelegateOperation(hash,operation,sourceOrDefault,forgedBytes,opResponse,context)]}}))}))},RpcContractProvider.prototype.registerDelegate=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){var estimate,source,operation,opBytes,_a,hash,context,forgedBytes,opResponse;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return[4,this.estimate(params,this.estimator.registerDelegate.bind(this.estimator))];case 1:return estimate=_b.sent(),[4,this.signer.publicKeyHash()];case 2:return source=_b.sent(),[4,createRegisterDelegateOperation(taquito_es5_assign(taquito_es5_assign({},params),estimate),source)];case 3:return operation=_b.sent(),[4,this.prepareAndForge({operation:operation})];case 4:return opBytes=_b.sent(),[4,this.signAndInject(opBytes)];case 5:return _a=_b.sent(),hash=_a.hash,context=_a.context,forgedBytes=_a.forgedBytes,opResponse=_a.opResponse,[2,new DelegateOperation(hash,operation,source,forgedBytes,opResponse,context)]}}))}))},RpcContractProvider.prototype.transfer=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){var estimate,operation,source,_a,opBytes,_b,hash,context,forgedBytes,opResponse;return taquito_es5_generator(this,(function(_c){switch(_c.label){case 0:return[4,this.estimate(params,this.estimator.transfer.bind(this.estimator))];case 1:return estimate=_c.sent(),[4,createTransferOperation(taquito_es5_assign(taquito_es5_assign({},params),estimate))];case 2:return operation=_c.sent(),(_a=params.source)?[3,4]:[4,this.signer.publicKeyHash()];case 3:_a=_c.sent(),_c.label=4;case 4:return source=_a,[4,this.prepareAndForge({operation:operation,source:params.source})];case 5:return opBytes=_c.sent(),[4,this.signAndInject(opBytes)];case 6:return _b=_c.sent(),hash=_b.hash,context=_b.context,forgedBytes=_b.forgedBytes,opResponse=_b.opResponse,[2,new taquito_es5_TransactionOperation(hash,operation,source,forgedBytes,opResponse,context)]}}))}))},RpcContractProvider.prototype.at=function(address){return taquito_es5_awaiter(this,void 0,void 0,(function(){var script,entrypoints;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return[4,this.rpc.getScript(address)];case 1:return script=_a.sent(),[4,this.rpc.getEntrypoints(address)];case 2:return entrypoints=_a.sent(),[2,new taquito_es5_ContractAbstraction(address,script,this,this,entrypoints)]}}))}))},RpcContractProvider}(taquito_es5_OperationEmitter),BatchOperation=function(_super){function BatchOperation(hash,params,source,raw,results,context){var _this=_super.call(this,hash,raw,results,context)||this;return _this.params=params,_this.source=source,_this}return taquito_es5_extends(BatchOperation,_super),BatchOperation.prototype.sumProp=function(arr,prop){return arr.reduce((function(prev,current){return prop in current?Number(current[prop])+prev:prev}),0)},Object.defineProperty(BatchOperation.prototype,"status",{get:function(){return this.results.filter((function(result){return-1!==BATCH_KINDS.indexOf(result.kind)})).map((function(result){return hasMetadataWithResult(result)?result.metadata.operation_result.status:"unknown"}))[0]||"unknown"},enumerable:!1,configurable:!0}),Object.defineProperty(BatchOperation.prototype,"fee",{get:function(){return this.sumProp(this.params,"fee")},enumerable:!1,configurable:!0}),Object.defineProperty(BatchOperation.prototype,"gasLimit",{get:function(){return this.sumProp(this.params,"gas_limit")},enumerable:!1,configurable:!0}),Object.defineProperty(BatchOperation.prototype,"storageLimit",{get:function(){return this.sumProp(this.params,"storage_limit")},enumerable:!1,configurable:!0}),Object.defineProperty(BatchOperation.prototype,"consumedGas",{get:function(){return String(this.sumProp(flattenOperationResult({contents:this.results}),"consumed_gas"))},enumerable:!1,configurable:!0}),Object.defineProperty(BatchOperation.prototype,"storageDiff",{get:function(){return String(this.sumProp(flattenOperationResult({contents:this.results}),"paid_storage_size_diff"))},enumerable:!1,configurable:!0}),Object.defineProperty(BatchOperation.prototype,"errors",{get:function(){return flattenErrors({contents:this.results})},enumerable:!1,configurable:!0}),BatchOperation}(taquito_es5_Operation),BATCH_KINDS=[OpKind.ACTIVATION,OpKind.ORIGINATION,OpKind.TRANSACTION,OpKind.DELEGATION],taquito_es5_OperationBatch=function(_super){function OperationBatch(context,estimator){var _this=_super.call(this,context)||this;return _this.estimator=estimator,_this.operations=[],_this}return taquito_es5_extends(OperationBatch,_super),OperationBatch.prototype.withTransfer=function(params){return this.operations.push(taquito_es5_assign({kind:OpKind.TRANSACTION},params)),this},OperationBatch.prototype.withContractCall=function(params){return this.withTransfer(params.toTransferParams())},OperationBatch.prototype.withDelegation=function(params){return this.operations.push(taquito_es5_assign({kind:OpKind.DELEGATION},params)),this},OperationBatch.prototype.withActivation=function(_a){var pkh=_a.pkh,secret=_a.secret;return this.operations.push({kind:OpKind.ACTIVATION,pkh:pkh,secret:secret}),this},OperationBatch.prototype.withOrigination=function(params){return this.operations.push(taquito_es5_assign({kind:OpKind.ORIGINATION},params)),this},OperationBatch.prototype.getRPCOp=function(param){return taquito_es5_awaiter(this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){switch(param.kind){case OpKind.TRANSACTION:return[2,createTransferOperation(taquito_es5_assign({},param))];case OpKind.ORIGINATION:return[2,createOriginationOperation(taquito_es5_assign({},param))];case OpKind.DELEGATION:return[2,createSetDelegateOperation(taquito_es5_assign({},param))];case OpKind.ACTIVATION:return[2,taquito_es5_assign({},param)];default:throw new Error("Unsupported operation kind: "+param.kind)}}))}))},OperationBatch.prototype.with=function(params){var e_1,_a;try{for(var params_1=taquito_es5_values(params),params_1_1=params_1.next();!params_1_1.done;params_1_1=params_1.next()){var param=params_1_1.value;switch(param.kind){case OpKind.TRANSACTION:this.withTransfer(param);break;case OpKind.ORIGINATION:this.withOrigination(param);break;case OpKind.DELEGATION:this.withDelegation(param);break;case OpKind.ACTIVATION:this.withActivation(param);break;default:throw new Error("Unsupported operation kind: "+param.kind)}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{params_1_1&&!params_1_1.done&&(_a=params_1.return)&&_a.call(params_1)}finally{if(e_1)throw e_1.error}}return this},OperationBatch.prototype.send=function(params){return taquito_es5_awaiter(this,void 0,void 0,(function(){var estimates,ops,i,_a,_b,op,estimated,_c,_d,e_2_1,source,_e,opBytes,_f,hash,context,forgedBytes,opResponse,e_2,_g,_this=this;return taquito_es5_generator(this,(function(_h){switch(_h.label){case 0:return[4,this.estimator.batch(this.operations)];case 1:estimates=_h.sent(),ops=[],i=0,_h.label=2;case 2:_h.trys.push([2,10,11,12]),_a=taquito_es5_values(this.operations),_b=_a.next(),_h.label=3;case 3:return _b.done?[3,9]:(op=_b.value,isOpWithFee(op)?[4,this.estimate(op,(function(){return taquito_es5_awaiter(_this,void 0,void 0,(function(){return taquito_es5_generator(this,(function(_a){return[2,estimates[i]]}))}))}))]:[3,6]);case 4:return estimated=_h.sent(),_d=(_c=ops).push,[4,this.getRPCOp(taquito_es5_assign(taquito_es5_assign({},op),estimated))];case 5:return _d.apply(_c,[_h.sent()]),[3,7];case 6:ops.push(taquito_es5_assign({},op)),_h.label=7;case 7:i++,_h.label=8;case 8:return _b=_a.next(),[3,3];case 9:return[3,12];case 10:return e_2_1=_h.sent(),e_2={error:e_2_1},[3,12];case 11:try{_b&&!_b.done&&(_g=_a.return)&&_g.call(_a)}finally{if(e_2)throw e_2.error}return[7];case 12:return(_e=params&&params.source)?[3,14]:[4,this.signer.publicKeyHash()];case 13:_e=_h.sent(),_h.label=14;case 14:return source=_e,[4,this.prepareAndForge({operation:ops,source:source})];case 15:return opBytes=_h.sent(),[4,this.signAndInject(opBytes)];case 16:return _f=_h.sent(),hash=_f.hash,context=_f.context,forgedBytes=_f.forgedBytes,opResponse=_f.opResponse,[2,new BatchOperation(hash,ops,source,forgedBytes,opResponse,context)]}}))}))},OperationBatch}(taquito_es5_OperationEmitter),RPCBatchProvider=function(){function RPCBatchProvider(context,estimator){this.context=context,this.estimator=estimator}return RPCBatchProvider.prototype.batch=function(params){var batch=new taquito_es5_OperationBatch(this.context,this.estimator);return Array.isArray(params)&&batch.with(params),batch},RPCBatchProvider}(),defaultConfig={confirmationPollingIntervalSecond:10,defaultConfirmationCount:1,confirmationPollingTimeoutSecond:180},taquito_es5_Context=function(){function Context(_rpcClient,_signer,_proto,_config,forger,injector,wallet){void 0===_rpcClient&&(_rpcClient=new taquito_rpc_es5_RpcClient),void 0===_signer&&(_signer=new NoopSigner),this._rpcClient=_rpcClient,this._signer=_signer,this._proto=_proto,this._config=_config,this.tz=new taquito_es5_RpcTzProvider(this),this.estimate=new taquito_es5_RPCEstimateProvider(this),this.contract=new taquito_es5_RpcContractProvider(this,this.estimate),this.batch=new RPCBatchProvider(this,this.estimate),this.wallet=new Wallet(this),this.config=_config,this._forger=forger||new RpcForger(this),this._injector=injector||new RpcInjector(this),this.operationFactory=new taquito_es5_OperationFactory(this),this._walletProvider=wallet||new taquito_es5_LegacyWalletProvider(this)}return Object.defineProperty(Context.prototype,"config",{get:function(){return this._config},set:function(value){this._config=taquito_es5_assign(taquito_es5_assign({},defaultConfig),value)},enumerable:!1,configurable:!0}),Object.defineProperty(Context.prototype,"rpc",{get:function(){return this._rpcClient},set:function(value){this._rpcClient=value},enumerable:!1,configurable:!0}),Object.defineProperty(Context.prototype,"injector",{get:function(){return this._injector},set:function(value){this._injector=value},enumerable:!1,configurable:!0}),Object.defineProperty(Context.prototype,"forger",{get:function(){return this._forger},set:function(value){this._forger=value},enumerable:!1,configurable:!0}),Object.defineProperty(Context.prototype,"signer",{get:function(){return this._signer},set:function(value){this._signer=value},enumerable:!1,configurable:!0}),Object.defineProperty(Context.prototype,"walletProvider",{get:function(){return this._walletProvider},set:function(value){this._walletProvider=value},enumerable:!1,configurable:!0}),Object.defineProperty(Context.prototype,"proto",{get:function(){return this._proto},set:function(value){this._proto=value},enumerable:!1,configurable:!0}),Context.prototype.isAnyProtocolActive=function(protocol){return void 0===protocol&&(protocol=[]),taquito_es5_awaiter(this,void 0,void 0,(function(){var next_protocol;return taquito_es5_generator(this,(function(_a){switch(_a.label){case 0:return this._proto?[2,protocol.includes(this._proto)]:[3,1];case 1:return[4,this.rpc.getBlockMetadata()];case 2:return next_protocol=_a.sent().next_protocol,[2,protocol.includes(next_protocol)]}}))}))},Context.prototype.clone=function(){return new Context(this.rpc,this.signer,this.proto,this.config,this.forger,this._injector)},Context}(),evaluateOpFilter=function(op,filter){return"opHash"in filter?function(op,filter){return op.hash===filter.opHash}(op,filter):"source"in filter?function(x,filter){switch(x.kind){case"endorsement":return"metadata"in x&&x.metadata.delegate===filter.source;case"activate_account":return"metadata"in x&&x.pkh===filter.source;default:return"source"in x&&x.source===filter.source}}(op,filter):"kind"in filter?function(x,filter){return"kind"in x&&x.kind===filter.kind}(op,filter):"destination"in filter&&function(x,filter){switch(x.kind){case"delegation":return x.delegate===filter.destination;case"origination":if("metadata"in x&&"operation_result"in x.metadata&&"originated_contracts"in x.metadata.operation_result&&Array.isArray(x.metadata.operation_result.originated_contracts))return x.metadata.operation_result.originated_contracts.some((function(contract){return contract===filter.destination}));break;case"transaction":return x.destination===filter.destination;default:return!1}}(op,filter)},evaluateFilter=function(op,filter){var filters=[];return Array.isArray(filter)?filters.push.apply(filters,taquito_es5_spread(filter)):filters.push(filter),filters.every((function(filterOrExp){return"and"in filterOrExp||"or"in filterOrExp?function(op,exp){if(Array.isArray(exp.and))return exp.and.every((function(x){return evaluateFilter(op,x)}));if(Array.isArray(exp.or))return exp.or.some((function(x){return evaluateFilter(op,x)}));throw new Error("Filter expression must contains either and/or property")}(op,filterOrExp):evaluateOpFilter(op,filterOrExp)}))},taquito_es5_ObservableSubscription=function(){function ObservableSubscription(obs){var _this=this;this.errorListeners=[],this.messageListeners=[],this.closeListeners=[],this.completed$=new Subject.a,obs.pipe(Object(takeUntil.a)(this.completed$)).subscribe((function(data){_this.call(_this.messageListeners,data)}),(function(error){_this.call(_this.errorListeners,error)}),(function(){_this.call(_this.closeListeners)}))}return ObservableSubscription.prototype.call=function(listeners,value){var e_1,_a;try{for(var listeners_1=taquito_es5_values(listeners),listeners_1_1=listeners_1.next();!listeners_1_1.done;listeners_1_1=listeners_1.next()){var l=listeners_1_1.value;try{l(value)}catch(ex){console.error(ex)}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{listeners_1_1&&!listeners_1_1.done&&(_a=listeners_1.return)&&_a.call(listeners_1)}finally{if(e_1)throw e_1.error}}},ObservableSubscription.prototype.remove=function(listeners,value){var idx=listeners.indexOf(value);-1!==idx&&listeners.splice(idx,1)},ObservableSubscription.prototype.on=function(type,cb){switch(type){case"data":this.messageListeners.push(cb);break;case"error":this.errorListeners.push(cb);break;case"close":this.closeListeners.push(cb);break;default:throw new Error("Trying to register on an unsupported event: "+type)}},ObservableSubscription.prototype.off=function(type,cb){switch(type){case"data":this.remove(this.messageListeners,cb);break;case"error":this.remove(this.errorListeners,cb);break;case"close":this.remove(this.closeListeners,cb);break;default:throw new Error("Trying to unregister on an unsupported event: "+type)}},ObservableSubscription.prototype.close=function(){this.completed$.next()},ObservableSubscription}(),getLastBlock=function(context){return Object(observable_from.a)(context.rpc.getBlock()).pipe(Object(first.a)())},taquito_es5_PollingSubscribeProvider=function(){function PollingSubscribeProvider(context,POLL_INTERVAL){var _this=this;void 0===POLL_INTERVAL&&(POLL_INTERVAL=2e4),this.context=context,this.POLL_INTERVAL=POLL_INTERVAL,this.newBlock$=Object(timer.a)(0,this.POLL_INTERVAL).pipe(Object(map.a)((function(){return _this.context})),Object(switchMap.a)(getLastBlock),Object(distinctUntilKeyChanged.a)("hash"),Object(publishReplay.a)(),Object(refCount.a)())}return PollingSubscribeProvider.prototype.subscribe=function(_filter){return new taquito_es5_ObservableSubscription(this.newBlock$.pipe(Object(pluck.a)("hash")))},PollingSubscribeProvider.prototype.subscribeOperation=function(filter){return new taquito_es5_ObservableSubscription(this.newBlock$.pipe(function(filter){return Object(concatMap.a)((function(block){return new Observable.a((function(sub){var e_1,_a,e_2,_b,e_3,_c;try{for(var _d=taquito_es5_values(block.operations),_e=_d.next();!_e.done;_e=_d.next()){var ops=_e.value;try{for(var ops_1=(e_2=void 0,taquito_es5_values(ops)),ops_1_1=ops_1.next();!ops_1_1.done;ops_1_1=ops_1.next()){var op=ops_1_1.value;try{for(var _f=(e_3=void 0,taquito_es5_values(op.contents)),_g=_f.next();!_g.done;_g=_f.next()){var content=_g.value;evaluateFilter(taquito_es5_assign({hash:op.hash},content),filter)&&sub.next(taquito_es5_assign({hash:op.hash},content))}}catch(e_3_1){e_3={error:e_3_1}}finally{try{_g&&!_g.done&&(_c=_f.return)&&_c.call(_f)}finally{if(e_3)throw e_3.error}}}}catch(e_2_1){e_2={error:e_2_1}}finally{try{ops_1_1&&!ops_1_1.done&&(_b=ops_1.return)&&_b.call(ops_1)}finally{if(e_2)throw e_2.error}}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_e&&!_e.done&&(_a=_d.return)&&_a.call(_d)}finally{if(e_1)throw e_1.error}}sub.complete()}))}))}(filter)))},PollingSubscribeProvider}(),ForgingMismatchError=function ForgingMismatchError(results){this.results=results,this.name="ForgingMismatchError",this.message="Forging mismatch error"},taquito_es5_TezosToolkit=(function(){function CompositeForger(forgers){if(this.forgers=forgers,0===forgers.length)throw new Error("At least one forger must be specified")}CompositeForger.prototype.forge=function(_a){var branch=_a.branch,contents=_a.contents;return taquito_es5_awaiter(this,void 0,void 0,(function(){var results,lastResult,currentResult;return taquito_es5_generator(this,(function(_b){switch(_b.label){case 0:return[4,Promise.all(this.forgers.map((function(forger){return forger.forge({branch:branch,contents:contents})})))];case 1:if(0===(results=_b.sent()).length)throw new Error("At least one forger must be specified");for(lastResult=results.pop();results.length;){if((currentResult=results.pop())!==lastResult)throw new ForgingMismatchError([lastResult,currentResult]);lastResult=currentResult}return[2,lastResult]}}))}))}}(),function(){function TezosToolkit(){this._rpcClient=new taquito_rpc_es5_RpcClient,this._options={},this._context=new taquito_es5_Context,this._wallet=new Wallet(this._context),this.format=format,this.batch=this._context.batch.batch.bind(this._context.batch),this.setProvider({rpc:this._rpcClient})}return TezosToolkit.prototype.setProvider=function(_a){var rpc=_a.rpc,stream=_a.stream,signer=_a.signer,protocol=_a.protocol,config=_a.config,forger=_a.forger,wallet=_a.wallet;this.setRpcProvider(rpc),this.setStreamProvider(stream),this.setSignerProvider(signer),this.setForgerProvider(forger),this.setWalletProvider(wallet),this._context.proto=protocol,this._context.config=config},TezosToolkit.prototype.setSignerProvider=function(signer){this._options.signer||void 0!==signer?void 0!==signer&&(this._context.signer=signer,this._options.signer=signer):(this._context.signer=new NoopSigner,this._options.signer=signer)},TezosToolkit.prototype.setRpcProvider=function(rpc){"string"==typeof rpc?this._rpcClient=new taquito_rpc_es5_RpcClient(rpc):rpc instanceof taquito_rpc_es5_RpcClient?this._rpcClient=rpc:void 0===this._options.rpc&&(this._rpcClient=new taquito_rpc_es5_RpcClient),this._options.rpc=this._rpcClient,this._context.rpc=this._rpcClient},TezosToolkit.prototype.setForgerProvider=function(forger){var f=void 0===forger?this.getFactory(RpcForger)():forger;this._options.forger=f,this._context.forger=f},TezosToolkit.prototype.setStreamProvider=function(stream){"string"==typeof stream?this._stream=new taquito_es5_PollingSubscribeProvider(new taquito_es5_Context(new taquito_rpc_es5_RpcClient(stream))):void 0!==stream?this._stream=stream:void 0===this._options.stream&&(this._stream=this.getFactory(taquito_es5_PollingSubscribeProvider)()),this._options.stream=stream},TezosToolkit.prototype.setWalletProvider=function(wallet){if(this._options.wallet||void 0!==wallet)void 0!==wallet&&(this._options.wallet=wallet,this._context.walletProvider=wallet);else{var w=this.getFactory(taquito_es5_LegacyWalletProvider)();this._options.wallet=w,this._context.walletProvider=w}},Object.defineProperty(TezosToolkit.prototype,"tz",{get:function(){return this._context.tz},enumerable:!1,configurable:!0}),Object.defineProperty(TezosToolkit.prototype,"contract",{get:function(){return this._context.contract},enumerable:!1,configurable:!0}),Object.defineProperty(TezosToolkit.prototype,"wallet",{get:function(){return this._wallet},enumerable:!1,configurable:!0}),Object.defineProperty(TezosToolkit.prototype,"operation",{get:function(){return this._context.operationFactory},enumerable:!1,configurable:!0}),Object.defineProperty(TezosToolkit.prototype,"estimate",{get:function(){return this._context.estimate},enumerable:!1,configurable:!0}),Object.defineProperty(TezosToolkit.prototype,"stream",{get:function(){return this._stream},enumerable:!1,configurable:!0}),Object.defineProperty(TezosToolkit.prototype,"rpc",{get:function(){return this._context.rpc},enumerable:!1,configurable:!0}),Object.defineProperty(TezosToolkit.prototype,"signer",{get:function(){return this._context.signer},enumerable:!1,configurable:!0}),TezosToolkit.prototype.importKey=function(privateKeyOrEmail,passphrase,mnemonic,secret){return function importKey(toolkit,privateKeyOrEmail,passphrase,mnemonic,secret){return taquito_signer_es5_awaiter(this,void 0,void 0,(function(){var pkh,op,ex_1,signer;return taquito_signer_es5_generator(this,(function(_a){switch(_a.label){case 0:return privateKeyOrEmail&&passphrase&&mnemonic&&secret?(signer=taquito_signer_es5_InMemorySigner.fromFundraiser(privateKeyOrEmail,passphrase,mnemonic),toolkit.setProvider({signer:signer}),[4,signer.publicKeyHash()]):[3,8];case 1:pkh=_a.sent(),op=void 0,_a.label=2;case 2:return _a.trys.push([2,4,,5]),[4,toolkit.tz.activate(pkh,secret)];case 3:return op=_a.sent(),[3,5];case 4:if(ex_1=_a.sent(),!(ex_1&&ex_1.body&&/Invalid activation/.test(ex_1.body)))throw ex_1;return[3,5];case 5:return op?[4,op.confirmation()]:[3,7];case 6:_a.sent(),_a.label=7;case 7:return[3,10];case 8:return[4,taquito_signer_es5_InMemorySigner.fromSecretKey(privateKeyOrEmail,passphrase)];case 9:signer=_a.sent(),toolkit.setProvider({signer:signer}),_a.label=10;case 10:return[2]}}))}))}(this,privateKeyOrEmail,passphrase,mnemonic,secret)},TezosToolkit.prototype.getFactory=function(ctor){var _this=this;return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return new(ctor.bind.apply(ctor,taquito_es5_spread([void 0,_this._context],args)))}},TezosToolkit}()),Tezos=new taquito_es5_TezosToolkit},976:function(module,exports,__webpack_require__){var map={"./balance-history.stories.tsx":977,"./index.stories.tsx":1335};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=976},977:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),react__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__),_storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(119),_src_balance_history__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(619),_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(34),_taquito_taquito__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(90),_src_tezos_context__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(65),stories=Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("Balance history component",module);stories.addDecorator(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.withKnobs),stories.add("default",(function(){var tk=function createTK(){var tk=new _taquito_taquito__WEBPACK_IMPORTED_MODULE_4__.b;return tk.setProvider({rpc:"https://api.tez.ie/rpc/mainnet"}),tk}();return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("h2",null,"Balance over time for ",Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.text)("Address","KT1DzGefKWdrwWn9HxcYtKR46todiC66bxsH")),react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_tezos_context__WEBPACK_IMPORTED_MODULE_5__.a.Provider,{value:tk},react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_src_balance_history__WEBPACK_IMPORTED_MODULE_2__.a,{start:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.date)("Start",new Date((new Date).getFullYear(),0,1)),end:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.date)("End",new Date),address:Object(_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_3__.text)("Address","KT1DzGefKWdrwWn9HxcYtKR46todiC66bxsH")})))}))}.call(this,__webpack_require__(295)(module))},983:function(module,exports){},985:function(module,exports){}},[[669,1,2]]]);
//# sourceMappingURL=main.bbde135f7307e766bcc3.bundle.js.map