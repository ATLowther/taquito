/*! For license information please see 1be78505.806078ca.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{164:function(t,r,e){"use strict";e.d(r,"a",(function(){return y})),e.d(r,"b",(function(){return vt})),e.d(r,"c",(function(){return gt}));var n=e(517),i=e.n(n),a=e(518),o=e.n(a),s=e(165),c=function(t,r){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(t,r)};function u(t,r){function e(){this.constructor=t}c(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}var p,l=function(){return(l=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var i in r=arguments[e])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};function h(t,r){var e,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=r.call(t,o)}catch(s){a=[6,s],n=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function f(t){var r="function"==typeof Symbol&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(t,r){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var n,i,a=e.call(t),o=[];try{for(;(void 0===r||r-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(e=a.return)&&e.call(a)}finally{if(i)throw i.error}}return o}function d(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(m(arguments[r]));return t}var g=Symbol.for("taquito-michelson-map-type-symbol"),v=function(t,r,e){this.value=t,this.type=r,this.name="MapTypecheckError",this.message=e+" not compliant with underlying michelson type"},y=function(){function t(t){this.valueMap=new Map,this.keyMap=new Map,this[p]=!0,t&&this.setType(t)}return t.isMichelsonMap=function(t){return t&&!0===t[g]},t.prototype.setType=function(t){if(!("args"in(r=t))||!Array.isArray(r.args)||2!==r.args.length)throw new Error("mapType is not a valid michelson map type");var r;this.keySchema=new gt(t.args[0]),this.valueSchema=new gt(t.args[1])},t.prototype.removeType=function(){this.keySchema=void 0,this.valueSchema=void 0},t.fromLiteral=function(r,e){var n=new t(e);return Object.keys(r).forEach((function(t){n.set(t,r[t])})),n},t.prototype.typecheckKey=function(t){return!this.keySchema||this.keySchema.Typecheck(t)},t.prototype.typecheckValue=function(t){return!this.valueSchema||this.valueSchema.Typecheck(t)},t.prototype.assertTypecheckValue=function(t){if(!this.typecheckValue(t))throw new v(t,this.valueSchema,"value")},t.prototype.assertTypecheckKey=function(t){if(!this.typecheckKey(t))throw new v(t,this.keySchema,"key")},t.prototype.serializeDeterministically=function(t){return i()(t)},t.prototype.keys=function(){var t,r,e,n,i,a;return h(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),t=f(this.entries()),r=t.next(),o.label=1;case 1:return r.done?[3,4]:(e=m(r.value,1),[4,e[0]]);case 2:o.sent(),o.label=3;case 3:return r=t.next(),[3,1];case 4:return[3,7];case 5:return n=o.sent(),i={error:n},[3,7];case 6:try{r&&!r.done&&(a=t.return)&&a.call(t)}finally{if(i)throw i.error}return[7];case 7:return[2]}}))},t.prototype.values=function(){var t,r,e,n,i,a;return h(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),t=f(this.entries()),r=t.next(),o.label=1;case 1:return r.done?[3,4]:(e=m(r.value,2),[4,e[1]]);case 2:o.sent(),o.label=3;case 3:return r=t.next(),[3,1];case 4:return[3,7];case 5:return n=o.sent(),i={error:n},[3,7];case 6:try{r&&!r.done&&(a=t.return)&&a.call(t)}finally{if(i)throw i.error}return[7];case 7:return[2]}}))},t.prototype.entries=function(){var t,r,e,n,i,a;return h(this,(function(o){switch(o.label){case 0:o.trys.push([0,5,6,7]),t=f(this.valueMap.keys()),r=t.next(),o.label=1;case 1:return r.done?[3,4]:(e=r.value,[4,[this.keyMap.get(e),this.valueMap.get(e)]]);case 2:o.sent(),o.label=3;case 3:return r=t.next(),[3,1];case 4:return[3,7];case 5:return n=o.sent(),i={error:n},[3,7];case 6:try{r&&!r.done&&(a=t.return)&&a.call(t)}finally{if(i)throw i.error}return[7];case 7:return[2]}}))},t.prototype.get=function(t){this.assertTypecheckKey(t);var r=this.serializeDeterministically(t);return this.valueMap.get(r)},t.prototype.set=function(t,r){this.assertTypecheckKey(t),this.assertTypecheckValue(r);var e=this.serializeDeterministically(t);this.keyMap.set(e,t),this.valueMap.set(e,r)},t.prototype.delete=function(t){this.assertTypecheckKey(t),this.keyMap.delete(this.serializeDeterministically(t)),this.valueMap.delete(this.serializeDeterministically(t))},t.prototype.has=function(t){this.assertTypecheckKey(t);var r=this.serializeDeterministically(t);return this.keyMap.has(r)&&this.valueMap.has(r)},t.prototype.clear=function(){this.keyMap.clear(),this.valueMap.clear()},Object.defineProperty(t.prototype,"size",{get:function(){return this.keyMap.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){var r,e;try{for(var n=f(this.entries()),i=n.next();!i.done;i=n.next()){var a=m(i.value,2),o=a[0];t(a[1],o,this)}}catch(s){r={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(r)throw r.error}}},t}();p=g;var b=function(t,r,e){this.value=t,this.token=r,this.name="ValidationError";var n=this.token.annot(),i=n?"["+n+"] ":"";this.message=""+i+e},E=function(){function t(t,r,e){this.val=t,this.idx=r,this.fac=e,this.createToken=this.fac}return t.prototype.typeWithoutAnnotations=function(){return function t(r){return r.args?{prim:r.prim,args:r.args.map((function(r){return t(r)}))}:{prim:r.prim}}(this.val)},t.prototype.annot=function(){return(Array.isArray(this.val.annots)&&this.val.annots.length>0?this.val.annots[0]:String(this.idx)).replace(/(%|\:)(_Liq_entry_)?/,"")},t.prototype.hasAnnotations=function(){return Array.isArray(this.val.annots)&&this.val.annots.length},t.prototype.ExtractSignature=function(){return[[this.ExtractSchema()]]},t}(),w=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return u(r,t),r.prototype.compare=function(t,r){return t===r?0:t<r?-1:1},r}(E),O=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="BigMapValidationError",i}return u(r,t),r}(b),A=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),Object.defineProperty(r.prototype,"ValueSchema",{get:function(){return this.createToken(this.val.args[1],0)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"KeySchema",{get:function(){return this.createToken(this.val.args[0],0)},enumerable:!1,configurable:!0}),r.prototype.ExtractSchema=function(){var t;return(t={})[this.KeySchema.ExtractSchema()]=this.ValueSchema.ExtractSchema(),t},r.prototype.isValid=function(t){return y.isMichelsonMap(t)?null:new O(t,this,"Value must be a MichelsonMap")},r.prototype.Encode=function(t){var r=this,e=t.pop(),n=this.isValid(e);if(n)throw n;return Array.from(e.keys()).sort((function(t,e){return r.KeySchema.compare(t,e)})).map((function(t){return{prim:"Elt",args:[r.KeySchema.EncodeObject(t),r.ValueSchema.EncodeObject(e.get(t))]}}))},r.prototype.EncodeObject=function(t){var r=this,e=t,n=this.isValid(e);if(n)throw n;return Array.from(e.keys()).sort((function(t,e){return r.KeySchema.compare(t,e)})).map((function(t){return{prim:"Elt",args:[r.KeySchema.EncodeObject(t),r.ValueSchema.EncodeObject(e.get(t))]}}))},r.prototype.Execute=function(t,e){var n=this;if(e&&e[r.prim])return e[r.prim](t,this.val);if(Array.isArray(t)){var i=new y(this.val);return t.forEach((function(t){i.set(n.KeySchema.ToKey(t.args[0]),n.ValueSchema.Execute(t.args[1]))})),i}if("int"in t)return t.int;throw new Error("Big map is expecting either an array (Athens) or an object with an int property (Babylon). Got "+JSON.stringify(t))},r.prim="big_map",r}(E),P=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Encode=function(t){var e=t[t.length-1],n=this.createToken(this.val.args[0],this.idx),i=1;n instanceof r&&(i=Object.keys(n.ExtractSchema()).length);var a=this.createToken(this.val.args[1],this.idx+i);if(String(n.annot())!==String(e)||n instanceof r){if(String(a.annot())!==String(e)||a instanceof r){var o;if(n instanceof r)if(o=n.Encode(t))return{prim:"Left",args:[o]};if(a instanceof r)if(o=a.Encode(t))return{prim:"Right",args:[o]};return null}return t.pop(),{prim:"Right",args:[a.Encode(t)]}}return t.pop(),{prim:"Left",args:[n.Encode(t)]}},r.prototype.ExtractSignature=function(){var t,e,n,i,a=this.createToken(this.val.args[0],this.idx),o=1;a instanceof r&&(o=Object.keys(a.ExtractSchema()).length);var s=this.createToken(this.val.args[1],this.idx+o),c=[];if(a instanceof r)c.push.apply(c,d(a.ExtractSignature()));else try{for(var u=f(a.ExtractSignature()),p=u.next();!p.done;p=u.next()){var l=p.value;c.push(d([a.annot()],l))}}catch(g){t={error:g}}finally{try{p&&!p.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}if(s instanceof r)c.push.apply(c,d(s.ExtractSignature()));else try{for(var h=f(s.ExtractSignature()),m=h.next();!m.done;m=h.next()){l=m.value;c.push(d([s.annot()],l))}}catch(v){n={error:v}}finally{try{m&&!m.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}return c},r.prototype.EncodeObject=function(t){var e=Object.keys(t)[0],n=this.createToken(this.val.args[0],this.idx),i=1;n instanceof r&&(i=Object.keys(n.ExtractSchema()).length);var a=this.createToken(this.val.args[1],this.idx+i);if(String(n.annot())!==String(e)||n instanceof r){if(String(a.annot())!==String(e)||a instanceof r){var o;if(n instanceof r)if(o=n.EncodeObject(t))return{prim:"Left",args:[o]};if(a instanceof r)if(o=a.EncodeObject(t))return{prim:"Right",args:[o]};return null}return{prim:"Right",args:[a.EncodeObject(t[e])]}}return{prim:"Left",args:[n.EncodeObject(t[e])]}},r.prototype.Execute=function(t,e){var n,i=this.createToken(this.val.args[0],this.idx),a=1;i instanceof r&&(a=Object.keys(i.ExtractSchema()).length);var o=this.createToken(this.val.args[1],this.idx+a);if("Right"===t.prim)return o.Execute(t.args[0],e);if("Left"===t.prim)return(n={})[i.annot()]=i.Execute(t.args[0],e),n;throw new Error("Was expecting Left or Right prim but got: "+t.prim)},r.prototype.traversal=function(t,e,n){var i,a,o,s=this.createToken(this.val.args[0],this.idx),c=1;s instanceof r&&!s.hasAnnotations()?(o=t(s),c=Object.keys(s.ExtractSchema()).length):((i={})[s.annot()]=t(s),o=i);var u,p=this.createToken(this.val.args[1],this.idx+c);return p instanceof r&&!p.hasAnnotations()?u=e(p):((a={})[p.annot()]=e(p),u=a),n(o,u)},r.prototype.ExtractSchema=function(){return this.traversal((function(t){return t.ExtractSchema()}),(function(t){return t.ExtractSchema()}),(function(t,r){return l(l({},t),r)}))},r.prim="or",r}(E);function T(t,r){if(void 0===r&&(r=I.prim),Array.isArray(t))return T({prim:r,args:t},r);if(void 0===t.args)throw new Error("Token has no arguments");return t.args.length>2?[t.args[0],{prim:r,args:t.args.slice(1)}]:[t.args[0],t.args[1]]}var _,I=function(t){function r(e,n,i){return t.call(this,Array.isArray(e)?{prim:r.prim,args:e}:e,n,i)||this}return u(r,t),r.prototype.args=function(){return T(this.val)},r.prototype.tokens=function(){var t=this,e=0;return this.args().map((function(n){var i=t.createToken(n,t.idx+e);return i instanceof r?e+=Object.keys(i.ExtractSchema()).length:e++,i}))},r.prototype.Encode=function(t){return{prim:"Pair",args:this.tokens().map((function(r){return r.Encode(t)}))}},r.prototype.ExtractSignature=function(){var t,r,e,n,i=this.args(),a=this.createToken(i[0],this.idx),o=1;a instanceof P&&(o=Object.keys(a.ExtractSchema()).length);var s=this.createToken(i[1],this.idx+o),c=[];try{for(var u=f(a.ExtractSignature()),p=u.next();!p.done;p=u.next()){var l=p.value;try{for(var h=(e=void 0,f(s.ExtractSignature())),m=h.next();!m.done;m=h.next()){var g=m.value;c.push(d(l,g))}}catch(v){e={error:v}}finally{try{m&&!m.done&&(n=h.return)&&n.call(h)}finally{if(e)throw e.error}}}}catch(y){t={error:y}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}return c},r.prototype.ToBigMapKey=function(t){return{key:this.EncodeObject(t),type:this.typeWithoutAnnotations()}},r.prototype.ToKey=function(t){return this.Execute(t)},r.prototype.EncodeObject=function(t){var e,n,i=m(this.tokens(),2),a=i[0],o=i[1];return e=a instanceof r&&!a.hasAnnotations()?t:t[a.annot()],n=o instanceof r&&!o.hasAnnotations()?t:t[o.annot()],{prim:"Pair",args:[a.EncodeObject(e),o.EncodeObject(n)]}},r.prototype.traversal=function(t,e){var n,i,a,o=this.args(),s=this.createToken(o[0],this.idx),c=1;s instanceof r&&!s.hasAnnotations()?(a=t(s),c=Object.keys(s.ExtractSchema()).length):((n={})[s.annot()]=t(s),a=n);var u,p=this.createToken(o[1],this.idx+c);return p instanceof r&&!p.hasAnnotations()?u=e(p):((i={})[p.annot()]=e(p),u=i),l(l({},a),u)},r.prototype.Execute=function(t,r){var e=T(t,"Pair");return this.traversal((function(t){return t.Execute(e[0],r)}),(function(t){return t.Execute(e[1],r)}))},r.prototype.ExtractSchema=function(){return this.traversal((function(t){return t.ExtractSchema()}),(function(t){return t.ExtractSchema()}))},r.prototype.compare=function(t,e){var n=m(this.tokens(),2),i=n[0],a=n[1],o=function(t,e){return t instanceof r&&!t.hasAnnotations()?e:e[t.annot()]};if(i instanceof w&&a instanceof w){var s=i.compare(o(i,t),o(i,e));return 0===s?a.compare(o(a,t),o(a,e)):s}throw new Error("Not a comparable pair")},r.prim="pair",r}(w),S=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="NatValidationError",i}return u(r,t),r}(b),R=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Execute=function(t){return new o.a(t[Object.keys(t)[0]])},r.prototype.Encode=function(t){var r=t.pop(),e=this.isValid(r);if(e)throw e;return{int:String(r).toString()}},r.prototype.isValid=function(t){var r=new o.a(t);return r.isNaN()?new S(t,this,"Value is not a number: "+t):r.isNegative()?new S(t,this,"Value cannot be negative: "+t):null},r.prototype.EncodeObject=function(t){var r=this.isValid(t);if(r)throw r;return{int:String(t).toString()}},r.prototype.ExtractSchema=function(){return r.prim},r.prototype.ToBigMapKey=function(t){return{key:{int:t},type:{prim:r.prim}}},r.prototype.ToKey=function(t){return t.int},r.prim="nat",r}(w),N=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Execute=function(t){return t[Object.keys(t)[0]]},r.prototype.ExtractSchema=function(){return r.prim},r.prototype.Encode=function(t){return{string:t.pop()}},r.prototype.EncodeObject=function(t){return{string:t}},r.prototype.ToKey=function(t){return t.string},r.prototype.ToBigMapKey=function(t){return{key:{string:t},type:{prim:r.prim}}},r.prim="string",r}(w),D=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="AddressValidationError",i}return u(r,t),r}(b),k=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.ToBigMapKey=function(t){return{key:{bytes:Object(s.e)(t)},type:{prim:"bytes"}}},r.prototype.isValid=function(t){return Object(s.o)(t)!==s.b.VALID?new D(t,this,"Address is not valid: "+t):null},r.prototype.Encode=function(t){var r=t.pop(),e=this.isValid(r);if(e)throw e;return{string:r}},r.prototype.EncodeObject=function(t){var r=this.isValid(t);if(r)throw r;return{string:t}},r.prototype.Execute=function(t){return t.string?t.string:Object(s.j)(t.bytes)},r.prototype.ExtractSchema=function(){return r.prim},r.prototype.ToKey=function(t){var r=t.bytes,e=t.string;return e||Object(s.j)(r)},r.prototype.compare=function(r,e){var n=function(t){return t.startsWith("tz")};return n(r)&&n(e)?t.prototype.compare.call(this,r,e):n(r)?-1:n(e)?1:t.prototype.compare.call(this,r,e)},r.prim="address",r}(w),x=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="MapValidationError",i}return u(r,t),r}(b),C=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),Object.defineProperty(r.prototype,"ValueSchema",{get:function(){return this.createToken(this.val.args[1],0)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"KeySchema",{get:function(){return this.createToken(this.val.args[0],0)},enumerable:!1,configurable:!0}),r.prototype.isValid=function(t){return y.isMichelsonMap(t)?null:new x(t,this,"Value must be a MichelsonMap")},r.prototype.Execute=function(t,r){var e=this,n=new y(this.val);return t.forEach((function(t){n.set(e.KeySchema.ToKey(t.args[0]),e.ValueSchema.Execute(t.args[1],r))})),n},r.prototype.Encode=function(t){var r=this,e=t.pop(),n=this.isValid(e);if(n)throw n;return Array.from(e.keys()).sort((function(t,e){return r.KeySchema.compare(t,e)})).map((function(t){return{prim:"Elt",args:[r.KeySchema.EncodeObject(t),r.ValueSchema.EncodeObject(e.get(t))]}}))},r.prototype.EncodeObject=function(t){var r=this,e=t,n=this.isValid(e);if(n)throw n;return Array.from(e.keys()).sort((function(t,e){return r.KeySchema.compare(t,e)})).map((function(t){return{prim:"Elt",args:[r.KeySchema.EncodeObject(t),r.ValueSchema.EncodeObject(e.get(t))]}}))},r.prototype.ExtractSchema=function(){return{map:{key:this.KeySchema.ExtractSchema(),value:this.ValueSchema.ExtractSchema()}}},r.prim="map",r}(E),U=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Execute=function(t){return"true"===String(t.prim).toLowerCase()},r.prototype.Encode=function(t){return{prim:t.pop()?"True":"False"}},r.prototype.EncodeObject=function(t){return{prim:t?"True":"False"}},r.prototype.ExtractSchema=function(){return r.prim},r.prototype.ToBigMapKey=function(t){return{key:this.EncodeObject(t),type:{prim:r.prim}}},r.prototype.ToKey=function(t){return this.EncodeObject(t)},r.prototype.compare=function(t,r){return t&&r||!t&&!r?0:t?1:-1},r.prim="bool",r}(w),L=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="ContractValidationError",i}return u(r,t),r}(b),j=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.isValid=function(t){return Object(s.o)(t)!==s.b.VALID?new L(t,this,"Contract address is not valid"):null},r.prototype.Execute=function(t){return t.string?t.string:Object(s.j)(t.bytes)},r.prototype.Encode=function(t){var r=t.pop(),e=this.isValid(r);if(e)throw e;return{string:r}},r.prototype.EncodeObject=function(t){var r=this.isValid(t);if(r)throw r;return{string:t}},r.prototype.ExtractSchema=function(){return r.prim},r.prim="contract",r}(E),M=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="ListValidationError",i}return u(r,t),r}(b),G=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.isValid=function(t){return Array.isArray(t)?null:new M(t,this,"Value must be an array")},r.prototype.Encode=function(t){var r=t.pop(),e=this.isValid(r);if(e)throw e;var n=this.createToken(this.val.args[0],0);return r.reduce((function(t,r){return d(t,[n.EncodeObject(r)])}),[])},r.prototype.Execute=function(t,r){var e=this.createToken(this.val.args[0],0),n=this.isValid(t);if(n)throw n;return t.reduce((function(t,n){return d(t,[e.Execute(n,r)])}),[])},r.prototype.EncodeObject=function(t){var r=this.createToken(this.val.args[0],0),e=this.isValid(t);if(e)throw e;return t.reduce((function(t,e){return d(t,[r.EncodeObject(e)])}),[])},r.prototype.ExtractSchema=function(){return r.prim},r.prim="list",r}(E),F=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="MutezValidationError",i}return u(r,t),r}(b),K=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Execute=function(t){return new o.a(t[Object.keys(t)[0]])},r.prototype.ExtractSchema=function(){return r.prim},r.prototype.isValid=function(t){return new o.a(t).isNaN()?new F(t,this,"Value is not a number: "+t):null},r.prototype.Encode=function(t){var r=t.pop(),e=this.isValid(r);if(e)throw e;return{int:String(r).toString()}},r.prototype.EncodeObject=function(t){var r=this.isValid(t);if(r)throw r;return{int:String(t).toString()}},r.prototype.ToBigMapKey=function(t){return{key:{int:t},type:{prim:r.prim}}},r.prototype.ToKey=function(t){return t.int},r.prim="mutez",r}(w),H=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="BytesValidationError",i}return u(r,t),r}(b),B=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.ToBigMapKey=function(t){return{key:{bytes:t},type:{prim:r.prim}}},r.prototype.isValid=function(t){return"string"==typeof t&&/^[0-9a-fA-F]*$/.test(t)&&t.length%2==0?null:new H(t,this,"Invalid bytes: "+t)},r.prototype.Encode=function(t){var r=t.pop(),e=this.isValid(r);if(e)throw e;return{bytes:String(r).toString()}},r.prototype.EncodeObject=function(t){var r=this.isValid(t);if(r)throw r;return{bytes:String(t).toString()}},r.prototype.Execute=function(t){return t.bytes},r.prototype.ExtractSchema=function(){return r.prim},r.prototype.ToKey=function(t){var r=t.bytes,e=t.string;return e||r},r.prim="bytes",r}(w),V=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.subToken=function(){return this.createToken(this.val.args[0],this.idx)},r.prototype.annot=function(){return Array.isArray(this.val.annots)?t.prototype.annot.call(this):this.createToken(this.val.args[0],this.idx).annot()},r.prototype.Encode=function(t){var r=t;return null==r?{prim:"None"}:!Array.isArray(r)||void 0!==r[r.length-1]&&null!==r[r.length-1]?{prim:"Some",args:[this.createToken(this.val.args[0],0).Encode(t)]}:(r.pop(),{prim:"None"})},r.prototype.EncodeObject=function(t){var r=this.createToken(this.val.args[0],0),e=t;return null==e?{prim:"None"}:{prim:"Some",args:[r.EncodeObject(e)]}},r.prototype.Execute=function(t,r){return"None"===t.prim?null:this.createToken(this.val.args[0],0).Execute(t.args[0],r)},r.prototype.ExtractSchema=function(){return this.createToken(this.val.args[0],0).ExtractSchema()},r.prototype.ExtractSignature=function(){return d(this.createToken(this.val.args[0],0).ExtractSignature(),[[]])},r.prim="option",r}(E),z=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Execute=function(t){return t.string?new Date(t.string).toISOString():t.int?new Date(1e3*Number(t.int)).toISOString():void 0},r.prototype.Encode=function(t){return{string:t.pop()}},r.prototype.EncodeObject=function(t){return{string:t}},r.prototype.ExtractSchema=function(){return r.prim},r.prototype.ToKey=function(t){return t.string},r.prototype.ToBigMapKey=function(t){return{key:{string:t},type:{prim:r.prim}}},r.prim="timestamp",r}(w),W=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="IntValidationError",i}return u(r,t),r}(b),q=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Execute=function(t){return new o.a(t[Object.keys(t)[0]])},r.prototype.ExtractSchema=function(){return r.prim},r.prototype.isValid=function(t){return new o.a(t).isNaN()?new W(t,this,"Value is not a number: "+t):null},r.prototype.Encode=function(t){var r=t.pop(),e=this.isValid(r);if(e)throw e;return{int:String(r).toString()}},r.prototype.EncodeObject=function(t){var r=this.isValid(t);if(r)throw r;return{int:String(t).toString()}},r.prototype.ToBigMapKey=function(t){return{key:{int:t},type:{prim:r.prim}}},r.prototype.ToKey=function(t){return t.int},r.prim="int",r}(w),Y=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Encode=function(t){return t.pop(),{prim:"Unit"}},r.prototype.EncodeObject=function(t){return{prim:"Unit"}},r.prototype.Execute=function(){return yt},r.prototype.ExtractSchema=function(){return r.prim},r.prim="unit",r}(E),Q=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="KeyValidationError",i}return u(r,t),r}(b),J=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Execute=function(t){return t.string?t.string:Object(s.h)(t.bytes)},r.prototype.isValid=function(t){return Object(s.s)(t)!==s.b.VALID?new Q(t,this,"Key is not valid"):null},r.prototype.Encode=function(t){var r=t.pop(),e=this.isValid(r);if(e)throw e;return{string:r}},r.prototype.EncodeObject=function(t){var r=this.isValid(t);if(r)throw r;return{string:t}},r.prototype.ExtractSchema=function(){return r.prim},r.prim="key",r}(E),Z=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="KeyHashValidationError",i}return u(r,t),r}(b),X=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Execute=function(t){return t.string?t.string:Object(s.i)(t.bytes)},r.prototype.isValid=function(t){return Object(s.r)(t)!==s.b.VALID?new Z(t,this,"KeyHash is not valid: "+t):null},r.prototype.Encode=function(t){var r=t.pop(),e=this.isValid(r);if(e)throw e;return{string:r}},r.prototype.EncodeObject=function(t){var r=this.isValid(t);if(r)throw r;return{string:t}},r.prototype.ExtractSchema=function(){return r.prim},r.prototype.ToKey=function(t){var r=t.string,e=t.bytes;return r||Object(s.i)(e)},r.prototype.ToBigMapKey=function(t){return{key:{string:t},type:{prim:r.prim}}},r.prim="key_hash",r}(w),$=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="SignatureValidationError",i}return u(r,t),r}(b),tt=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Execute=function(t){return t.string},r.prototype.isValid=function(t){return Object(s.t)(t)!==s.b.VALID?new $(t,this,"Signature is not valid"):null},r.prototype.Encode=function(t){var r=t.pop(),e=this.isValid(r);if(e)throw e;return{string:r}},r.prototype.EncodeObject=function(t){var r=this.isValid(t);if(r)throw r;return{string:t}},r.prototype.ExtractSchema=function(){return r.prim},r.prim="signature",r}(E),rt=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Execute=function(t){return t.string},r.prototype.Encode=function(t){return t.pop()},r.prototype.EncodeObject=function(t){return t},r.prototype.ExtractSchema=function(){var t,e=this.createToken(this.val.args[0],this.idx),n=this.createToken(this.val.args[1],this.idx+1);return(t={})[r.prim]={parameters:e.ExtractSchema(),returns:n.ExtractSchema()},t},r.prim="lambda",r}(E),et=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Execute=function(t){return t.string},r.prototype.Encode=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=t.pop();return{string:e}},r.prototype.EncodeObject=function(t){return{string:t}},r.prototype.ExtractSchema=function(){return r.prim},r.prim="operation",r}(E),nt=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="SetValidationError",i}return u(r,t),r}(b),it=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),Object.defineProperty(r.prototype,"KeySchema",{get:function(){return this.createToken(this.val.args[0],0)},enumerable:!1,configurable:!0}),r.prototype.isValid=function(t){return Array.isArray(t)?null:new nt(t,this,"Value must be an array")},r.prototype.Encode=function(t){var r=this,e=t.pop(),n=this.isValid(e);if(n)throw n;return e.sort((function(t,e){return r.KeySchema.compare(t,e)})).reduce((function(t,e){return d(t,[r.KeySchema.EncodeObject(e)])}),[])},r.prototype.Execute=function(t,r){var e=this;return t.reduce((function(t,n){return d(t,[e.KeySchema.Execute(n,r)])}),[])},r.prototype.EncodeObject=function(t){var r=this,e=this.isValid(t);if(e)throw e;return t.sort((function(t,e){return r.KeySchema.compare(t,e)})).reduce((function(t,e){return d(t,[r.KeySchema.EncodeObject(e)])}),[])},r.prototype.ExtractSchema=function(){return r.prim},r.prim="set",r}(E),at=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.value=r,i.token=e,i.name="ChainIDValidationError",i}return u(r,t),r}(b),ot=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.isValid=function(t){return Object(s.p)(t)!==s.b.VALID?new at(t,this,"ChainID is not valid"):null},r.prototype.Execute=function(t){return t[Object.keys(t)[0]]},r.prototype.ExtractSchema=function(){return r.prim},r.prototype.Encode=function(t){var r=t.pop(),e=this.isValid(r);if(e)throw e;return{string:r}},r.prototype.EncodeObject=function(t){var r=this.isValid(t);if(r)throw r;return{string:t}},r.prototype.ToKey=function(t){return t.string},r.prototype.ToBigMapKey=function(t){return{key:{string:t},type:{prim:r.prim}}},r.prim="chain_id",r}(w),st=function(){this.name="TicketEncodeError",this.message="Tickets cannot be sent to the blockchain; they are created on-chain"},ct=[{prim:"contract"},{prim:"nat"},{prim:"int"}],ut=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.val=r,i.idx=e,i.fac=n,i}return u(r,t),r.prototype.Encode=function(t){throw new st},r.prototype.EncodeObject=function(t){throw new st},r.prototype.Execute=function(t,r){var e=this.createToken(ct[0],this.idx),n=this.createToken(ct[1],this.idx),i=this.createToken(ct[2],this.idx);return{ticketer:e.Execute(t.args[0]),value:n.Execute(t.args[1]),amount:i.Execute(t.args[2])}},r.prototype.ExtractSchema=function(){return{ticketer:j.prim,value:R.prim,amount:q.prim}},r.prim="ticket",r}(E),pt=[I,R,N,A,k,C,U,P,j,G,K,B,V,z,q,Y,J,X,tt,rt,et,it,ot,ut],lt=function(t,r){this.message=t,this.data=r,this.name="Invalid token error"};function ht(t,r){if(Array.isArray(t))return new I(t,r,ht);var e=pt.find((function(r){return r.prim===t.prim}));if(!e)throw new lt("Malformed data expected a value with a valid prim property",t);return new e(t,r,ht)}var ft=Symbol.for("taquito-schema-type-symbol");function mt(t,r){var e,n;return void 0===r&&(r=I.prim),Array.isArray(t)?mt({prim:r,args:t},r):t.prim===r&&(null===(e=t.args)||void 0===e?void 0:e.length)>2?l(l({},t),{args:[t.args[0],{prim:r,args:null===(n=t.args)||void 0===n?void 0:n.slice(1)}]}):t}function dt(t,r){var e=mt(t),n=mt(r);return e.prim===n.prim&&(void 0===e.args&&void 0===n.args||void 0!==e.args&&void 0!==n.args&&e.args.length===n.args.length&&e.args.every((function(t,r){var e;return dt(t,null===(e=n.args)||void 0===e?void 0:e[r])})))&&(void 0===e.annots&&void 0===n.annots||void 0!==e.annots&&void 0!==n.annots&&e.annots.length===n.annots.length&&e.annots.every((function(t,r){var e;return t===(null===(e=n.annots)||void 0===e?void 0:e[r])})))}var gt=function(){function t(t){if(this[_]=!0,this.root=ht(t,0),this.root instanceof A)this.bigMap=this.root;else if(this.isExpressionExtended(t)&&"pair"===t.prim){var r=t.args[0];this.isExpressionExtended(r)&&"big_map"===r.prim&&(this.bigMap=new A(r,0,ht))}}return t.isSchema=function(t){return t&&!0===t[ft]},t.fromRPCResponse=function(r){var e=r&&r.script&&Array.isArray(r.script.code)&&r.script.code.find((function(t){return"storage"===t.prim}));if(!e||!Array.isArray(e.args))throw new Error("Invalid rpc response passed as arguments");return new t(e.args[0])},t.prototype.isExpressionExtended=function(t){return"prim"in t&&Array.isArray(t.args)},t.prototype.removeTopLevelAnnotation=function(t){return(this.root instanceof I||this.root instanceof P)&&this.root.hasAnnotations()&&"object"==typeof t&&1===Object.keys(t).length?t[Object.keys(t)[0]]:t},t.prototype.Execute=function(t,r){var e=this.root.Execute(t,r);return this.removeTopLevelAnnotation(e)},t.prototype.Typecheck=function(t){try{return this.root.EncodeObject(t),!0}catch(r){return!1}},t.prototype.ExecuteOnBigMapDiff=function(t,r){if(!this.bigMap)throw new Error("No big map schema");if(!Array.isArray(t))throw new Error("Invalid big map diff. It must be an array");var e=t.map((function(t){return{args:[t.key,t.value]}}));return this.bigMap.Execute(e,r)},t.prototype.ExecuteOnBigMapValue=function(t,r){if(!this.bigMap)throw new Error("No big map schema");return this.bigMap.ValueSchema.Execute(t,r)},t.prototype.EncodeBigMapKey=function(t){if(!this.bigMap)throw new Error("No big map schema");try{return this.bigMap.KeySchema.ToBigMapKey(t)}catch(r){throw new Error("Unable to encode big map key: "+r)}},t.prototype.Encode=function(t){try{return this.root.EncodeObject(t)}catch(r){if(r instanceof b)throw r;throw new Error("Unable to encode storage object. "+r)}},t.prototype.ExtractSchema=function(){return this.removeTopLevelAnnotation(this.root.ExtractSchema())},t.prototype.ComputeState=function(t,r){var e,n=this;if(!this.bigMap)throw new Error("No big map schema");var i=t.reduce((function(t,r){return l(l({},t),n.ExecuteOnBigMapDiff(r.contents[0].metadata.operation_result.big_map_diff))}),{});return l(l({},this.Execute(r)),((e={})[this.bigMap.annot()]=i,e))},t.prototype.FindFirstInTopLevelPair=function(t,r){return this.findValue(this.root.val,t,r)},t.prototype.findValue=function(t,r,e){if(dt(e,t))return r;if(Array.isArray(t)||"pair"===t.prim){var n=mt(t),i=mt(r,"Pair");if(void 0===n.args||void 0===i.args)throw new Error("Tokens have no arguments");return this.findValue(n.args[0],i.args[0],e)||this.findValue(n.args[1],i.args[1],e)}},t}();_=ft;var vt=function(){function t(t){this.root=ht(t,0)}return t.fromRPCResponse=function(r){var e=r&&r.script&&Array.isArray(r.script.code)&&r.script.code.find((function(t){return"parameter"===t.prim}));if(!e||!Array.isArray(e.args))throw new Error("Invalid rpc response passed as arguments");return new t(e.args[0])},Object.defineProperty(t.prototype,"isMultipleEntryPoint",{get:function(){return this.root instanceof P||this.root instanceof V&&this.root.subToken()instanceof P},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasAnnotation",{get:function(){return!this.isMultipleEntryPoint||"0"!==Object.keys(this.ExtractSchema())[0]},enumerable:!1,configurable:!0}),t.prototype.Execute=function(t,r){return this.root.Execute(t,r)},t.prototype.Encode=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return this.root.Encode(t.reverse())}catch(e){if(e instanceof b)throw e;throw new Error("Unable to encode storage object. "+e)}},t.prototype.ExtractSchema=function(){return this.root.ExtractSchema()},t.prototype.ExtractSignatures=function(){return this.root.ExtractSignature()},t}(),yt=Symbol()},165:function(t,r,e){"use strict";e.d(r,"a",(function(){return a})),e.d(r,"b",(function(){return p})),e.d(r,"c",(function(){return S})),e.d(r,"d",(function(){return I})),e.d(r,"e",(function(){return R})),e.d(r,"f",(function(){return U})),e.d(r,"g",(function(){return _})),e.d(r,"h",(function(){return D})),e.d(r,"i",(function(){return k})),e.d(r,"j",(function(){return N})),e.d(r,"k",(function(){return x})),e.d(r,"l",(function(){return h})),e.d(r,"m",(function(){return C})),e.d(r,"n",(function(){return s})),e.d(r,"o",(function(){return y})),e.d(r,"p",(function(){return b})),e.d(r,"q",(function(){return E})),e.d(r,"r",(function(){return w})),e.d(r,"s",(function(){return A})),e.d(r,"t",(function(){return O}));var n,i,a,o=e(111);!function(t){t.TZ1="tz1",t.TZ2="tz2",t.TZ3="tz3",t.KT="KT",t.KT1="KT1",t.EDSK2="edsk2",t.SPSK="spsk",t.P2SK="p2sk",t.EDPK="edpk",t.SPPK="sppk",t.P2PK="p2pk",t.EDESK="edesk",t.SPESK="spesk",t.P2ESK="p2esk",t.EDSK="edsk",t.EDSIG="edsig",t.SPSIG="spsig",t.P2SIG="p2sig",t.SIG="sig",t.NET="Net",t.NCE="nce",t.B="b",t.O="o",t.LO="Lo",t.LLO="LLo",t.P="P",t.CO="Co",t.ID="id",t.EXPR="expr",t.TZ="TZ"}(a||(a={}));var s=((n={})[a.TZ1]=new Uint8Array([6,161,159]),n[a.TZ2]=new Uint8Array([6,161,161]),n[a.TZ3]=new Uint8Array([6,161,164]),n[a.KT]=new Uint8Array([2,90,121]),n[a.KT1]=new Uint8Array([2,90,121]),n[a.EDSK]=new Uint8Array([43,246,78,7]),n[a.EDSK2]=new Uint8Array([13,15,58,7]),n[a.SPSK]=new Uint8Array([17,162,224,201]),n[a.P2SK]=new Uint8Array([16,81,238,189]),n[a.EDPK]=new Uint8Array([13,15,37,217]),n[a.SPPK]=new Uint8Array([3,254,226,86]),n[a.P2PK]=new Uint8Array([3,178,139,127]),n[a.EDESK]=new Uint8Array([7,90,60,179,41]),n[a.SPESK]=new Uint8Array([9,237,241,174,150]),n[a.P2ESK]=new Uint8Array([9,48,57,115,171]),n[a.EDSIG]=new Uint8Array([9,245,205,134,18]),n[a.SPSIG]=new Uint8Array([13,115,101,19,63]),n[a.P2SIG]=new Uint8Array([54,240,44,52]),n[a.SIG]=new Uint8Array([4,130,43]),n[a.NET]=new Uint8Array([87,82,0]),n[a.NCE]=new Uint8Array([69,220,169]),n[a.B]=new Uint8Array([1,52]),n[a.O]=new Uint8Array([5,116]),n[a.LO]=new Uint8Array([133,233]),n[a.LLO]=new Uint8Array([29,159,109]),n[a.P]=new Uint8Array([2,170]),n[a.CO]=new Uint8Array([79,179]),n[a.ID]=new Uint8Array([153,103]),n[a.EXPR]=new Uint8Array([13,44,64,27]),n[a.TZ]=new Uint8Array([2,90,121]),n),c=((i={})[a.TZ1]=20,i[a.TZ2]=20,i[a.TZ3]=20,i[a.KT]=20,i[a.KT1]=20,i[a.EDPK]=32,i[a.SPPK]=33,i[a.P2PK]=33,i[a.EDSIG]=64,i[a.SPSIG]=64,i[a.P2SIG]=64,i[a.SIG]=64,i[a.NET]=4,i[a.B]=32,i[a.P]=32,i);function u(t,r){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var n,i,a=e.call(t),o=[];try{for(;(void 0===r||r-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(e=a.return)&&e.call(a)}finally{if(i)throw i.error}}return o}var p,l=e(294);function h(t){return"string"==typeof t&&t in s}function f(t,r){var e=new RegExp("^("+r.join("|")+")").exec(t);if(!e||0===e.length)return p.NO_PREFIX_MATCHED;var n=e[0];if(!h(n))return p.NO_PREFIX_MATCHED;var i=l.decodeUnsafe(t);return i?(i=i.slice(s[n].length)).length!==c[n]?p.INVALID_LENGTH:p.VALID:p.INVALID_CHECKSUM}!function(t){t[t.NO_PREFIX_MATCHED=0]="NO_PREFIX_MATCHED",t[t.INVALID_CHECKSUM=1]="INVALID_CHECKSUM",t[t.INVALID_LENGTH=2]="INVALID_LENGTH",t[t.VALID=3]="VALID"}(p||(p={}));var m=[a.TZ1,a.TZ2,a.TZ3],d=[a.KT1],g=[a.EDSIG,a.P2SIG,a.SPSIG,a.SIG],v=[a.EDPK,a.SPPK,a.P2PK];function y(t){return f(t,function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(u(arguments[r]));return t}(m,d))}function b(t){return f(t,[a.NET])}function E(t){return f(t,d)}function w(t){return f(t,m)}function O(t){return f(t,g)}function A(t){return f(t,v)}var P=e(548),T=e(294);function _(t){return I(P.blake2b(x(t),null,32),s.expr)}function I(t,r){var e="string"==typeof t?Uint8Array.from(o.Buffer.from(t,"hex")):t,n=new Uint8Array(r.length+e.length);return n.set(r),n.set(e,r.length),T.encode(o.Buffer.from(n.buffer))}var S=function(t,r){return T.decode(t).slice(r.length)};function R(t){var r,e=T.decode(t),n=((r={})[s.tz1.toString()]="0000",r[s.tz2.toString()]="0001",r[s.tz3.toString()]="0002",r)[new Uint8Array(e.slice(0,3)).toString()];return n?n+U(e.slice(3)):"01"+U(e.slice(3,42))+"00"}function N(t){if("00"===t.substring(0,2)){var r={"0000":s.tz1,"0001":s.tz2,"0002":s.tz3};return I(t.substring(4),r[t.substring(0,4)])}return I(t.substring(2,42),s.KT)}function D(t){if("0"===t[0]){var r={"00":new Uint8Array([13,15,37,217]),"01":new Uint8Array([3,254,226,86]),"02":new Uint8Array([3,178,139,127])};return I(t.substring(2),r[t.substring(0,2)])}}function k(t){if("0"===t[0]){var r={"00":new Uint8Array([6,161,159]),"01":new Uint8Array([6,161,161]),"02":new Uint8Array([6,161,164])};return I(t.substring(2),r[t.substring(0,2)])}}var x=function(t){return new Uint8Array(t.match(/[\da-f]{2}/gi).map((function(t){return parseInt(t,16)})))},C=function(t,r){var e=new Uint8Array(t.length+r.length);return e.set(t),e.set(r,t.length),e},U=function(t){var r=new Uint8Array(t),e=[];return r.forEach((function(t){var r=("00"+t.toString(16)).slice(-2);e.push(r)})),e.join("")}},192:function(t,r,e){"use strict";e.d(r,"b",(function(){return J.a})),e.d(r,"a",(function(){return sn})),e.d(r,"c",(function(){return ae})),e.d(r,"d",(function(){return ge})),e.d(r,"e",(function(){return Pn})),e.d(r,"f",(function(){return Je})),e.d(r,"g",(function(){return Ke})),e.d(r,"h",(function(){return Be})),e.d(r,"i",(function(){return He}));var n=e(215),i=e(470),a=e.n(i),o=function(){return(o=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var i in r=arguments[e])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};function s(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(e[n[i]]=t[n[i]])}return e}function c(t,r,e,n){return new(e||(e=Promise))((function(i,a){function o(t){try{c(n.next(t))}catch(r){a(r)}}function s(t){try{c(n.throw(t))}catch(r){a(r)}}function c(t){var r;t.done?i(t.value):(r=t.value,r instanceof e?r:new e((function(t){t(r)}))).then(o,s)}c((n=n.apply(t,r||[])).next())}))}function u(t,r){var e,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=r.call(t,o)}catch(s){a=[6,s],n=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var p,l=e(471),h=e(510);function f(t,r){var e=Array.isArray(t);void 0===r&&(r=Object.keys(t));var n=e?[]:{};return r.forEach((function(r){var e,i=l(t,r);if(void 0!==i){if(Array.isArray(i))return e=f(i),void h(n,r,e);e=new a.a(i),h(n,r,e)}})),n}!function(t){t.ORIGINATION="origination",t.DELEGATION="delegation",t.REVEAL="reveal",t.TRANSACTION="transaction",t.ACTIVATION="activate_account",t.ENDORSEMENT="endorsement",t.SEED_NONCE_REVELATION="seed_nonce_revelation",t.DOUBLE_ENDORSEMENT_EVIDENCE="double_endorsement_evidence",t.DOUBLE_BAKING_EVIDENCE="double_baking_evidence",t.PROPOSALS="proposals",t.BALLOT="ballot"}(p||(p={}));var m={block:"head"},d=function(){function t(t,r,e){void 0===r&&(r="main"),void 0===e&&(e=new n.a),this.url=t,this.chain=r,this.httpBackend=e}return t.prototype.createURL=function(t){return""+this.url.replace(/\/+$/g,"")+t},t.prototype.getBlockHash=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r+"/hash"),method:"GET"})];case 1:return[2,t.sent()]}}))}))},t.prototype.getLiveBlocks=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r+"/live_blocks"),method:"GET"})];case 1:return[2,t.sent()]}}))}))},t.prototype.getBalance=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){var r;return u(this,(function(n){switch(n.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/context/contracts/"+t+"/balance"),method:"GET"})];case 1:return r=n.sent(),[2,new a.a(r)]}}))}))},t.prototype.getStorage=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){return u(this,(function(r){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/context/contracts/"+t+"/storage"),method:"GET"})]}))}))},t.prototype.getScript=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){return u(this,(function(r){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/context/contracts/"+t+"/script"),method:"GET"})]}))}))},t.prototype.getContract=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){var r;return u(this,(function(n){switch(n.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/context/contracts/"+t),method:"GET"})];case 1:return r=n.sent(),[2,o(o({},r),{balance:new a.a(r.balance)})]}}))}))},t.prototype.getManagerKey=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){return u(this,(function(r){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/context/contracts/"+t+"/manager_key"),method:"GET"})]}))}))},t.prototype.getDelegate=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){return u(this,(function(r){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/context/contracts/"+t+"/delegate"),method:"GET"})]}))}))},t.prototype.getBigMapKey=function(t,r,e){var n=(void 0===e?m:e).block;return c(this,void 0,void 0,(function(){return u(this,(function(e){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+n+"/context/contracts/"+t+"/big_map_get"),method:"POST"},r)]}))}))},t.prototype.getBigMapExpr=function(t,r,e){var n=(void 0===e?m:e).block;return c(this,void 0,void 0,(function(){return u(this,(function(e){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+n+"/context/big_maps/"+t+"/"+r),method:"GET"})]}))}))},t.prototype.getDelegates=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){var r;return u(this,(function(n){switch(n.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/context/delegates/"+t),method:"GET"})];case 1:return[2,{deactivated:(r=n.sent()).deactivated,balance:new a.a(r.balance),frozen_balance:new a.a(r.frozen_balance),frozen_balance_by_cycle:r.frozen_balance_by_cycle.map((function(t){var r=t.deposit,e=t.fees,n=t.rewards,i=s(t,["deposit","fees","rewards"]);return o(o({},i),{deposit:new a.a(r),fees:new a.a(e),rewards:new a.a(n)})})),staking_balance:new a.a(r.staking_balance),delegated_contracts:r.delegated_contracts,delegated_balance:new a.a(r.delegated_balance),grace_period:r.grace_period}]}}))}))},t.prototype.getConstants=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){var t,e;return u(this,(function(n){switch(n.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r+"/context/constants"),method:"GET"})];case 1:return t=n.sent(),e=f(t,["time_between_blocks","hard_gas_limit_per_operation","hard_gas_limit_per_block","proof_of_work_threshold","tokens_per_roll","seed_nonce_revelation_tip","block_security_deposit","endorsement_security_deposit","block_reward","endorsement_reward","cost_per_byte","hard_storage_limit_per_operation","test_chain_duration","baking_reward_per_endorsement","delay_per_missing_endorsement"]),[2,o(o({},t),e)]}}))}))},t.prototype.getBlock=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r),method:"GET"})];case 1:return[2,t.sent()]}}))}))},t.prototype.getBlockHeader=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r+"/header"),method:"GET"})];case 1:return[2,t.sent()]}}))}))},t.prototype.getBlockMetadata=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r+"/metadata"),method:"GET"})];case 1:return[2,t.sent()]}}))}))},t.prototype.getBakingRights=function(t,r){void 0===t&&(t={});var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){return u(this,(function(r){switch(r.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/helpers/baking_rights"),method:"GET",query:t})];case 1:return[2,r.sent()]}}))}))},t.prototype.getEndorsingRights=function(t,r){void 0===t&&(t={});var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){return u(this,(function(r){switch(r.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/helpers/endorsing_rights"),method:"GET",query:t})];case 1:return[2,r.sent()]}}))}))},t.prototype.getBallotList=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r+"/votes/ballot_list"),method:"GET"})];case 1:return[2,t.sent()]}}))}))},t.prototype.getBallots=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r+"/votes/ballots"),method:"GET"})];case 1:return[2,t.sent()]}}))}))},t.prototype.getCurrentPeriodKind=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r+"/votes/current_period_kind"),method:"GET"})];case 1:return[2,t.sent()]}}))}))},t.prototype.getCurrentProposal=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r+"/votes/current_proposal"),method:"GET"})];case 1:return[2,t.sent()]}}))}))},t.prototype.getCurrentQuorum=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r+"/votes/current_quorum"),method:"GET"})];case 1:return[2,t.sent()]}}))}))},t.prototype.getVotesListings=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r+"/votes/listings"),method:"GET"})];case 1:return[2,t.sent()]}}))}))},t.prototype.getProposals=function(t){var r=(void 0===t?m:t).block;return c(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+r+"/votes/proposals"),method:"GET"})];case 1:return[2,t.sent()]}}))}))},t.prototype.forgeOperations=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){return u(this,(function(r){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/helpers/forge/operations"),method:"POST"},t)]}))}))},t.prototype.injectOperation=function(t){return c(this,void 0,void 0,(function(){return u(this,(function(r){return[2,this.httpBackend.createRequest({url:this.createURL("/injection/operation"),method:"POST"},t)]}))}))},t.prototype.preapplyOperations=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){return u(this,(function(r){switch(r.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/helpers/preapply/operations"),method:"POST"},t)];case 1:return[2,r.sent()]}}))}))},t.prototype.getEntrypoints=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){return u(this,(function(r){switch(r.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/context/contracts/"+t+"/entrypoints"),method:"GET"})];case 1:return[2,r.sent()]}}))}))},t.prototype.runOperation=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){return u(this,(function(r){switch(r.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/helpers/scripts/run_operation"),method:"POST"},t)];case 1:return[2,r.sent()]}}))}))},t.prototype.runCode=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){return u(this,(function(r){switch(r.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/helpers/scripts/run_code"),method:"POST"},t)];case 1:return[2,r.sent()]}}))}))},t.prototype.getChainId=function(){return c(this,void 0,void 0,(function(){return u(this,(function(t){return[2,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/chain_id"),method:"GET"})]}))}))},t.prototype.packData=function(t,r){var e=(void 0===r?m:r).block;return c(this,void 0,void 0,(function(){var r,n,i,c,p;return u(this,(function(u){switch(u.label){case 0:return[4,this.httpBackend.createRequest({url:this.createURL("/chains/"+this.chain+"/blocks/"+e+"/helpers/scripts/pack_data"),method:"POST"},t)];case 1:return r=u.sent(),n=r.gas,i=s(r,["gas"]),c=n,(p=new a.a(n||"")).isNaN()||(c=p),[2,o({gas:c},i)]}}))}))},t.prototype.getRpcUrl=function(){return this.url},t}(),g=e(425),v=e(823),y=e(269),b=e(810),E=e(551),w=e(826),O=e(312),A=e(812),P=e(804),T=e(316),_=e(820),I=e(126),S=e(807),R=e(808),N=e(238),D=e(552),k=e(822),x=e(553),C=e(809),U=e(554),L=e(811),j=e(825),M=e(813),G=e(814),F=e(815),K=e(816),H=e(817),B=e(818),V=e(819),z=e(824),W=e(555),q=e(821),Y=e(516),Q=e.n(Y),J=e(164),Z=e(165),X=Symbol("source_reference"),$=function(t,r){return($=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(t,r)};function tt(t,r){function e(){this.constructor=t}$(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}var rt=function(){return(rt=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var i in r=arguments[e])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};function et(t,r){var e,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=r.call(t,o)}catch(s){a=[6,s],n=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function nt(t){var r="function"==typeof Symbol&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function it(t,r){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var n,i,a=e.call(t),o=[];try{for(;(void 0===r||r-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(e=a.return)&&e.call(a)}finally{if(i)throw i.error}}return o}function at(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(it(arguments[r]));return t}var ot,st=function(t){function r(e,n,i){var a=t.call(this,i)||this;return a.src=e,a.idx=n,Object.setPrototypeOf(a,r.prototype),a}return tt(r,t),r}(Error);!function(t){t[t.Comment=0]="Comment",t[t.Number=1]="Number",t[t.String=2]="String",t[t.Bytes=3]="Bytes",t[t.Ident=4]="Ident"}(ot||(ot={}));var ct=new RegExp("\\s"),ut=new RegExp("[:@%_A-Za-z]"),pt=new RegExp("[@%_\\.A-Za-z0-9]"),lt=new RegExp("[0-9]"),ht=new RegExp("[0-9a-fA-F]");function ft(t,r){var e,n,i,a,o;return void 0===r&&(r=!1),et(this,(function(s){switch(s.label){case 0:e=0,s.label=1;case 1:if(!(e<t.length))return[3,19];for(;e<t.length&&ct.test(t[e]);)e++;if(e===t.length)return[2];if(n=t[e],i=e,!ut.test(n))return[3,3];for(e++;e<t.length&&pt.test(t[e]);)e++;return[4,{t:ot.Ident,v:t.slice(i,e),first:i,last:e}];case 2:return s.sent(),[3,18];case 3:if(!(t.length-e>1&&"0x"===t.substr(e,2)))return[3,5];for(e+=2;e<t.length&&ht.test(t[e]);)e++;if(0!=(e-i&1))throw new st(t,e,"Bytes literal length is expected to be power of two");return[4,{t:ot.Bytes,v:t.slice(i,e),first:i,last:e}];case 4:return s.sent(),[3,18];case 5:if(!lt.test(n)&&"-"!==n)return[3,7];for("-"===n&&e++,a=e;e<t.length&&lt.test(t[e]);)e++;if(a===e)throw new st(t,e,"Number literal is too short");return[4,{t:ot.Number,v:t.slice(i,e),first:i,last:e}];case 6:return s.sent(),[3,18];case 7:if('"'!==n)return[3,9];for(e++,o=!1;e<t.length&&(o||'"'!==t[e]);e++)o=!o&&"\\"===t[e];if(e===t.length)throw new st(t,e,"Unterminated string literal");return e++,[4,{t:ot.String,v:t.slice(i,e),first:i,last:e}];case 8:return s.sent(),[3,18];case 9:if("#"!==n)return[3,12];for(e++;e<t.length&&"\n"!==t[e];)e++;return r?[4,{t:ot.Comment,v:t.slice(i,e),first:i,last:e}]:[3,11];case 10:s.sent(),s.label=11;case 11:return[3,18];case 12:if(!(t.length-e>1&&"/*"===t.substr(e,2)))return[3,15];for(e+=2;e<t.length&&!(t.length-e>1&&"*/"===t.substr(e,2));)e++;if(e===t.length)throw new st(t,e,"Unterminated C style comment");return e+=2,r?[4,{t:ot.Comment,v:t.slice(i,e),first:i,last:e}]:[3,14];case 13:s.sent(),s.label=14;case 14:return[3,18];case 15:return"("!==n&&")"!==n&&"{"!==n&&"}"!==n&&";"!==n?[3,17]:(e++,[4,{t:n,v:n,first:i,last:e}]);case 16:return s.sent(),[3,18];case 17:throw new st(t,e,"Invalid character at offset "+e+": `"+n+"'");case 18:return[3,1];case 19:return[2]}}))}var mt,dt=Symbol("ref_contract");!function(t){t.Pt24m4xi="Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd",t.PsBABY5H="PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU",t.PsBabyM1="PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS",t.PsCARTHA="PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb",t.PsDELPH1="PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo",t.PtEdo2Zk="PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA"}(mt||(mt={}));var gt=mt.PsDELPH1,vt=function(t){function r(e,n){var i=t.call(this,n)||this;return i.prim=e,Object.setPrototypeOf(i,r.prototype),i}return tt(r,t),r}(Error);function yt(t,r){var e,n;if(0===r&&void 0===t.args||(null===(e=t.args)||void 0===e?void 0:e.length)===r)return!0;throw new vt(t,"macro "+t.prim+" expects "+r+" arguments, was given "+(null===(n=t.args)||void 0===n?void 0:n.length))}function bt(t){if(void 0===t.annots)return!0;throw new vt(t,"unexpected annotation on macro "+t.prim+": "+t.annots)}function Et(t,r){if("int"in r)return!0;throw new vt(t,"macro "+t.prim+" expects int argument")}function wt(t,r,e,n){var i,a=0,o=0,s=[null,null];if(a===r.length)throw new vt(t,"unexpected end: "+t.prim);var c,u=r[a++];switch(u){case"P":var p=wt(t,r.slice(a),e.slice(o),n);i=h=p.r,a+=f=p.n,o+=m=p.an;break;case"A":o!==e.length&&(s[0]=e[o++]);break;default:throw new vt(t,t.prim+": unexpected character: "+u)}if(a===r.length)throw new vt(t,"unexpected end: "+t.prim);switch(u=r[a++]){case"P":var l=wt(t,r.slice(a),e.slice(o),n),h=l.r,f=l.n,m=l.an;c=h.map((function(t){var r=it(t,2);return[r[0]+1,r[1]]})),a+=f,o+=m;break;case"I":o!==e.length&&(s[1]=e[o++]);break;default:throw new vt(t,t.prim+": unexpected character: "+u)}return{r:n(i,c,[0,s]),n:a,an:o}}function Ot(t,r,e,n){var i=r[0];switch(i){case"A":return r.length>1?[{prim:"DUP"},{prim:"DIP",args:[[{prim:"CAR",annots:["@%%"]},Ot(t,r.slice(1),[],n)]]},{prim:"CDR",annots:["@%%"]},{prim:"SWAP"},{prim:"PAIR",annots:at(["%@","%@"],e)}]:n.a;case"D":return r.length>1?[{prim:"DUP"},{prim:"DIP",args:[[{prim:"CDR",annots:["@%%"]},Ot(t,r.slice(1),[],n)]]},{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:at(["%@","%@"],e)}]:n.d;default:throw new vt(t,t.prim+": unexpected character: "+i)}}function At(t){var r,e,n=[],i=[];if(void 0!==t)try{for(var a=nt(t),o=a.next();!o.done;o=a.next()){var s=o.value;(0!==s.length&&"%"===s[0]?n:i).push(s)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(r)throw r.error}}return{fields:n,rest:i}}function Pt(t){var r=t.prim,e=t.annots,n=t.args;return rt(rt({prim:r},e&&{annots:e}),n&&{args:n})}var Tt=/^P[PAI]{3,}R$/,_t=/^UNP[PAI]{2,}R$/,It=/^C[AD]{2,}R$/,St=/^SET_C[AD]+R$/,Rt=/^MAP_C[AD]+R$/,Nt=/^DI{2,}P$/,Dt=/^DU+P$/;var kt=function(t){function r(e,n){var i=t.call(this,n)||this;return i.token=e,Object.setPrototypeOf(i,r.prototype),i}return tt(r,t),r}(Error),xt=function(t){function r(e,n){var i=t.call(this,n)||this;return i.node=e,Object.setPrototypeOf(i,r.prototype),i}return tt(r,t),r}(Error),Ct=new kt(null,"Unexpected EOF");function Ut(t){return t.t===ot.Ident&&("@"===t.v[0]||"%"===t.v[0]||":"===t.v[0])}var Lt=new RegExp("^-?[0-9]+$"),jt=new RegExp("^([0-9a-fA-F]{2})*$"),Mt=function(){function t(t){this.opt=t}return t.prototype.expand=function(t){var r,e;if(void 0===(null===(r=this.opt)||void 0===r?void 0:r.expandMacros)||(null===(e=this.opt)||void 0===e?void 0:e.expandMacros)){var n=function(t,r){var e=(null==r?void 0:r.protocol)||gt;function n(t){return void 0!==t?[{prim:"RENAME",annots:t}]:[]}switch(t.prim){case"CMPEQ":case"CMPNEQ":case"CMPLT":case"CMPGT":case"CMPLE":case"CMPGE":if(yt(t,0))return[{prim:"COMPARE"},Pt({prim:t.prim.slice(3),annots:t.annots})];break;case"IFEQ":case"IFNEQ":case"IFLT":case"IFGT":case"IFLE":case"IFGE":if(yt(t,2))return[{prim:t.prim.slice(2)},Pt({prim:"IF",annots:t.annots,args:t.args})];break;case"IFCMPEQ":case"IFCMPNEQ":case"IFCMPLT":case"IFCMPGT":case"IFCMPLE":case"IFCMPGE":if(yt(t,2))return[{prim:"COMPARE"},{prim:t.prim.slice(5)},Pt({prim:"IF",annots:t.annots,args:t.args})];break;case"FAIL":if(yt(t,0)&&bt(t))return[{prim:"UNIT"},{prim:"FAILWITH"}];break;case"ASSERT":if(yt(t,0)&&bt(t))return[{prim:"IF",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_EQ":case"ASSERT_NEQ":case"ASSERT_LT":case"ASSERT_GT":case"ASSERT_LE":case"ASSERT_GE":if(yt(t,0)&&bt(t))return[{prim:t.prim.slice(7)},{prim:"IF",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_CMPEQ":case"ASSERT_CMPNEQ":case"ASSERT_CMPLT":case"ASSERT_CMPGT":case"ASSERT_CMPLE":case"ASSERT_CMPGE":if(yt(t,0)&&bt(t))return[[{prim:"COMPARE"},{prim:t.prim.slice(10)}],{prim:"IF",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_NONE":if(yt(t,0)&&bt(t))return[{prim:"IF_NONE",args:[[],[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_SOME":if(yt(t,0))return[{prim:"IF_NONE",args:[[[{prim:"UNIT"},{prim:"FAILWITH"}]],n(t.annots)]}];break;case"ASSERT_LEFT":if(yt(t,0))return[{prim:"IF_LEFT",args:[n(t.annots),[[{prim:"UNIT"},{prim:"FAILWITH"}]]]}];break;case"ASSERT_RIGHT":if(yt(t,0))return[{prim:"IF_LEFT",args:[[[{prim:"UNIT"},{prim:"FAILWITH"}]],n(t.annots)]}];break;case"IF_SOME":if(yt(t,2))return[Pt({prim:"IF_NONE",annots:t.annots,args:[t.args[1],t.args[0]]})];break;case"IF_RIGHT":if(yt(t,2))return[Pt({prim:"IF_LEFT",annots:t.annots,args:[t.args[1],t.args[0]]})];break;case"CAR":case"CDR":if(void 0===t.args)return t;if(yt(t,1)&&Et(t,t.args[0])){var i=parseInt(t.args[0].int,10);return Pt({prim:"GET",args:[{int:"CAR"===t.prim?String(2*i+1):String(2*i)}],annots:t.annots})}}if(Tt.test(t.prim)&&yt(t,0)){var a=At(t.annots),o=a.fields,s=a.rest,c=wt(t,t.prim.slice(1),o,(function(t,r,e){return at(t||[],r||[],[e])})).r;return c.map((function(t,r){var e=it(t,2),n=e[0],i=at(function(t,r){for(var e=t.length;e>0&&t[e-1]===r;)e--;return t.slice(0,e)}(e[1],null).map((function(t){return null===t?"%":t})),0===n&&r===c.length-1?s:[]),a=Pt({prim:"PAIR",annots:0!==i.length?i:void 0});return 0===n?a:{prim:"DIP",args:1===n?[[a]]:[{int:String(n)},[a]]}}))}if(_t.test(t.prim))if(e===mt.PtEdo2Zk){if("UNPAIR"===t.prim)return t;if(yt(t,0))return wt(t,t.prim.slice(3),[],(function(t,r,e){return at([e],r||[],t||[])})).r.map((function(t){var r=it(t,1)[0],e=Pt({prim:"UNPAIR"});return 0===r?e:{prim:"DIP",args:1===r?[[e]]:[{int:String(r)},[e]]}}))}else if(yt(t,0))return wt(t,t.prim.slice(3),t.annots||[],(function(t,r,e){return at([e],r||[],t||[])})).r.map((function(t){var r=it(t,2),e=r[0],n=r[1],i=[{prim:"DUP"},Pt({prim:"CAR",annots:null!==n[0]?[n[0]]:void 0}),{prim:"DIP",args:[[Pt({prim:"CDR",annots:null!==n[1]?[n[1]]:void 0})]]}];return 0===e?i:{prim:"DIP",args:1===e?[[i]]:[{int:String(e)},[i]]}}));if(It.test(t.prim)&&yt(t,0)){var u=at(t.prim.slice(1,t.prim.length-1));return u.map((function(r,e){var n=e===u.length-1?t.annots:void 0;switch(r){case"A":return Pt({prim:"CAR",annots:n});case"D":return Pt({prim:"CDR",annots:n});default:throw new vt(t,"unexpected character: "+r)}}))}if(St.test(t.prim)&&yt(t,0)){var p=At(t.annots),l=(o=p.fields,p.rest);if(o.length>1)throw new vt(t,"unexpected annotation on macro "+t.prim+": "+o);var h=0!==o.length?{a:[{prim:"DUP"},{prim:"CAR",annots:o},{prim:"DROP"},{prim:"CDR",annots:["@%%"]},{prim:"SWAP"},{prim:"PAIR",annots:[o[0],"%@"]}],d:[{prim:"DUP"},{prim:"CDR",annots:o},{prim:"DROP"},{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@",o[0]]}]}:{a:[{prim:"CDR",annots:["@%%"]},{prim:"SWAP"},{prim:"PAIR",annots:["%","%@"]}],d:[{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@","%"]}]};return Ot(t,t.prim.slice(5,t.prim.length-1),l,h)}if(Rt.test(t.prim)&&yt(t,1)){if((o=At(t.annots).fields).length>1)throw new vt(t,"unexpected annotation on macro "+t.prim+": "+o);return h={a:[{prim:"DUP"},{prim:"CDR",annots:["@%%"]},{prim:"DIP",args:[[Pt({prim:"CAR",annots:0!==o.length?["@"+o[0].slice(1)]:void 0}),t.args[0]]]},{prim:"SWAP"},{prim:"PAIR",annots:[0!==o.length?o[0]:"%","%@"]}],d:[{prim:"DUP"},Pt({prim:"CDR",annots:0!==o.length?["@"+o[0].slice(1)]:void 0}),t.args[0],{prim:"SWAP"},{prim:"CAR",annots:["@%%"]},{prim:"PAIR",annots:["%@",0!==o.length?o[0]:"%"]}]},Ot(t,t.prim.slice(5,t.prim.length-1),[],h)}if(Nt.test(t.prim)&&yt(t,1)){for(i=0;"I"===t.prim[1+i];)i++;return Pt({prim:"DIP",args:[{int:String(i)},t.args[0]]})}if(Dt.test(t.prim)){for(i=0;"U"===t.prim[1+i];)i++;if(e!==mt.PtEdo2Zk){if(1===i){if(void 0===t.args)return t;yt(t,1)&&Et(t,t.args[0])&&(i=parseInt(t.args[0].int,10))}else yt(t,0);return 1===i?[Pt({prim:"DUP",annots:t.annots})]:2===i?[{prim:"DIP",args:[[Pt({prim:"DUP",annots:t.annots})]]},{prim:"SWAP"}]:[{prim:"DIP",args:[{int:String(i-1)},[Pt({prim:"DUP",annots:t.annots})]]},{prim:"DIG",args:[{int:String(i)}]}]}if(1===i)return t;if(yt(t,0))return Pt({prim:"DUP",args:[{int:String(i)}],annots:t.annots})}return t}(t,this.opt);return n!==t&&(n[X]=rt(rt({},t[X]||{first:0,last:0}),{macro:t})),n}return t},t.prototype.parseList=function(t,r){var e=t.next();if(e.done)throw Ct;if(e.value.t!==ot.Ident)throw new kt(e.value,"not an identifier: "+e.value.v);for(var n,i={prim:e.value.v};;){var a=t.next();if(a.done)throw Ct;if(")"===a.value.t){n=a.value.last;break}Ut(a.value)?(i.annots=i.annots||[],i.annots.push(a.value.v)):(i.args=i.args||[],i.args.push(this.parseExpr(t,a.value)))}return i[X]={first:r.first,last:n},this.expand(i)},t.prototype.parseArgs=function(t,r){for(var e,n,i={first:r.first,last:r.last},a=((e={prim:r.v})[X]=i,e);;){var o=t.next();if(o.done||"}"===o.value.t||";"===o.value.t)return[a,o];if(Ut(o.value))i.last=o.value.last,a.annots=a.annots||[],a.annots.push(o.value.v);else{var s=this.parseExpr(t,o.value);i.last=(null===(n=s[X])||void 0===n?void 0:n.last)||i.last,a.args=a.args||[],a.args.push(s)}}},t.prototype.parseSequence=function(t,r){var e,n,i={first:r.first,last:r.last},a=[];a[X]=i;for(var o="{"===r.t,s="{"===r.t?null:{value:r};;){if(null===s&&((s=t.next()).done||(i.last=s.value.last)),s.done){if(o)throw Ct;return a}if("}"===s.value.t){if(o)return a;throw new kt(s.value,"unexpected closing bracket")}if(s.value.t===ot.Ident){var c=it(this.parseArgs(t,s.value),2),u=c[0],p=c[1];i.last=(null===(e=u[X])||void 0===e?void 0:e.last)||i.last,a.push(this.expand(u)),s=p}else{var l=this.parseExpr(t,s.value);i.last=(null===(n=l[X])||void 0===n?void 0:n.last)||i.last,a.push(l),s=null}null===s&&((s=t.next()).done||(i.last=s.value.last)),s.done||";"!==s.value.t||(s=null)}},t.prototype.parseExpr=function(t,r){var e,n,i,a;switch(r.t){case ot.Ident:return this.expand(((e={prim:r.v})[X]={first:r.first,last:r.last},e));case ot.Number:return(n={int:r.v})[X]={first:r.first,last:r.last},n;case ot.String:return(i={string:JSON.parse(r.v)})[X]={first:r.first,last:r.last},i;case ot.Bytes:return(a={bytes:r.v.slice(2)})[X]={first:r.first,last:r.last},a;case"(":return this.parseList(t,r);case"{":return this.parseSequence(t,r);default:throw new kt(r,"unexpected token: "+r.v)}},t.prototype.parseScript=function(t){if("string"!=typeof t)throw new TypeError("string type was expected, got "+typeof t+" instead");var r=ft(t),e=r.next();return e.done?null:this.parseSequence(r,e.value)},t.prototype.parseMichelineExpression=function(t){if("string"!=typeof t)throw new TypeError("string type was expected, got "+typeof t+" instead");var r=ft(t),e=r.next();return e.done?null:this.parseExpr(r,e.value)},t.prototype.parseJSON=function(t){var r,e,n,i,a,o;if("object"!=typeof t)throw new TypeError("object type was expected, got "+typeof t+" instead");if(Array.isArray(t)){var s=[];try{for(var c=nt(t),u=c.next();!u.done;u=c.next()){var p=u.value;if(null===p||"object"!=typeof p)throw new xt(p,"unexpected sequence element: "+p);s.push(this.parseJSON(p))}}catch(v){r={error:v}}finally{try{u&&!u.done&&(e=c.return)&&e.call(c)}finally{if(r)throw r.error}}return s}if("prim"in t){var l=t;if("string"==typeof l.prim&&(void 0===l.annots||Array.isArray(l.annots))&&(void 0===l.args||Array.isArray(l.args))){s={prim:l.prim};if(void 0!==l.annots){try{for(var h=nt(l.annots),f=h.next();!f.done;f=h.next()){if("string"!=typeof(g=f.value))throw new xt(g,"string expected: "+g)}}catch(y){n={error:y}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}s.annots=l.annots}if(void 0!==l.args){s.args=[];try{for(var m=nt(l.args),d=m.next();!d.done;d=m.next()){var g;if(null===(g=d.value)||"object"!=typeof g)throw new xt(g,"unexpected argument: "+g);s.args.push(this.parseJSON(g))}}catch(b){a={error:b}}finally{try{d&&!d.done&&(o=m.return)&&o.call(m)}finally{if(a)throw a.error}}}return this.expand(s)}throw new xt(t,"malformed prim expression: "+t)}if("string"in t){if("string"==typeof t.string)return{string:t.string};throw new xt(t,"malformed string literal: "+t)}if("int"in t){if("string"==typeof t.int&&Lt.test(t.int))return{int:t.int};throw new xt(t,"malformed int literal: "+t)}if("bytes"in t){if("string"==typeof t.bytes&&jt.test(t.bytes))return{bytes:t.bytes};throw new xt(t,"malformed bytes literal: "+t)}throw new xt(t,"unexpected object: "+t)},t}();!function(){function t(t,r){void 0===r&&(r=0),this.opt=t,this.lev=r}t.prototype.indent=function(t){var r;void 0===t&&(t=0);var e="";if(void 0!==(null===(r=this.opt)||void 0===r?void 0:r.indent))for(var n=this.lev+t;n>0;n--)e+=this.opt.indent;return e},Object.defineProperty(t.prototype,"lf",{get:function(){var t;return(null===(t=this.opt)||void 0===t?void 0:t.newline)||""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lfsp",{get:function(){var t;return(null===(t=this.opt)||void 0===t?void 0:t.newline)||" "},enumerable:!1,configurable:!0}),t.prototype.down=function(r){return new t(this.opt,this.lev+r)}}();var Gt=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Ft=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998];function Kt(t){var r,e,n=(t.length+9)%64,i=0===n?0:64-n;if(t.length>268435455)throw new Error("sha256: message length is too big: "+t.length);var a=t.length<<3,o=at(t,[128],new Array(i).fill(0),[0,0,0,0,a>>24&255,a>>16&255,a>>8&255,255&a]);function s(t,r){return t>>>r|t<<32-r}for(var c=at(Gt),u=new Array(64),p=new Array(8),l=0;l<o.length;l+=64){for(var h=l,f=0;f<16;)u[f]=o[h]<<24|o[h+1]<<16|o[h+2]<<8|o[h+3],h+=4,f++;for(;f<64;){var m=s(u[f-15],7)^s(u[f-15],18)^u[f-15]>>>3,d=s(u[f-2],17)^s(u[f-2],19)^u[f-2]>>>10;u[f]=(0|d)+u[f-7]+m+u[f-16]|0,f++}for(var g=0;g<8;g++)p[g]=c[g];for(var v=0;v<64;v++){var y=s(p[0],2)^s(p[0],13)^s(p[0],22),b=s(p[4],6)^s(p[4],11)^s(p[4],25),E=p[7]+b+(p[4]&p[5]^~p[4]&p[6])+Ft[v]+u[v]|0,w=y+(p[0]&p[1]^p[0]&p[2]^p[1]&p[2])|0;p[7]=p[6],p[6]=p[5],p[5]=p[4],p[4]=p[3]+E|0,p[3]=p[2],p[2]=p[1],p[1]=p[0],p[0]=E+w|0}for(var O=0;O<8;O++)c[O]=c[O]+p[O]|0}var A=[];try{for(var P=nt(c),T=P.next();!T.done;T=P.next()){var _=T.value;A.push(_>>24&255),A.push(_>>16&255),A.push(_>>8&255),A.push(255&_)}}catch(I){r={error:I}}finally{try{T&&!T.done&&(e=P.return)&&e.call(P)}finally{if(r)throw r.error}}return A}var Ht=[0,1,2,3,4,5,6,7,8,255,255,255,255,255,255,255,9,10,11,12,13,14,15,16,255,17,18,19,20,21,255,22,23,24,25,26,27,28,29,30,31,32,255,255,255,255,255,255,33,34,35,36,37,38,39,40,41,42,43,255,44,45,46,47,48,49,50,51,52,53,54,55,56,57];function Bt(t,r){var e=t.charCodeAt(r)-49;if(e>=Ht.length||255===Ht[e])throw new Error("Base58 decoding error: unexpected character at position "+r+": "+t[r]);return Ht[e]}function Vt(t){var r=function(t){for(var r=[],e=0;e<t.length&&0===Bt(t,e);)e++;for(var n=e;e<t.length;)for(var i=Bt(t,e++),a=0;0!==i||a<r.length;){var o=58*(r[a]||0)+i;r[a++]=o%256,i=Math.floor(o/256)}for(;n-- >0;)r.push(0);return r.reverse()}(t);if(r.length<4)throw new Error("Base58Check decoding error: data is too short "+r.length);var e=r.slice(0,r.length-4),n=r.slice(r.length-4),i=Kt(Kt(e));if(n[0]!==i[0]||n[1]!==i[1]||n[2]!==i[2]||n[3]!==i[3])throw new Error("Base58Check decoding error: invalid checksum");return e}var zt=function(t){function r(e,n){var i=t.call(this,n)||this;return i.val=e,Object.setPrototypeOf(i,r.prototype),i}return tt(r,t),r}(Error);var Wt=function(){function t(t){if(this.neg=!1,this.buf=[],void 0!==t)if("string"==typeof t)for(var r=0;r<t.length;r++){var e=t.charCodeAt(r);if(0===r&&45===e)this.neg=!0;else{if(e<48||e>57)throw new Error("unexpected character in integer constant: "+t[r]);this.append(e-48)}}else t<0?(this.neg=!0,this.append(-t)):this.append(t)}return t.prototype.append=function(t){for(var r=0;0!==t||r<this.buf.length;){var e=10*(this.buf[r]||0)+t;this.buf[r++]=e%256,t=Math.floor(e/256)}},t.prototype.cmp=function(t){if(this.neg!==t.neg)return(t.neg?1:0)-(this.neg?1:0);var r=0;if(this.buf.length!==t.buf.length)r=this.buf.length<t.buf.length?-1:1;else if(0!==this.buf.length){for(var e=t.buf.length-1;e>=0&&this.buf[e]===t.buf[e];)e--;r=e<0?0:this.buf[e]<t.buf[e]?-1:1}return this.neg?0===r?0:-r:r},Object.defineProperty(t.prototype,"sign",{get:function(){return 0===this.buf.length?0:this.neg?-1:1},enumerable:!1,configurable:!0}),t}();function qt(t){for(var r=[],e=0;e<t.length;e+=2){var n=parseInt(t.slice(e,e+2),16);if(Number.isNaN(n))return null;r.push(n)}return r}function Yt(t,r){if(t.length!==r.length)return t.length<r.length?-1:1;if(0!==t.length){for(var e=0;e<t.length&&t[e]===r[e];)e++;return e===t.length?0:t[e]<r[e]?-1:1}return 0}function Qt(t){try{return new Wt(t),!0}catch(r){return!1}}function Jt(t){try{return new Wt(t).sign>=0}catch(r){return!1}}var Zt=/^(@%|@%%|%@|[@:%]([_0-9a-zA-Z][_0-9a-zA-Z\.%@]*)?)$/;function Xt(t,r){var e,n,i,a,o;if(Array.isArray(t))return{};if(void 0!==t.annots)try{for(var s=nt(t.annots),c=s.next();!c.done;c=s.next()){var u=c.value;if(0!==u.length){if(!Zt.test(u)||!(null==r?void 0:r.specialVar)&&("@%"===u||"@%%"===u)||!(null==r?void 0:r.specialFields)&&"%@"===u)throw new zt(t,t.prim+": unexpected annotation: "+u);switch(u[0]){case"%":((null==r?void 0:r.emptyFields)||u.length>1)&&(i=i||[]).push(u);break;case":":u.length>1&&(a=a||[]).push(u);break;case"@":((null==r?void 0:r.emptyVar)||u.length>1)&&(o=o||[]).push(u)}}}}catch(p){e={error:p}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return{f:i,t:a,v:o}}var $t={BlockHash:[32,[1,52]],OperationHash:[32,[5,116]],OperationListHash:[32,[133,233]],OperationListListHash:[32,[29,159,109]],ProtocolHash:[32,[2,170]],ContextHash:[32,[79,199]],ED25519PublicKeyHash:[20,[6,161,159]],SECP256K1PublicKeyHash:[20,[6,161,161]],P256PublicKeyHash:[20,[6,161,164]],ContractHash:[20,[2,90,121]],CryptoboxPublicKeyHash:[16,[153,103]],ED25519Seed:[32,[13,15,58,7]],ED25519PublicKey:[32,[13,15,37,217]],SECP256K1SecretKey:[32,[17,162,224,201]],P256SecretKey:[32,[16,81,238,189]],ED25519EncryptedSeed:[56,[7,90,60,179,41]],SECP256K1EncryptedSecretKey:[56,[9,237,241,174,150]],P256EncryptedSecretKey:[56,[9,48,57,115,171]],SECP256K1PublicKey:[33,[3,254,226,86]],P256PublicKey:[33,[3,178,139,127]],SECP256K1Scalar:[33,[38,248,136]],SECP256K1Element:[33,[5,92,0]],ED25519SecretKey:[64,[43,246,78,7]],ED25519Signature:[64,[9,245,205,134,18]],SECP256K1Signature:[64,[13,115,101,19,63]],P256Signature:[64,[54,240,44,52]],GenericSignature:[64,[4,130,43]],ChainID:[4,[87,82,0]]};function tr(t){for(var r,e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=Array.isArray(t)?t:Vt(t);try{for(var o=nt(n),s=o.next();!s.done;s=o.next()){var c=s.value,u=$t[c];if(a.length===u[0]+u[1].length){for(var p=0;p<u[1].length&&a[p]===u[1][p];)p++;if(p===u[1].length)return[c,a.slice(u[1].length)]}}}catch(l){r={error:l}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(r)throw r.error}}return null}var rr={ABS:!0,ADD:!0,ADDRESS:!0,AMOUNT:!0,AND:!0,APPLY:!0,BALANCE:!0,BLAKE2B:!0,CAR:!0,CDR:!0,CHAIN_ID:!0,CHECK_SIGNATURE:!0,COMPARE:!0,CONCAT:!0,CONS:!0,EDIV:!0,EQ:!0,EXEC:!0,FAILWITH:!0,GE:!0,GET_AND_UPDATE:!0,GT:!0,HASH_KEY:!0,IMPLICIT_ACCOUNT:!0,INT:!0,ISNAT:!0,JOIN_TICKETS:!0,KECCAK:!0,LE:!0,LEVEL:!0,LSL:!0,LSR:!0,LT:!0,MEM:!0,MUL:!0,NEG:!0,NEQ:!0,NEVER:!0,NOT:!0,NOW:!0,OR:!0,PACK:!0,PAIRING_CHECK:!0,READ_TICKET:!0,SAPLING_VERIFY_UPDATE:!0,SELF:!0,SELF_ADDRESS:!0,SENDER:!0,SET_DELEGATE:!0,SHA256:!0,SHA3:!0,SHA512:!0,SIZE:!0,SLICE:!0,SOME:!0,SOURCE:!0,SPLIT_TICKET:!0,SUB:!0,SWAP:!0,TICKET:!0,TOTAL_VOTING_POWER:!0,TRANSFER_TOKENS:!0,UNIT:!0,VOTING_POWER:!0,XOR:!0,RENAME:!0},er=Object.assign({},rr,{CONTRACT:!0,CREATE_CONTRACT:!0,DIG:!0,DIP:!0,DROP:!0,DUG:!0,DUP:!0,EMPTY_BIG_MAP:!0,EMPTY_MAP:!0,EMPTY_SET:!0,GET:!0,IF:!0,IF_CONS:!0,IF_LEFT:!0,IF_NONE:!0,ITER:!0,LAMBDA:!0,LEFT:!0,LOOP:!0,LOOP_LEFT:!0,MAP:!0,NIL:!0,NONE:!0,PAIR:!0,PUSH:!0,RIGHT:!0,SAPLING_EMPTY_STATE:!0,UNPACK:!0,UNPAIR:!0,UPDATE:!0,CAST:!0}),nr={unit:!0,never:!0,bool:!0,int:!0,nat:!0,string:!0,chain_id:!0,bytes:!0,mutez:!0,key_hash:!0,key:!0,signature:!0,timestamp:!0,address:!0},ir=Object.assign({},nr,{or:!0,pair:!0,set:!0,big_map:!0,contract:!0,lambda:!0,list:!0,map:!0,operation:!0,option:!0,bls12_381_g1:!0,bls12_381_g2:!0,bls12_381_fr:!0,sapling_transaction:!0,sapling_state:!0,ticket:!0}),ar=function(t){function r(e,n){var i=t.call(this,e,n)||this;return i.val=e,Object.setPrototypeOf(i,r.prototype),i}return tt(r,t),r}(zt);function or(t){return"prim"in t}function sr(t){if(or(t))return!0;throw new ar(t,"prim expression expected")}function cr(t){if(Array.isArray(t))return!0;throw new ar(t,"sequence expression expected")}function ur(t){if(function(t){return Array.isArray(t)||"prim"in t}(t))return!0;throw new ar(t,"prim or sequence expression expected")}function pr(t){if("-"===t.int[0])throw new ar(t,"natural number expected")}function lr(t){if("int"in t)return!0;throw new ar(t,"int literal expected")}function hr(t,r){var e;if(0===r&&void 0===t.args||(null===(e=t.args)||void 0===e?void 0:e.length)===r)return!0;throw new ar(t,r+" arguments expected")}function fr(t){var r,e,n,i;if(Array.isArray(t)){try{for(var a=nt(t),o=a.next();!o.done;o=a.next()){var s=o.value;if(!Array.isArray(s)&&!or(s))throw new ar(t,"sequence or prim expected");fr(s)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(r)throw r.error}}return!0}if(sr(t)){if(Object.prototype.hasOwnProperty.call(rr,t.prim))return hr(t,0),!0;switch(t.prim){case"DROP":case"PAIR":case"UNPAIR":case"DUP":case"UPDATE":case"GET":void 0!==t.args&&hr(t,1)&&lr(t.args[0])&&pr(t.args[0]);break;case"DIG":case"DUG":case"SAPLING_EMPTY_STATE":hr(t,1)&&lr(t.args[0])&&pr(t.args[0]);break;case"NONE":case"LEFT":case"RIGHT":case"NIL":case"CAST":hr(t,1)&&Er(t.args[0]);break;case"UNPACK":hr(t,1)&&dr(t.args[0]);break;case"CONTRACT":hr(t,1)&&yr(t.args[0]);break;case"IF_NONE":case"IF_LEFT":case"IF_CONS":case"IF":hr(t,2)&&(cr(t.args[0])&&fr(t.args[0]),cr(t.args[1])&&fr(t.args[1]));break;case"MAP":case"ITER":case"LOOP":case"LOOP_LEFT":hr(t,1)&&fr(t.args[0]);break;case"CREATE_CONTRACT":hr(t,1)&&Ar(t.args[0]);break;case"DIP":if(2===(null===(n=t.args)||void 0===n?void 0:n.length))lr(t.args[0])&&pr(t.args[0]),cr(t.args[1])&&fr(t.args[1]);else{if(1!==(null===(i=t.args)||void 0===i?void 0:i.length))throw new ar(t,"1 or 2 arguments expected");cr(t.args[0])&&fr(t.args[0])}break;case"PUSH":hr(t,2)&&(gr(t.args[0]),Or(t.args[1]));break;case"EMPTY_SET":hr(t,1)&&mr(t.args[0]);break;case"EMPTY_MAP":hr(t,2)&&(mr(t.args[0]),Er(t.args[1]));break;case"EMPTY_BIG_MAP":hr(t,2)&&(mr(t.args[0]),br(t.args[1]));break;case"LAMBDA":hr(t,3)&&(Er(t.args[0]),Er(t.args[1]),cr(t.args[2])&&fr(t.args[2]));break;default:throw new ar(t,"instruction expected")}}return!0}function mr(t){if(ur(t))if(Array.isArray(t)||"pair"===t.prim||"or"===t.prim||"option"===t.prim)wr(t,(function(t){return mr(t)}));else if(!Object.prototype.hasOwnProperty.call(nr,t.prim))throw new ar(t,t.prim+": type is not comparable");return!0}function dr(t){if(ur(t)&&or(t)){if(!Object.prototype.hasOwnProperty.call(ir,t.prim)||"big_map"===t.prim||"operation"===t.prim||"sapling_state"===t.prim||"ticket"===t.prim)throw new ar(t,t.prim+": type can't be used inside PACK/UNPACK instructions");wr(t,(function(t){return dr(t)}))}return!0}function gr(t){if(ur(t)&&or(t)){if(!Object.prototype.hasOwnProperty.call(ir,t.prim)||"big_map"===t.prim||"operation"===t.prim||"sapling_state"===t.prim||"ticket"===t.prim||"contract"===t.prim)throw new ar(t,t.prim+": type can't be pushed");wr(t,(function(t){return gr(t)}))}return!0}function vr(t){if(ur(t)&&or(t)){if(!Object.prototype.hasOwnProperty.call(ir,t.prim)||"operation"===t.prim||"contract"===t.prim)throw new ar(t,t.prim+": type can't be used as part of a storage");wr(t,(function(t){return vr(t)}))}return!0}function yr(t){if(ur(t)&&or(t)){if(!Object.prototype.hasOwnProperty.call(ir,t.prim)||"operation"===t.prim)throw new ar(t,t.prim+": type can't be used as part of a parameter");wr(t,(function(t){return yr(t)}))}return!0}function br(t){if(ur(t)&&or(t)){if(!Object.prototype.hasOwnProperty.call(ir,t.prim)||"big_map"===t.prim||"operation"===t.prim||"sapling_state"===t.prim)throw new ar(t,t.prim+": type can't be used inside a big_map");wr(t,(function(t){return br(t)}))}return!0}function Er(t){if(ur(t)&&or(t)){if(!Object.prototype.hasOwnProperty.call(ir,t.prim))throw new ar(t,"type expected");wr(t,(function(t){return Er(t)}))}return!0}function wr(t,r){if(Array.isArray(t)||"pair"===t.prim){var e=Array.isArray(t)?t:t.args;if(void 0===e||e.length<2)throw new ar(t,"at least 2 arguments expected");return e.forEach((function(t){ur(t)&&r(t)})),!0}switch(t.prim){case"option":case"list":hr(t,1)&&ur(t.args[0])&&r(t.args[0]);break;case"contract":hr(t,1)&&yr(t.args[0]);break;case"or":hr(t,2)&&ur(t.args[0])&&ur(t.args[1])&&(r(t.args[0]),r(t.args[1]));break;case"lambda":hr(t,2)&&(Er(t.args[0]),Er(t.args[1]));break;case"set":hr(t,1)&&mr(t.args[0]);break;case"map":hr(t,2)&&ur(t.args[0])&&ur(t.args[1])&&(mr(t.args[0]),r(t.args[1]));break;case"big_map":hr(t,2)&&ur(t.args[0])&&ur(t.args[1])&&(mr(t.args[0]),br(t.args[1]),r(t.args[1]));break;case"ticket":hr(t,1)&&ur(t.args[0])&&mr(t.args[0]);break;case"sapling_state":case"sapling_transaction":hr(t,1)&&lr(t.args[0]);break;default:hr(t,0)}return!0}function Or(t){var r,e,n,i;if("int"in t||"string"in t||"bytes"in t)return!0;if(Array.isArray(t)){var a=0;try{for(var o=nt(t),s=o.next();!s.done;s=o.next()){var c=s.value;or(c)&&"Elt"===c.prim?(hr(c,2)&&(Or(c.args[0]),Or(c.args[1])),a++):Or(c)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(r)throw r.error}}if(0!==a&&a!==t.length)throw new ar(t,"data entries and map elements can't be intermixed");return!0}if(!or(t))throw new ar(t,"data entry expected");switch(t.prim){case"Unit":case"True":case"False":case"None":hr(t,0);break;case"Pair":if(void 0===t.args||t.args.length<2)throw new ar(t,"at least 2 arguments expected");try{for(var u=nt(t.args),p=u.next();!p.done;p=u.next()){Or(p.value)}}catch(h){n={error:h}}finally{try{p&&!p.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}break;case"Left":case"Right":case"Some":hr(t,1)&&Or(t.args[0]);break;default:if(!Object.prototype.hasOwnProperty.call(er,t.prim))throw new ar(t,"data entry or instruction expected");fr(t)}return!0}function Ar(t){var r,e;if(cr(t)){var n={};try{for(var i=nt(t),a=i.next();!a.done;a=i.next()){var o=a.value;if(sr(o)){if("code"!==o.prim&&"parameter"!==o.prim&&"storage"!==o.prim)throw new ar(t,"unexpected contract section: "+o.prim);if(o.prim in n)throw new ar(t,"duplicate contract section: "+o.prim);if(n[o.prim]=!0,hr(o,1))switch(o.prim){case"code":cr(o.args[0])&&fr(o.args[0]);break;case"parameter":yr(o.args[0]);break;case"storage":vr(o.args[0])}}}}catch(s){r={error:s}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(r)throw r.error}}}return!0}var Pr=function(t){function r(e,n,i){var a=t.call(this,e,i)||this;return void 0!==n&&(a.data=n),Object.setPrototypeOf(a,r.prototype),a}return tt(r,t),r}(zt),Tr=function(t){function r(e,n,i){var a=t.call(this,e,i)||this;return a.stackState=n,Object.setPrototypeOf(a,r.prototype),a}return tt(r,t),r}(zt);function _r(t){return Array.isArray(t)?"pair":t.prim}function Ir(t){return"prim"in t?t.args:t}function Sr(t){return Array.isArray(t)||"pair"===t.prim}function Rr(t){return Array.isArray(t)||"prim"in t&&"Pair"===t.prim}function Nr(t,r){var e=r,n=Array.isArray(e)?e:e.args;return 2===n.length?"pair"===t?{prim:"pair",args:n}:{prim:"Pair",args:n}:rt(rt({},r),{args:[n[0],{prim:t,args:n.slice(1)}]})}function Dr(t,r,e){if(void 0===e&&(e=!1),_r(t)!==_r(r))throw new Pr(t,void 0,"types mismatch: "+_r(t)+" != "+_r(r));var n=[Xt(t),Xt(r)];if(n[0].t&&n[1].t&&n[0].t[0]!==n[1].t[0])throw new Pr(t,void 0,_r(t)+": type names mismatch: "+n[0].t[0]+" != "+n[1].t[0]);if(e&&n[0].f&&n[1].f&&n[0].f[0]!==n[1].f[0])throw new Pr(t,void 0,_r(t)+": field names mismatch: "+n[0].f[0]+" != "+n[1].f);if(Sr(t)){var i=Nr("pair",t),a=Nr("pair",r);return Dr(i.args[0],a.args[0],!0),void Dr(i.args[1],a.args[1],!0)}switch(t.prim){case"option":case"list":case"contract":case"set":case"ticket":Dr(t.args[0],r.args[0]);break;case"or":Dr(t.args[0],r.args[0],!0),Dr(t.args[1],r.args[1],!0);break;case"lambda":case"map":case"big_map":Dr(t.args[0],r.args[0]),Dr(t.args[1],r.args[1]);break;case"sapling_state":case"sapling_transaction":if(parseInt(t.args[0].int,10)!==parseInt(r.args[0].int,10))throw new Pr(t,void 0,_r(t)+": type argument mismatch: "+t.args[0].int+" != "+r.args[0].int)}}function kr(t,r){if(t.length!==r.length)throw new Pr(t,void 0,"stack length mismatch: "+t.length+" != "+r.length);for(var e=0;e<t.length;e++)Dr(t[e],r[e])}function xr(t,r){var e,n,i,a,o,s,c;if(void 0===r&&(r=!1),!Array.isArray(t)){var u=Xt(t);if(((null===(o=u.t)||void 0===o?void 0:o.length)||0)>1)throw new Pr(t,void 0,t.prim+": at most one type annotation allowed: "+t.annots);if(r){if(((null===(s=u.f)||void 0===s?void 0:s.length)||0)>1)throw new Pr(t,void 0,t.prim+": at most one field annotation allowed: "+t.annots)}else if(((null===(c=u.f)||void 0===c?void 0:c.length)||0)>0)throw new Pr(t,void 0,t.prim+": field annotations aren't allowed: "+t.annots)}if(Sr(t)){var p=Ir(t);try{for(var l=nt(p),h=l.next();!h.done;h=l.next()){xr(h.value,!0)}}catch(d){e={error:d}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}}else switch(t.prim){case"option":case"list":case"contract":case"set":xr(t.args[0]);break;case"or":try{for(var f=nt(t.args),m=f.next();!m.done;m=f.next()){xr(m.value,!0)}}catch(g){i={error:g}}finally{try{m&&!m.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}break;case"lambda":case"map":case"big_map":xr(t.args[0]),xr(t.args[1])}}var Cr=/^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])[T ]([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\.[0-9]+)?(Z|[+-]([01][0-9]|2[0-3]):([0-5][0-9]))$/;function Ur(t){if("string"in t){if(Jt(t.string))return new Date(parseInt(t.string,10));if(Cr.test(t.string)){var r=new Date(t.string);if(!Number.isNaN(r.valueOf))return r}}else if(Jt(t.int))return new Date(parseInt(t.int,10));return null}function Lr(t,r,e){if(Sr(t)){if(Rr(r)&&Rr(e)){var n=Nr("pair",t),i=Nr("Pair",r),a=Nr("Pair",e);return 0!==(c=Lr(n.args[0],i.args[0],a.args[0]))?c:Lr(n.args[0],i.args[1],a.args[1])}}else switch(t.prim){case"int":case"nat":case"mutez":if("int"in r&&"int"in e)return new Wt(r.int).cmp(new Wt(e.int));break;case"string":if("string"in r&&"string"in e)return(c=r.string.localeCompare(e.string))<0?-1:c>0?1:0;break;case"bytes":if("bytes"in r&&"bytes"in e){var o=qt(r.bytes),s=qt(e.bytes);if(null!==o&&null!==s)return Yt(o,s)}break;case"bool":if("prim"in r&&"prim"in e&&("True"===r.prim||"False"===r.prim)&&("True"===e.prim||"False"===e.prim))return r.prim===e.prim?0:"False"===r.prim?-1:1;break;case"key":case"key_hash":case"address":case"signature":if("string"in r&&"string"in e)return Yt(Vt(r.string),Vt(e.string));break;case"chain_id":if(("string"in r||"bytes"in r)&&("string"in e||"bytes"in e))return Yt("string"in r?Vt(r.string):qt(r.bytes)||[],"string"in e?Vt(e.string):qt(e.bytes)||[]);break;case"timestamp":if(("string"in r||"int"in r)&&("string"in e||"int"in e)){var c;o=Ur(r),s=Ur(e);if(null!==o&&null!==s)return(c=o.valueOf()-s.valueOf())<0?-1:c>0?1:0}break;case"unit":if("prim"in r&&"prim"in e&&"Unit"===r.prim&&"Unit"===e.prim)return 0}throw new Pr(t,void 0,_r(t)+": not comparable values: "+JSON.stringify(r)+", "+JSON.stringify(e))}function jr(t){return Object.prototype.hasOwnProperty.call(er,t.prim)}function Mr(t){var r,e;if(!Array.isArray(t))return!1;try{for(var n=nt(t),i=n.next();!i.done;i=n.next()){var a=i.value;if(!(Array.isArray(a)&&Mr(a)||"prim"in a&&jr(a)))return!1}}catch(o){r={error:o}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(r)throw r.error}}return!0}function Gr(t,r,e){var n,i,a,o,s=function(t){var e,n;if(!Array.isArray(t))return!1;try{for(var i=nt(t),a=i.next();!a.done;a=i.next()){var o=a.value;if("prim"in o){if(jr(o))throw new Pr(r,t,"Instruction outside of a lambda: "+JSON.stringify(t));if("Elt"===o.prim)throw new Pr(r,t,"Elt item outside of a map literal: "+JSON.stringify(t))}}}catch(s){e={error:s}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return!0};if(Sr(r)){if(Rr(t)){Array.isArray(t)&&s(t);var c=Nr("Pair",t),u=Nr("pair",r);return Gr(c.args[0],u.args[0],e),void Gr(c.args[1],u.args[1],e)}throw new Pr(r,t,"pair expected: "+JSON.stringify(t))}switch(r.prim){case"int":if("int"in t&&Qt(t.int))return;throw new Pr(r,t,"integer value expected: "+JSON.stringify(t));case"nat":case"mutez":if("int"in t&&Jt(t.int))return;throw new Pr(r,t,"natural value expected: "+JSON.stringify(t));case"string":if("string"in t)return;throw new Pr(r,t,"string value expected: "+JSON.stringify(t));case"bytes":case"bls12_381_g1":case"bls12_381_g2":if("bytes"in t&&null!==qt(t.bytes))return;throw new Pr(r,t,"bytes value expected: "+JSON.stringify(t));case"bool":if("prim"in t&&("True"===t.prim||"False"===t.prim))return;throw new Pr(r,t,"boolean value expected: "+JSON.stringify(t));case"key_hash":if("string"in t&&null!==tr(t.string,"ED25519PublicKeyHash","SECP256K1PublicKeyHash","P256PublicKeyHash"))return;throw new Pr(r,t,"key hash expected: "+JSON.stringify(t));case"timestamp":if(("string"in t||"int"in t)&&null!==Ur(t))return;throw new Pr(r,t,"timestamp expected: "+JSON.stringify(t));case"address":if("string"in t){var p=t.string,l=t.string.indexOf("%");if(l>=0&&(p=t.string.slice(0,l)),null!==tr(p,"ED25519PublicKeyHash","SECP256K1PublicKeyHash","P256PublicKeyHash","ContractHash"))return}throw new Pr(r,t,"address expected: "+JSON.stringify(t));case"key":if("string"in t&&null!==tr(t.string,"ED25519PublicKey","SECP256K1PublicKey","P256PublicKey"))return;throw new Pr(r,t,"public key expected: "+JSON.stringify(t));case"unit":if("prim"in t&&"Unit"===t.prim)return;throw new Pr(r,t,"unit value expected: "+JSON.stringify(t));case"signature":if("string"in t&&null!==tr(t.string,"ED25519Signature","SECP256K1Signature","P256Signature","GenericSignature"))return;throw new Pr(r,t,"signature expected: "+JSON.stringify(t));case"chain_id":if("bytes"in t||"string"in t){var h="string"in t?Vt(t.string):qt(t.bytes);if(null!==h&&h.length===$t.ChainID[0])return}throw new Pr(r,t,"chain id expected: "+JSON.stringify(t));case"operation":throw new Pr(r,t,"operation type can't be represented as a literal value");case"contract":throw new Pr(r,t,"contract type can't be represented as a literal value");case"option":if("prim"in t){if("None"===t.prim)return;if("Some"===t.prim)return void Gr(t.args[0],r.args[0],e)}throw new Pr(r,t,"option expected: "+JSON.stringify(t));case"list":case"set":if(s(t)){var f=void 0;try{for(var m=nt(t),d=m.next();!d.done;d=m.next()){if(Gr(b=d.value,r.args[0],e),"set"===r.prim)if(void 0===f)f=b;else if(Lr(r.args[0],f,b)>0)throw new Pr(r,t,"set elements must be ordered: "+JSON.stringify(t))}}catch(E){n={error:E}}finally{try{d&&!d.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}return}throw new Pr(r,t,r.prim+" expected: "+JSON.stringify(t));case"or":if("prim"in t){if("Left"===t.prim)return void Gr(t.args[0],r.args[0],e);if("Right"===t.prim)return void Gr(t.args[0],r.args[1],e)}throw new Pr(r,t,"union (or) expected: "+JSON.stringify(t));case"lambda":if(Mr(t)){var g=Fr(t,[r.args[0]],e);if("failed"in g)throw new Pr(r,t,"function is failed with error type: "+g.failed);if(1!==g.length)throw new Pr(r,t,"function must return a value");return void Dr(r.args[1],g[0])}throw new Pr(r,t,"function expected: "+JSON.stringify(t));case"map":case"big_map":if(Array.isArray(t)){f=void 0;try{for(var v=nt(t),y=v.next();!y.done;y=v.next()){var b;if(!("prim"in(b=y.value))||"Elt"!==b.prim)throw new Pr(r,t,"map elements expected: "+JSON.stringify(t));if(Gr(b.args[0],r.args[0],e),Gr(b.args[1],r.args[1],e),void 0===f)f=b;else if(Lr(r.args[0],f.args[0],b.args[0])>0)throw new Pr(r,t,"map elements must be ordered: "+JSON.stringify(t))}}catch(w){a={error:w}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(a)throw a.error}}return}throw new Pr(r,t,r.prim+" expected: "+JSON.stringify(t));case"bls12_381_fr":if("int"in t&&Qt(t.int)||"bytes"in t&&null!==qt(t.bytes))return;throw new Pr(r,t,"BLS12-381 element expected: "+JSON.stringify(t));case"sapling_state":if(Array.isArray(t))return;throw new Pr(r,t,"sapling state expected: "+JSON.stringify(t));case"ticket":return void Gr(t,{prim:"pair",args:[{prim:"address"},r.args[0],{prim:"nat"}]},e);default:throw new Pr(r,t,"unexpected type: "+_r(r))}}function Fr(t,r,e){var n=(null==e?void 0:e.protocol)||gt;if(Array.isArray(t))return function(t,r,e){var n,i,a=r,o=r,s=0;try{for(var c=nt(t),u=c.next();!u.done;u=c.next()){var p=Fr(u.value,o,e);if(a=p,"failed"in p)break;o=p,s++}}catch(h){n={error:h}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}if("failed"in a&&s!==t.length-1)throw new Tr(t,a,"FAIL must appear in a tail position");if(void 0!==(null==e?void 0:e.traceCallback)){var l={op:t,in:r,out:a};e.traceCallback(l)}return a}(t,r,e);var i=t;function a(t){for(var e,n,a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];if(r.length<a.length+t)throw new Tr(i,r,i.prim+": stack must have at least "+a.length+" element(s)");var s=t;try{for(var c=nt(a),u=c.next();!u.done;u=c.next()){var p=u.value;if(null!==p&&0!==p.length){for(var l=0;l<p.length&&p[l]!==_r(r[s]);)l++;if(l===p.length)throw new Tr(i,r,i.prim+": stack type mismatch: ["+s+"] expected to be "+p+", got "+_r(r[s])+" instead")}s++}}catch(h){e={error:h}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return r.slice(t,a.length+t)}function o(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return t.apply(void 0,at(e))}catch(a){throw a instanceof zt?new Tr(i,r,a.message):a}}}function s(t){return function(e){try{return t(e)}catch(n){throw n instanceof zt?new Tr(i,r,n.message):n}}}var c=o(Xt),u=o(kr),p=o(Dr),l=s(mr),h=s(dr),f=s(vr),m=s(gr),d=s(br);function g(t,e){var n=c(i,rt(rt({},e),{emptyFields:void 0!==t.f&&t.f>1,emptyVar:void 0!==t.v&&t.v>1})),a=function(t,e,n){if(t&&t.length>(e||0))throw new Tr(i,r,i.prim+": at most "+(e||0)+" "+n+" annotations allowed")};return a(n.f,t.f,"field"),a(n.t,t.t,"type"),a(n.v,t.v,"variable"),n}function v(t,r){var e=t,n=Array.isArray(e)?{prim:"pair",args:e}:e,i=c(n),a=void 0!==r.v||void 0!==r.t||void 0!==r.f?at((null===r.v?i.v:r.v)||[],(null===r.t?i.t:r.t)||[],(null===r.f?i.f:r.f)||[]):void 0;n.annots;var o=function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(e[n[i]]=t[n[i]])}return e}(n,["annots"]);return rt(rt({},o),a&&0!==a.length&&{annots:a})}function y(t,r){var e=g({v:1});return v(t,{v:void 0!==e.v?e.v:void 0!==r?[r]:null,t:null})}function b(t,e,n,a,o){var s,u,p,l,h=null===(s=c(e).f)||void 0===s?void 0:s[0],f=null===(u=n.f)||void 0===u?void 0:u[a];if(void 0!==f&&"%"!==f&&void 0!==h&&f!==h)throw new Tr(i,r,i.prim+": field names doesn't match: "+f+" !== "+h);var m=null===(p=n.v)||void 0===p?void 0:p[a],d=null===(l=c(t).v)||void 0===l?void 0:l[0];return v(e,{t:null,v:m?"@%"===m?h?["@"+h.slice(1)]:void 0:"@%%"===m?d?["@"+d.slice(1)+"."+(h?h.slice(1):o)]:h?["@"+h.slice(1)]:void 0:[m]:null})}function E(t,e,n){void 0===n&&(n=e);var a=Nr("pair",t);if(1===n)return[a.args[0]];if(2===n)return a.args;var o=a.args[1];if(Sr(o))return at([a.args[0]],E(o,e,n-1));throw new Tr(i,r,i.prim+": at least "+e+" fields are expected")}function w(t,e,n){if(void 0===n&&(n=e),0===n)return t;var a=Nr("pair",t);if(1===n)return a.args[0];var o=a.args[1];if(Sr(o))return w(o,e,n-2);if(2===n)return o;throw new Tr(i,r,i.prim+": at least "+(e+1)+" fields are expected")}function O(t,e,n,a){if(void 0===a&&(a=n),0===a)return e;var o=Nr("pair",t);if(1===a)return rt(rt({},o),{args:[e,o.args[1]]});var s=o.args[1];if(Sr(s))return rt(rt({},o),{args:[o.args[0],O(s,e,n,a-2)]});if(2===a)return rt(rt({},o),{args:[o.args[0],e]});throw new Tr(i,r,i.prim+": at least "+(n+1)+" fields are expected")}var A=function(t,r){return["@"+(t.v?t.v[0].slice(1)+".":"")+r]};function P(t,r){if(!("failed"in t)&&!("failed"in r))return u(t,r),t;if(!("failed"in t)||!("failed"in r))return"failed"in t?r:t;try{return Dr(t.failed,r.failed),t}catch(e){return{failed:{prim:"or",args:[t.failed,r.failed]}}}}var T=function(t){var i,o,s,T,_,I,S;switch(t.prim){case"DUP":if(0===(F=t.args?parseInt(t.args[0].int,10):1))throw new Tr(t,r,"DUP 0 is forbidden");var R=a(F-1,null)[0];if("ticket"===_r(R))throw new Tr(t,r,"ticket can't be DUPed");return at([R],r);case"SWAP":var N=a(0,null,null);return g({}),at([N[1],N[0]],r.slice(2));case"SOME":return at([v({prim:"option",args:[a(0,null)[0]]},g({t:1,v:1}))],r.slice(1));case"UNIT":return at([v({prim:"unit"},g({v:1,t:1}))],r);case"PAIR":if((F=t.args?parseInt(t.args[0].int,10):2)<2)throw new Tr(t,r,"PAIR "+F+" is forbidden");var D=a.apply(void 0,at([0],new Array(F).fill(null))),k=g({f:F,t:1,v:1},{specialFields:!0}),x=function(t){var r=t.lastIndexOf(".");return t.slice(r>0?r+1:1)},C=D.map((function(t,r){var e,n=c(t);return v(t,{v:null,t:null,f:k.f&&k.f.length>r&&"%"!==k.f[r]?"%@"===k.f[r]?n.v?["%"+x((null===(e=n.v)||void 0===e?void 0:e[0])||"")]:void 0:[k.f[r]]:void 0})}));return at([v({prim:"pair",args:C},{t:k.t,v:k.v})],r.slice(F));case"UNPAIR":if((F=t.args?parseInt(t.args[0].int,10):2)<2)throw new Tr(t,r,"UNPAIR "+F+" is forbidden");var U=a(0,["pair"])[0],L=g({f:2,v:2},{specialVar:!0});return at(E(U,F).map((function(t,r){return b(U,t,L,r,0===r?"car":"cdr")})),r.slice(1));case"CAR":case"CDR":var j=Nr("pair",a(0,["pair"])[0]);return at([b(j,j.args["CAR"===t.prim?0:1],W=g({f:1,v:1},{specialVar:!0}),0,t.prim.toLocaleLowerCase())],r.slice(1));case"CONS":var M=a(0,null,["list"]);return p(M[0],M[1].args[0]),at([y({prim:"list",args:[M[1].args[0]]})],r.slice(2));case"SIZE":return a(0,["string","list","set","map","bytes"]),at([y({prim:"nat"})],r.slice(1));case"MEM":var G=a(0,null,["set","map","big_map"]);return l(G[0]),p(G[0],G[1].args[0]),at([y({prim:"bool"})],r.slice(2));case"GET":if(t.args){var F=parseInt(t.args[0].int,10);return at([y(w(a(0,["pair"])[0],F))],r.slice(1))}var K=a(0,null,["map","big_map"]);return l(K[0]),p(K[0],K[1].args[0]),at([y({prim:"option",args:[K[1].args[1]]})],r.slice(2));case"UPDATE":if(t.args){F=parseInt(t.args[0].int,10);var H=a(0,null,["pair"]);return at([y(O(H[1],H[0],F))],r.slice(2))}var B=a(0,null,["bool","option"]);if(l(B[0]),"bool"===B[1].prim){var V=a(2,["set"]);return p(B[0],V[0].args[0]),at([y({prim:"set",args:[v(B[0],{t:null})]})],r.slice(3))}var z=a(2,["map","big_map"]);return p(B[0],z[0].args[0]),"map"===z[0].prim?at([y({prim:"map",args:[v(B[0],{t:null}),v(B[1].args[0],{t:null})]})],r.slice(3)):(d(B[1].args[0]),at([y({prim:"big_map",args:[v(B[0],{t:null}),v(B[1].args[0],{t:null})]})],r.slice(3)));case"GET_AND_UPDATE":var W=g({v:2}),q=a(0,null,["option"],["map","big_map"]);l(q[0]),p(q[0],q[2].args[0]),p(q[1].args[0],q[2].args[1]);var Y=null===(s=W.v)||void 0===s?void 0:s.map((function(t){return"@"!==t?[t]:void 0}));return"map"===q[2].prim?at([v({prim:"option",args:[q[2].args[1]]},{v:null==Y?void 0:Y[0]}),v({prim:"map",args:[v(q[0],{t:null}),v(q[1].args[0],{t:null})]},{v:null==Y?void 0:Y[1]})],r.slice(3)):(d(q[1].args[0]),at([v({prim:"option",args:[q[2].args[1]]},{v:null==Y?void 0:Y[0]}),v({prim:"big_map",args:[v(q[0],{t:null}),v(q[1].args[0],{t:null})]},{v:null==Y?void 0:Y[1]})],r.slice(3)));case"EXEC":var Q=a(0,null,["lambda"]);return p(Q[0],Q[1].args[0]),at([y(Q[1].args[1])],r.slice(2));case"APPLY":var J=a(0,null,["lambda"]);if(f(J[0]),m(J[0]),!Sr(J[1].args[0]))throw new Tr(t,r,t.prim+": function's argument must be a pair: "+_r(J[1].args[0]));var Z=J[1].args[0];return p(J[0],Ir(Z)[0]),at([y({prim:"lambda",args:[Ir(Z)[1],J[1].args[1]]})],r.slice(2));case"FAILWITH":var X=a(0,null)[0];return n===mt.PtEdo2Zk&&h(X),{failed:X};case"NEVER":return a(0,["never"]),{failed:{prim:"never"}};case"RENAME":return at([y(a(0,null)[0])],r.slice(1));case"CONCAT":if("list"===(B=a(0,["string","list","bytes"]))[0].prim){if("string"!==_r(B[0].args[0])&&"bytes"!==_r(B[0].args[0]))throw new Tr(t,r,t.prim+": can't concatenate list of "+_r(B[0].args[0])+"'s");return at([y(B[0].args[0])],r.slice(1))}z=a(1,["string","bytes"]);if(B[0].prim!==z[0].prim)throw new Tr(t,r,t.prim+": can't concatenate "+B[0].prim+" with "+z[0].prim);return at([y(z[0])],r.slice(2));case"SLICE":return at([y({prim:"option",args:[a(0,["nat"],["nat"],["string","bytes"])[2]]},"@slice")],r.slice(3));case"PACK":var $=a(0,null)[0];return h($),at([y({prim:"bytes"},"@packed")],r.slice(1));case"ADD":var tt=a(0,["nat","int","timestamp","mutez","bls12_381_g1","bls12_381_g2","bls12_381_fr"],["nat","int","timestamp","mutez","bls12_381_g1","bls12_381_g2","bls12_381_fr"]);if("nat"===tt[0].prim&&"int"===tt[1].prim||"int"===tt[0].prim&&"nat"===tt[1].prim)return at([y({prim:"int"})],r.slice(2));if("int"===tt[0].prim&&"timestamp"===tt[1].prim||"timestamp"===tt[0].prim&&"int"===tt[1].prim)return at([y({prim:"timestamp"})],r.slice(2));if(("int"===tt[0].prim||"nat"===tt[0].prim||"mutez"===tt[0].prim||"bls12_381_g1"===tt[0].prim||"bls12_381_g2"===tt[0].prim||"bls12_381_fr"===tt[0].prim)&&tt[0].prim===tt[1].prim)return at([y(tt[0])],r.slice(2));throw new Tr(t,r,t.prim+": can't add "+tt[0].prim+" to "+tt[1].prim);case"SUB":var et=a(0,["nat","int","timestamp","mutez"],["nat","int","timestamp","mutez"]);if(("nat"===et[0].prim||"int"===et[0].prim)&&("nat"===et[1].prim||"int"===et[1].prim)||"timestamp"===et[0].prim&&"timestamp"===et[1].prim)return at([y({prim:"int"})],r.slice(2));if("timestamp"===et[0].prim&&"int"===et[1].prim)return at([y({prim:"timestamp"})],r.slice(2));if("mutez"===et[0].prim&&"mutez"===et[1].prim)return at([y({prim:"mutez"})],r.slice(2));throw new Tr(t,r,t.prim+": can't subtract "+et[0].prim+" from "+et[1].prim);case"MUL":var nt=a(0,["nat","int","mutez","bls12_381_g1","bls12_381_g2","bls12_381_fr"],["nat","int","mutez","bls12_381_g1","bls12_381_g2","bls12_381_fr"]);if("nat"===nt[0].prim&&"int"===nt[1].prim||"int"===nt[0].prim&&"nat"===nt[1].prim)return at([y({prim:"int"})],r.slice(2));if("nat"===nt[0].prim&&"mutez"===nt[1].prim||"mutez"===nt[0].prim&&"nat"===nt[1].prim)return at([y({prim:"mutez"})],r.slice(2));if(("bls12_381_g1"===nt[0].prim||"bls12_381_g2"===nt[0].prim||"bls12_381_fr"===nt[0].prim)&&"bls12_381_fr"===nt[1].prim||("nat"===nt[0].prim||"int"===nt[0].prim)&&nt[0].prim===nt[1].prim)return at([y(nt[0])],r.slice(2));if(("nat"===nt[0].prim||"int"===nt[0].prim)&&"bls12_381_fr"===nt[1].prim||("nat"===nt[1].prim||"int"===nt[1].prim)&&"bls12_381_fr"===nt[0].prim)return at([y({prim:"bls12_381_fr"})],r.slice(2));throw new Tr(t,r,t.prim+": can't multiply "+nt[0].prim+" by "+nt[1].prim);case"EDIV":var it=function(t,r){return{prim:"option",args:[{prim:"pair",args:[{prim:t},{prim:r}]}]}},ot=a(0,["nat","int","mutez"],["nat","int","mutez"]);if("nat"===ot[0].prim&&"nat"===ot[1].prim)return at([y(it("nat","nat"))],r.slice(2));if(!("nat"!==ot[0].prim&&"int"!==ot[0].prim||"nat"!==ot[1].prim&&"int"!==ot[1].prim))return at([y(it("int","nat"))],r.slice(2));if("mutez"===ot[0].prim&&"nat"===ot[1].prim)return at([y(it("mutez","mutez"))],r.slice(2));if("mutez"===ot[0].prim&&"mutez"===ot[1].prim)return at([y(it("nat","mutez"))],r.slice(2));throw new Tr(t,r,t.prim+": can't euclideally divide "+ot[0].prim+" by "+ot[1].prim);case"ABS":return a(0,["int"]),at([y({prim:"nat"})],r.slice(1));case"ISNAT":return a(0,["int"]),at([y({prim:"option",args:[{prim:"nat"}]})],r.slice(1));case"INT":return a(0,["nat","bls12_381_fr"]),at([y({prim:"int"})],r.slice(1));case"NEG":var st=a(0,["nat","int","bls12_381_g1","bls12_381_g2","bls12_381_fr"])[0];return"nat"===st.prim||"int"===st.prim?at([y({prim:"int"})],r.slice(1)):at([y(st)],r.slice(1));case"LSL":case"LSR":return a(0,["nat"],["nat"]),at([y({prim:"nat"})],r.slice(2));case"OR":case"XOR":var ct=a(0,["nat","bool"],["nat","bool"]);if(ct[0].prim!==ct[1].prim)throw new Tr(t,r,t.prim+": both arguments must be of the same type: "+ct[0].prim+", "+ct[1].prim);return at([y(ct[1])],r.slice(2));case"AND":var ut=a(0,["nat","bool","int"],["nat","bool"]);if(("int"!==ut[0].prim||"nat"!==ut[1].prim)&&ut[0].prim!==ut[1].prim)throw new Tr(t,r,t.prim+": both arguments must be of the same type: "+ut[0].prim+", "+ut[1].prim);return at([y(ut[1])],r.slice(2));case"NOT":return"bool"===a(0,["nat","bool","int"])[0].prim?at([y({prim:"bool"})],r.slice(1)):at([y({prim:"int"})],r.slice(1));case"COMPARE":var pt=a(0,null,null);return l(pt[0]),l(pt[1]),at([y({prim:"int"})],r.slice(2));case"EQ":case"NEQ":case"LT":case"GT":case"LE":case"GE":return a(0,["int"]),at([y({prim:"bool"})],r.slice(1));case"SELF":if(void 0===(null==e?void 0:e.contract))throw new Tr(t,r,t.prim+": contract required");W=g({f:1,v:1});if(null===(wt=Br(e.contract,null===(T=W.f)||void 0===T?void 0:T[0])))throw new Tr(t,r,t.prim+": contract has no entrypoint "+wt);return at([v({prim:"contract",args:[wt]},{v:W.v?W.v:["@self"]})],r);case"TRANSFER_TOKENS":var lt=a(0,null,["mutez"],["contract"]);return p(lt[0],lt[2].args[0]),at([y({prim:"operation"})],r.slice(3));case"SET_DELEGATE":var ht=a(0,["option"])[0];if("key_hash"!==_r(ht.args[0]))throw new Tr(t,r,t.prim+": key hash expected: "+_r(ht.args[0]));return at([y({prim:"operation"})],r.slice(1));case"IMPLICIT_ACCOUNT":return a(0,["key_hash"]),at([y({prim:"contract",args:[{prim:"unit"}]})],r.slice(1));case"NOW":return at([y({prim:"timestamp"},"@now")],r);case"AMOUNT":return at([y({prim:"mutez"},"@amount")],r);case"BALANCE":return at([y({prim:"mutez"},"@balance")],r);case"CHECK_SIGNATURE":return a(0,["key"],["signature"],["bytes"]),at([y({prim:"bool"})],r.slice(3));case"BLAKE2B":case"SHA256":case"SHA512":case"KECCAK":case"SHA3":return a(0,["bytes"]),at([y({prim:"bytes"})],r.slice(1));case"HASH_KEY":return a(0,["key"]),at([y({prim:"key_hash"})],r.slice(1));case"SOURCE":return at([y({prim:"address"},"@source")],r);case"SENDER":return at([y({prim:"address"},"@sender")],r);case"ADDRESS":var ft=a(0,["contract"])[0];W=g({v:1});return at([v((i={prim:"address"},i[dt]=ft,i),{v:W.v?W.v:A(c(ft),"address")})],r.slice(1));case"SELF_ADDRESS":var gt={prim:"address"};return void 0!==(null==e?void 0:e.contract)&&(gt[dt]={prim:"contract",args:[Kr(e.contract,"parameter").args[0]]}),at([y(gt,"@address")],r);case"CHAIN_ID":return at([y({prim:"chain_id"})],r);case"DROP":return g({}),a((F=void 0!==t.args?parseInt(t.args[0].int,10):1)-1,null),r.slice(F);case"DIG":return g({}),at([a(F=parseInt(t.args[0].int,10),null)[0]],r.slice(0,F),r.slice(F+1));case"DUG":g({});F=parseInt(t.args[0].int,10);return at(r.slice(1,F+1),[a(0,null)[0]],r.slice(F+1));case"NONE":return xr(t.args[0]),at([v({prim:"option",args:[t.args[0]]},g({t:1,v:1}))],r);case"LEFT":case"RIGHT":var vt=a(0,null)[0],yt=(W=g({f:2,t:1,v:1},{specialFields:!0}),Y=c(vt),[v(vt,{t:null,v:null,f:W.f&&W.f.length>0&&"%"!==W.f[0]?"%@"===W.f[0]?Y.v?["%"+Y.v[0].slice(1)]:void 0:W.f:void 0}),v(t.args[0],{t:null,f:W.f&&W.f.length>1&&"%"!==W.f[1]?W.f:void 0})]);return at([v({prim:"or",args:"LEFT"===t.prim?yt:[yt[1],yt[0]]},{t:W.t,v:W.v})],r.slice(1));case"NIL":return xr(t.args[0]),at([v({prim:"list",args:[t.args[0]]},g({t:1,v:1}))],r);case"UNPACK":return a(0,["bytes"]),xr(t.args[0]),at([y({prim:"option",args:[t.args[0]]},"@unpacked")],r.slice(1));case"CONTRACT":var bt=a(0,["address"])[0];xr(t.args[0]);W=g({v:1,f:1});var Et=bt[dt];if(void 0!==Et){var wt;if(null===(wt=Br(Et,null===(_=W.f)||void 0===_?void 0:_[0])))throw new Tr(t,r,t.prim+": contract has no entrypoint "+wt);p(wt,t.args[0])}return at([v({prim:"option",args:[{prim:"contract",args:[t.args[0]]}]},{v:W.v?W.v:A(c(bt),"contract")})],r.slice(1));case"CAST":g({});var Ot=a(0,null)[0];return xr(t.args[0]),p(t.args[0],Ot),at([t.args[0]],r.slice(1));case"IF_NONE":g({});var At=a(0,["option"])[0],Pt=r.slice(1);return P(Fr(t.args[0],Pt,e),Fr(t.args[1],at([v(At.args[0],{t:null,v:A(c(At),"some")})],Pt),e));case"IF_LEFT":g({});var Tt=a(0,["or"])[0],_t=(Y=c(Tt),c(Tt.args[0])),It=c(Tt.args[1]);Pt=r.slice(1);return P(Fr(t.args[0],at([v(Tt.args[0],{t:null,v:A(Y,_t.f?_t.f[0].slice(1):"left")})],Pt),e),Fr(t.args[1],at([v(Tt.args[1],{t:null,v:A(Y,It.f?It.f[0].slice(1):"right")})],Pt),e));case"IF_CONS":g({});var St=a(0,["list"])[0];Y=c(St),Pt=r.slice(1);return P(Fr(t.args[0],at([v(St.args[0],{t:null,v:A(Y,"hd")}),v(St,{t:null,v:A(Y,"tl")})],Pt),e),Fr(t.args[1],Pt,e));case"IF":g({}),a(0,["bool"]);Pt=r.slice(1);return P(Fr(t.args[0],Pt,e),Fr(t.args[1],Pt,e));case"MAP":var Rt=a(0,["list","map"])[0],Nt=(Pt=r.slice(1),"map"===Rt.prim?{prim:"pair",args:Rt.args}:Rt.args[0]);if("failed"in(Ut=Fr(t.args[0],at([v(Nt,{t:null,v:A(c(Rt),"elt")})],Pt),e)))return Ut;if(Ut.length<1)throw new Tr(t,r,t.prim+": function must return a value");return u(Ut.slice(1),Pt),"list"===Rt.prim?at([y({prim:"list",args:[Ut[0]]})],Pt):at([y({prim:"map",args:[Rt.args[0],Ut[0]]})],Pt);case"ITER":g({});var Dt=a(0,["set","list","map"])[0];Pt=r.slice(1),Nt="map"===Dt.prim?{prim:"pair",args:Dt.args}:Dt.args[0];return"failed"in(Ut=Fr(t.args[0],at([v(Nt,{t:null,v:A(c(Dt),"elt")})],Pt),e))?Ut:(u(Ut,Pt),Pt);case"LOOP":g({}),a(0,["bool"]);Pt=r.slice(1);return"failed"in(Ut=Fr(t.args[0],Pt,e))?Ut:(u(Ut,at([{prim:"bool"}],Pt)),Pt);case"LOOP_LEFT":g({});var kt=a(0,["or"])[0];Pt=r.slice(1);return"failed"in(Ut=Fr(t.args[0],at([v(kt.args[0],{t:null,v:A(c(kt),"left")})],Pt),e))?Ut:(u(Ut,at([kt],Pt)),at([v(kt.args[1],{t:null,v:g({v:1}).v})],Pt));case"DIP":g({}),a((F=2===t.args.length?parseInt(t.args[0].int,10):1)-1,null);var xt=r.slice(0,F);Pt=r.slice(F);return"failed"in(Ut=2===t.args.length?Fr(t.args[1],Pt,e):Fr(t.args[0],Pt,e))?Ut:at(xt,Ut);case"CREATE_CONTRACT":W=g({v:2});var Ct=a(0,["option"],["mutez"],null);if("key_hash"!==_r(Ct[0].args[0]))throw new Tr(t,r,t.prim+": key hash expected: "+_r(Ct[0].args[0]));return f(Ct[2])&&(zr(t.args[0]),Dr(Kr(t.args[0],"storage").args[0],Ct[2])),at([v({prim:"operation"},{v:null==(Y=null===(I=W.v)||void 0===I?void 0:I.map((function(t){return"@"!==t?[t]:void 0})))?void 0:Y[0]}),v((o={prim:"address"},o[dt]={prim:"contract",args:[Kr(t.args[0],"parameter").args[0]]},o),{v:null==Y?void 0:Y[1]})],r.slice(3));case"PUSH":return xr(t.args[0]),Gr(t.args[1],t.args[0],rt(rt({},e),{contract:void 0})),at([y(t.args[0])],r);case"EMPTY_SET":return xr(t.args[0]),l(t.args[0]),at([v({prim:"set",args:t.args},g({t:1,v:1}))],r);case"EMPTY_MAP":return xr(t.args[0]),l(t.args[0]),xr(t.args[1]),at([v({prim:"map",args:t.args},g({t:1,v:1}))],r);case"EMPTY_BIG_MAP":return xr(t.args[0]),l(t.args[0]),xr(t.args[1]),d(t.args[0]),at([v({prim:"big_map",args:t.args},g({t:1,v:1}))],r);case"LAMBDA":var Ut;if(xr(t.args[0]),xr(t.args[1]),"failed"in(Ut=Fr(t.args[2],[t.args[0]],rt(rt({},e),{contract:void 0}))))return Ut;if(1!==Ut.length)throw new Tr(t,r,t.prim+": function must return a value");return p(t.args[1],Ut[0]),at([y({prim:"lambda",args:[t.args[0],t.args[1]]})],r);case"LEVEL":return at([y({prim:"nat"},"@level")],r);case"TOTAL_VOTING_POWER":return at([y({prim:"nat"})],r);case"VOTING_POWER":return a(0,["key_hash"]),at([y({prim:"nat"})],r.slice(1));case"TICKET":var Lt=a(0,null,["nat"])[0];return l(Lt),at([v({prim:"ticket",args:[Lt]},g({t:1,v:1}))],r.slice(2));case"JOIN_TICKETS":var jt=Nr("pair",a(0,["pair"])[0]);if("ticket"!==_r(jt.args[0]))throw new Tr(t,r,t.prim+": ticket expected: "+_r(jt.args[0]));return p(jt.args[0],jt.args[1]),at([y({prim:"option",args:[v(jt.args[0],{t:null})]})],r.slice(1));case"SPLIT_TICKET":var Mt=a(0,["ticket"],["pair"]);if("nat"!==_r((Ft=Nr("pair",Mt[1])).args[0]))throw new Tr(t,r,t.prim+": nat expected: "+_r(Ft.args[0]));return p(Ft.args[0],Ft.args[1]),at([y({prim:"option",args:[{prim:"pair",args:[v(Mt[0],{t:null}),v(Mt[0],{t:null})]}]})],r.slice(2));case"READ_TICKET":W=g({v:2});var Gt=a(0,["ticket"])[0];Y=null===(S=W.v)||void 0===S?void 0:S.map((function(t){return"@"!==t?[t]:void 0}));return at([v({prim:"pair",args:[{prim:"address"},v(Gt.args[0],{t:null}),{prim:"nat"}]},{v:null==Y?void 0:Y[0]}),v(Gt,{v:null==Y?void 0:Y[1],t:null})],r.slice(1));case"PAIRING_CHECK":var Ft;if(!Sr(Ft=a(0,["list"])[0].args[0]))throw new Tr(t,r,t.prim+": pair expected: "+_r(Ft));var Kt=Nr("pair",Ft);if("bls12_381_g1"!==_r(Kt.args[0]))throw new Tr(t,r,t.prim+": bls12_381_g1 expected: "+_r(Kt.args[0]));if("bls12_381_g2"!==_r(Kt.args[1]))throw new Tr(t,r,t.prim+": bls12_381_g2 expected: "+_r(Kt.args[1]));return at([y({prim:"bool"})],r.slice(1));case"SAPLING_EMPTY_STATE":return at([v({prim:"sapling_state",args:[t.args[0]]},g({v:1,t:1}))],r);case"SAPLING_VERIFY_UPDATE":var Ht=a(0,["sapling_transaction"],["sapling_state"]);if(parseInt(Ht[0].args[0].int,10)!==parseInt(Ht[1].args[0].int,10))throw new Tr(t,r,t.prim+": sapling memo size mismatch: "+Ht[0].args[0].int+" != "+Ht[1].args[0].int);return at([y({prim:"option",args:[{prim:"pair",args:[{prim:"int"},v(Ht[1],{t:null})]}]})],r.slice(2));default:throw new zt(t,"unexpected instruction: "+t.prim)}}(i);if(void 0!==(null==e?void 0:e.traceCallback)){var _={op:i,in:r,out:T};e.traceCallback(_)}return T}function Kr(t,r){var e,n;try{for(var i=nt(t),a=i.next();!a.done;a=i.next()){var o=a.value;if(o.prim===r)return o}}catch(s){e={error:s}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}throw new zt(t,"missing contract section: "+r)}function Hr(t){var r,e;if(Array.isArray(t))try{for(var n=nt(t),i=n.next();!i.done;i=n.next()){var a=i.value;if("prim"in a&&("parameter"===a.prim||"storage"===a.prim||"code"===a.prim))return!0}}catch(o){r={error:o}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(r)throw r.error}}return!1}function Br(t,r){r=r||"%default";var e=Vr(t).find((function(t){return t[0]===r}));return void 0!==e?e[1]:"%default"===r?Hr(t)?Kr(t,"parameter").args[0]:t:null}function Vr(t){if(Hr(t)){var r=Kr(t,"parameter"),e=Vr(r.args[0]),n=Xt(r);return n.f?at([[n.f[0],r.args[0]]],e):e}if(o=t,Array.isArray(o)||"or"===o.prim){var i=Ir(t),a=function(t){var r=Xt(i[t]);if("or"===_r(i[t])){var e=Vr(i[t]);return r.f?at([[r.f[0],i[t]]],e):e}return r.f?[[r.f[0],i[t]]]:[]};return at(a(0),a(1))}var o;return[]}function zr(t,r){var e=Kr(t,"parameter").args[0];xr(e,!0);var n=Kr(t,"storage").args[0];xr(n);var i={prim:"pair",args:[rt(rt({},e),{annots:["@parameter"]}),rt(rt({},n),{annots:["@storage"]})]},a=Kr(t,"code").args[0],o=Fr(a,[i],rt(rt({},r),{contract:t}));if("failed"in o)return o;var s={prim:"pair",args:[{prim:"list",args:[{prim:"operation"}]},n]};try{kr(o,[s])}catch(c){throw c instanceof zt?new Tr(a,o,c.message):c}return o}function Wr(t,r,e){xr(r),Gr(t,r,e||null)}new(function(){function t(t,r){this.contract=t,this.ctx=rt({contract:t},r),this.output=zr(t,this.ctx)}return t.parse=function(r,e){var n=new Mt(e),i="string"==typeof r?n.parseScript(r):n.parseJSON(r);if(null===i)throw new Error("empty contract");if(Ar(i))return new t(i,e)},t.parseTypeExpression=function(t){var r=new Mt({expandMacros:!0}),e="string"==typeof t?r.parseScript(t):r.parseJSON(t);if(null===e)throw new Error("empty type expression");if(Er(e)&&xr(e))return e;throw void 0},t.parseDataExpression=function(t){var r=new Mt({expandMacros:!0}),e="string"==typeof t?r.parseScript(t):r.parseJSON(t);if(null===e)throw new Error("empty data expression");if(Or(e))return e;throw void 0},t.prototype.section=function(t){return Kr(this.contract,t)},t.prototype.entryPoints=function(){return Vr(this.contract)},t.prototype.entryPoint=function(t){return Br(this.contract,t)},t.prototype.assertDataValid=function(t,r){Wr(t,r,this.ctx)},t.prototype.isDataValid=function(t,r){return function(t,r,e){try{return Wr(t,r,e),!0}catch(n){return!1}}(t,r,this.ctx)},t.prototype.assertParameterValid=function(t,r){var e=this.entryPoint(t||void 0);if(null===e)throw new Error("contract has no entrypoint named "+t);this.assertDataValid(r,e)},t.prototype.isParameterValid=function(t,r){try{return this.assertParameterValid(t,r),!0}catch(e){return!1}},t.prototype.functionType=function(t,r){return function(t,r,e){var n,i,a,o;try{for(var s=nt(r),c=s.next();!c.done;c=s.next())xr(c.value)}catch(h){n={error:h}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}if(void 0!==(null==e?void 0:e.contract))try{for(var u=nt(["parameter","storage"]),p=u.next();!p.done;p=u.next()){var l=p.value;xr(Kr(e.contract,l).args[0])}}catch(f){a={error:f}}finally{try{p&&!p.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}return Fr(t,r,e||null)}(t,r,this.ctx)},t}())([{prim:"parameter",args:[{prim:"unit"}]},{prim:"storage",args:[{prim:"unit"}]},{prim:"code",args:[[{prim:"CAR"},{prim:"NIL",args:[{prim:"operation"}]},{prim:"PAIR"}]]}]);var qr=function(t,r){return(qr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(t,r)};function Yr(t,r){function e(){this.constructor=t}qr(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}var Qr=function(){return(Qr=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var i in r=arguments[e])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};function Jr(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(e[n[i]]=t[n[i]])}return e}function Zr(t,r,e,n){return new(e||(e=Promise))((function(i,a){function o(t){try{c(n.next(t))}catch(r){a(r)}}function s(t){try{c(n.throw(t))}catch(r){a(r)}}function c(t){var r;t.done?i(t.value):(r=t.value,r instanceof e?r:new e((function(t){t(r)}))).then(o,s)}c((n=n.apply(t,r||[])).next())}))}function Xr(t,r){var e,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=r.call(t,o)}catch(s){a=[6,s],n=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function $r(t){var r="function"==typeof Symbol&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function te(t,r){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var n,i,a=e.call(t),o=[];try{for(;(void 0===r||r-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(e=a.return)&&e.call(a)}finally{if(i)throw i.error}}return o}function re(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(te(arguments[r]));return t}var ee,ne,ie,ae,oe=function(){function t(t){this.context=t}return t.prototype.forge=function(t){var r=t.branch,e=t.contents;return this.context.rpc.forgeOperations({branch:r,contents:e})},t}(),se=function(){function t(t){this.context=t}return t.prototype.inject=function(t){return this.context.rpc.injectOperation(t)},t}(),ce=function(){this.name="UnconfiguredSignerError",this.message="No signer has been configured. Please configure one by calling setProvider({signer}) on your TezosToolkit instance."},ue=function(){function t(){}return t.prototype.publicKey=function(){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){throw new ce}))}))},t.prototype.publicKeyHash=function(){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){throw new ce}))}))},t.prototype.secretKey=function(){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){throw new ce}))}))},t.prototype.sign=function(t,r){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){throw new ce}))}))},t}(),pe=function(t,r){return Qr(Qr({},t),{kind:r})},le=function(t,r){if(Array.isArray(t)){var e=t.find((function(t){return t.kind===r}));if(e&&he(e,r))return e}},he=function(t,r){return t.kind===r},fe=function(t){return-1!==["transaction","delegation","origination","reveal"].indexOf(t.kind)},me=function(t){return"metadata"in t},de=function(t){return me(t)&&"operation_result"in t.metadata},ge=function(t){this.errors=t,this.name="TezosOperationError";var r=t[t.length-1];this.id=r.id,this.kind=r.kind,this.message="("+this.kind+") "+this.id,"with"in r&&r.with.string&&(this.message=r.with.string)},ve=function(t){this.result=t,this.name="TezosPreapplyFailureError",this.message="Preapply returned an unexpected result"},ye=function(t){for(var r=Array.isArray(t)?t:[t],e=[],n=0;n<r.length;n++)for(var i=0;i<r[n].contents.length;i++){var a=r[n].contents[i];de(a)&&(e.push(Qr({fee:a.fee},a.metadata.operation_result)),Array.isArray(a.metadata.internal_operation_results)&&a.metadata.internal_operation_results.forEach((function(t){return e.push(t.result)})))}return e},be=function(t,r){var e,n;void 0===r&&(r="failed");for(var i,a=Array.isArray(t)?t:[t],o=[],s=0;s<a.length;s++)for(var c=0;c<a[s].contents.length;c++){var u=a[s].contents[c];if(me(u)&&(de(u)&&u.metadata.operation_result.status===r&&(o=o.concat(u.metadata.operation_result.errors||[])),me(i=u)&&"internal_operation_results"in i.metadata&&Array.isArray(u.metadata.internal_operation_results)))try{for(var p=(e=void 0,$r(u.metadata.internal_operation_results)),l=p.next();!l.done;l=p.next()){var h=l.value;"result"in h&&h.result.status===r&&(o=o.concat(h.result.errors||[]))}}catch(f){e={error:f}}finally{try{l&&!l.done&&(n=p.return)&&n.call(p)}finally{if(e)throw e.error}}}return o},Ee=function(t,r){var e=void 0===r?{ALLOCATION_BURN:257,ORIGINATION_BURN:257}:r,n=e.ALLOCATION_BURN,i=e.ORIGINATION_BURN,a=ye({contents:t}),o=new Q.a(0),s=new Q.a(0),c=new Q.a(0),u=new Q.a(0),p=new Q.a(0),l=new Q.a(0);return a.forEach((function(t){c=c.plus(t.fee||0),u=u.plus(Array.isArray(t.originated_contracts)?t.originated_contracts.length*i:0),p=p.plus("allocated_destination_contract"in t?n:0),o=o.plus(t.consumed_gas||0),l=l.plus("paid_storage_size_diff"in t&&Number(t.paid_storage_size_diff)||0)})),s=s.plus(p).plus(u).plus(l),{totalFee:c,totalGas:o,totalStorage:s,totalAllocationBurn:p,totalOriginationBurn:u,totalPaidStorageDiff:l,totalStorageBurn:new Q.a(s.multipliedBy(1e3))}},we=function(){this.name="MissedBlockDuringConfirmationError",this.message="Taquito missed a block while waiting for operation confirmation and was not able to find the operation"},Oe=function(){function t(t,r,e){var n=this;this.opHash=t,this.context=r,this._newHead$=e,this._operationResult=new g.a(1),this._includedInBlock=new g.a(1),this._included=!1,this.newHead$=this._newHead$.pipe(Object(S.a)((function(t){if(!n._included&&n.lastHead&&t.header.level-n.lastHead.header.level>1)throw new we;n.lastHead=t})),Object(R.a)({bufferSize:1,refCount:!0})),this.confirmed$=this.newHead$.pipe(Object(N.a)((function(t){var r,e,i,a;try{for(var o=$r(t.operations),s=o.next();!s.done;s=o.next()){var c=s.value;try{for(var u=(i=void 0,$r(c)),p=u.next();!p.done;p=u.next()){var l=p.value;if(l.hash===n.opHash)return n._included=!0,n._includedInBlock.next(t),n._operationResult.next(l.contents),t}}catch(h){i={error:h}}finally{try{p&&!p.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}}}catch(f){r={error:f}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(r)throw r.error}}})),Object(D.a)((function(t){return void 0!==t})),Object(k.a)(),Object(R.a)({bufferSize:1,refCount:!0})),this.confirmed$.pipe(Object(k.a)()).subscribe()}return t.prototype.operationResults=function(){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){return[2,this._operationResult.pipe(Object(k.a)()).toPromise()]}))}))},t.prototype.receipt=function(){return Zr(this,void 0,void 0,(function(){var t;return Xr(this,(function(r){switch(r.label){case 0:return t=Ee,[4,this.operationResults()];case 1:return[2,t.apply(void 0,[r.sent()])]}}))}))},t.prototype.getCurrentConfirmation=function(){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){return this._included?[2,Object(v.a)([this._includedInBlock,Object(y.a)(this.context.rpc.getBlock())]).pipe(Object(N.a)((function(t){var r=te(t,2),e=r[0];return r[1].header.level-e.header.level+1})),Object(k.a)()).toPromise()]:[2,0]}))}))},t.prototype.isInCurrentBranch=function(t){return void 0===t&&(t="head"),Zr(this,void 0,void 0,(function(){var r,e,n,i,a;return Xr(this,(function(o){switch(o.label){case 0:return this._included?[4,this.context.rpc.getBlockHeader({block:t})]:[2,!0];case 1:return r=o.sent(),[4,this._includedInBlock.pipe(Object(k.a)()).toPromise()];case 2:return e=o.sent(),(n=r.level-e.header.level)<=0?[2,!0]:(i=Math.min(e.header.level+n,e.header.level+60),a=Set.bind,[4,this.context.rpc.getLiveBlocks({block:String(i)})]);case 3:return[2,(new(a.apply(Set,[void 0,o.sent()]))).has(e.hash)]}}))}))},t.prototype.confirmationObservable=function(t){var r=this;if(void 0!==t&&t<1)throw new Error("Confirmation count must be at least 1");var e=this.context.config.defaultConfirmationCount,n=void 0!==t?t:e;return Object(v.a)([this._includedInBlock,this.newHead$]).pipe(Object(x.a)((function(t,r){var e=te(t,2)[1],n=te(r,2)[1];return e.hash===n.hash})),Object(N.a)((function(t){var e=te(t,2),i=e[0],a=e[1];return{block:a,expectedConfirmation:n,currentConfirmation:a.header.level-i.header.level+1,completed:a.header.level-i.header.level>=n-1,isInCurrentBranch:function(){return r.isInCurrentBranch(a.hash)}}})),Object(C.a)((function(t){return!t.completed}),!0))},t.prototype.confirmation=function(t){return this.confirmationObservable(t).toPromise()},t}(),Ae=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.opHash=r,i.context=e,i}return Yr(r,t),r.prototype.revealOperation=function(){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){switch(t.label){case 0:return[4,this.operationResults()];case 1:return[2,t.sent().find((function(t){return t.kind===p.REVEAL}))]}}))}))},r.prototype.delegationOperation=function(){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){switch(t.label){case 0:return[4,this.operationResults()];case 1:return[2,t.sent().find((function(t){return t.kind===p.DELEGATION}))]}}))}))},r.prototype.status=function(){return Zr(this,void 0,void 0,(function(){var t;return Xr(this,(function(r){switch(r.label){case 0:return this._included?[4,this.delegationOperation()]:[2,"pending"];case 1:return(t=r.sent())?[2,t.metadata.operation_result.status]:[2,"unknown"]}}))}))},r}(Oe),Pe=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.opHash=r,i.context=e,i}return Yr(r,t),r.prototype.originationOperation=function(){return Zr(this,void 0,void 0,(function(){var t;return Xr(this,(function(r){switch(r.label){case 0:return[4,this.operationResults()];case 1:return t=r.sent(),[2,le(t,p.ORIGINATION)]}}))}))},r.prototype.revealOperation=function(){return Zr(this,void 0,void 0,(function(){var t;return Xr(this,(function(r){switch(r.label){case 0:return[4,this.operationResults()];case 1:return t=r.sent(),[2,le(t,p.REVEAL)]}}))}))},r.prototype.status=function(){return Zr(this,void 0,void 0,(function(){var t;return Xr(this,(function(r){switch(r.label){case 0:return this._included?[4,this.originationOperation()]:[2,"pending"];case 1:return(t=r.sent())?[2,t.metadata.operation_result.status]:[2,"unknown"]}}))}))},r.prototype.contract=function(){return Zr(this,void 0,void 0,(function(){var t,r;return Xr(this,(function(e){switch(e.label){case 0:return[4,this.originationOperation()];case 1:return t=e.sent(),r=(t.metadata.operation_result.originated_contracts||[])[0],[2,this.context.wallet.at(r)]}}))}))},r}(Oe),Te=function(t){function r(r,e,n){var i=t.call(this,r,e,n)||this;return i.opHash=r,i.context=e,i}return Yr(r,t),r.prototype.revealOperation=function(){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){switch(t.label){case 0:return[4,this.operationResults()];case 1:return[2,t.sent().find((function(t){return t.kind===p.REVEAL}))]}}))}))},r.prototype.transactionOperation=function(){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){switch(t.label){case 0:return[4,this.operationResults()];case 1:return[2,t.sent().find((function(t){return t.kind===p.TRANSACTION}))]}}))}))},r.prototype.status=function(){return Zr(this,void 0,void 0,(function(){var t;return Xr(this,(function(r){switch(r.label){case 0:return this._included?[4,this.transactionOperation()]:[2,"pending"];case 1:return(t=r.sent())?[2,t.metadata.operation_result.status]:[2,"unknown"]}}))}))},r}(Oe),_e=function(){function t(t){var r,e=this;this.context=t,this.sharedHeadObs=Object(b.a)((function(){return Object(y.a)(e.context.rpc.getBlock())})).pipe((r=Object(w.a)(0,1e3),function(t){var e=null;return Object(b.a)((function(){return e||(e=new g.a,t.pipe(Object(k.a)()).subscribe(e),r.pipe(Object(k.a)()).subscribe((function(){e=null}))),e}))}))}return t.prototype.createNewHeadObservable=function(){return t=Object(w.a)(0,1e3*this.context.config.confirmationPollingIntervalSecond),r=this.sharedHeadObs,e=this.context,t.pipe(Object(U.a)((function(){return r})),Object(L.a)("hash"),Object(j.a)(1e3*e.config.confirmationPollingTimeoutSecond,Object(E.a)(new Error("Confirmation polling timed out")),n),Object(R.a)({refCount:!0,scheduler:n}));var t,r,e,n},t.prototype.createPastBlockWalker=function(t,r){var e=this;return void 0===r&&(r=1),Object(y.a)(this.context.rpc.getBlock({block:t})).pipe(Object(U.a)((function(t){return 1===r?Object(O.a)(t):Object(A.a)(t.header.level,r-1).pipe(Object(M.a)(t),Object(G.a)((function(t){return Zr(e,void 0,void 0,(function(){return Xr(this,(function(r){return[2,this.context.rpc.getBlock({block:String(t)})]}))}))})))})))},t.prototype.createHeadObservableFromConfig=function(t){var r=t.blockIdentifier,e=[];return r&&e.push(this.createPastBlockWalker(r)),e.push(this.createNewHeadObservable()),P.a.apply(void 0,re(e))},t.prototype.createOperation=function(t,r){return void 0===r&&(r={}),new Oe(t,this.context.clone(),this.createHeadObservableFromConfig(r))},t.prototype.createTransactionOperation=function(t,r){return void 0===r&&(r={}),new Te(t,this.context.clone(),this.createHeadObservableFromConfig(r))},t.prototype.createDelegationOperation=function(t,r){return void 0===r&&(r={}),new Ae(t,this.context.clone(),this.createHeadObservableFromConfig(r))},t.prototype.createOriginationOperation=function(t,r){return void 0===r&&(r={}),new Pe(t,this.context.clone(),this.createHeadObservableFromConfig(r))},t}();!function(t){t[t.DELEGATION=10600]="DELEGATION",t[t.ORIGINATION=10600]="ORIGINATION",t[t.TRANSFER=10600]="TRANSFER",t[t.REVEAL=10600]="REVEAL"}(ee||(ee={})),function(t){t[t.DELEGATION=1257]="DELEGATION",t[t.ORIGINATION=1e4]="ORIGINATION",t[t.TRANSFER=1e4]="TRANSFER",t[t.REVEAL=1420]="REVEAL"}(ne||(ne={})),function(t){t[t.DELEGATION=0]="DELEGATION",t[t.ORIGINATION=257]="ORIGINATION",t[t.TRANSFER=257]="TRANSFER",t[t.REVEAL=0]="REVEAL"}(ie||(ie={})),function(t){t.Pt24m4xi="Pt24m4xiPbLDhVgVfABUjirbmda3yohdN82Sp9FeuAXJ4eV9otd",t.PsBABY5H="PsBABY5HQTSkA4297zNHfsZNKtxULfL18y95qb3m53QJiXGmrbU",t.PsBabyM1="PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS",t.PsCARTHA="PsCARTHAGazKbHtnKfLzQg3kms52kSRpgnDY982a9oYsSXRLQEb",t.PsDELPH1="PsDELPH1Kxsxt8f9eWbxQeRxkjfbxoqM52jvs5Y5fBxWWh4ifpo",t.PtEdo2Zk="PtEdo2ZkT9oKpimTah6x2embF25oss54njMuPzkJTEi5RqfdZFA"}(ae||(ae={}));var Ie,Se;ae.Pt24m4xi,ae.PsBABY5H,ae.PsBabyM1,ae.PsCARTHA,ae.PsDELPH1,ae.PtEdo2Zk;!function(t){t.MAINNET="KT1CPuTzwC7h7uLXd5WQmpMFso1HxrLBUtpE",t.CARTHAGENET="KT1VAy1o1FGiXYfD3YT7x7k5eF5HSHhmc1u6",t.DELPHINET="KT19abMFs3haqyKYwqdLjK9GbtofryZLvpiK",t.EDONET="KT1A64nVZDccAHGAsf1ZyVajXZcbiwjV3SnN"}(Ie||(Ie={})),function(t){t.MAINNET="NetXdQprcVkpaWU",t.CARTHAGENET="NetXjD3HPJJjmcd",t.DELPHINET="NetXm8tYqnMWky1",t.EDONET="NetXSgo1ZT2DRUG"}(Se||(Se={}));var Re=function(){function t(t){this.context=t}return Object.defineProperty(t.prototype,"rpc",{get:function(){return this.context.rpc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"signer",{get:function(){return this.context.signer},enumerable:!1,configurable:!0}),t.prototype.prepareOperation=function(t){var r=t.operation,e=t.source;return Zr(this,void 0,void 0,(function(){var t,n,i,a,o,s,c,u,l,h,f,m,d,g,v,y,b,E,w,O,A,P,T,_,I;return Xr(this,(function(S){switch(S.label){case 0:return n={},i=!1,a=[],s=this.rpc.getBlockHeader(),c=this.rpc.getBlockMetadata(),a=Array.isArray(r)?re(r):[r],[4,this.signer.publicKeyHash()];case 1:u=S.sent(),l=Promise.resolve(void 0),h=Promise.resolve(void 0),f=0,S.label=2;case 2:return f<a.length?(R=a[f],-1===["transaction","delegation","origination"].indexOf(R.kind)?[3,4]:(i=!0,[4,this.rpc.getContract(u)])):[3,5];case 3:return m=S.sent().counter,l=Promise.resolve(m),h=this.rpc.getManagerKey(u),[3,5];case 4:return f++,[3,2];case 5:return[4,Promise.all([s,c,l,h])];case 6:if(d=te.apply(void 0,[S.sent(),4]),g=d[0],v=d[1],y=d[2],b=d[3],!g)throw new Error("Unable to fetch latest block header");if(!v)throw new Error("Unable to fetch latest metadata");return o=g,i?(b&&"object"==typeof b?!!b.key:!!b)?[3,8]:(I={kind:p.REVEAL,fee:ne.REVEAL},[4,this.signer.publicKey()]):[3,8];case 7:I.public_key=S.sent(),I.source=u,I.gas_limit=ee.REVEAL,I.storage_limit=ie.REVEAL,E=I,a.unshift(E),S.label=8;case 8:return t=parseInt(y||"0",10),(!n[u]||n[u]<t)&&(n[u]=t),w=function(t){return{counter:""+ ++n[u],fee:void 0===t.fee?"0":""+t.fee,gas_limit:void 0===t.gas_limit?"0":""+t.gas_limit,storage_limit:void 0===t.storage_limit?"0":""+t.storage_limit}},O=function(t){return{source:void 0===t.source?e||u:t.source}},A=function(t){return t.map((function(t){switch(t.kind){case p.ACTIVATION:return Qr({},t);case p.REVEAL:return Qr(Qr(Qr({},t),O(t)),w(t));case p.ORIGINATION:return Qr(Qr(Qr(Qr({},t),{balance:void 0!==t.balance?""+t.balance:"0"}),O(t)),w(t));case p.TRANSACTION:var r=Qr(Qr(Qr(Qr({},t),{amount:void 0!==t.amount?""+t.amount:"0"}),O(t)),w(t));if(r.source.toLowerCase().startsWith("kt1"))throw new Error("KT1 addresses are not supported as source since "+ae.PsBabyM1);return r;case p.DELEGATION:return Qr(Qr(Qr({},t),O(t)),w(t));default:throw new Error("Unsupported operation")}}))},P=o.hash,T=A(a),_=v.next_protocol,[2,{opOb:{branch:P,contents:T,protocol:_},counter:t}]}var R}))}))},t.prototype.prepareAndForge=function(t){return Zr(this,void 0,void 0,(function(){var r;return Xr(this,(function(e){switch(e.label){case 0:return[4,this.prepareOperation(t)];case 1:return r=e.sent(),[2,this.forge(r)]}}))}))},t.prototype.forge=function(t){var r=t.opOb,e=r.branch,n=r.contents,i=r.protocol,a=t.counter;return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){switch(t.label){case 0:return[4,this.context.forger.forge({branch:e,contents:n})];case 1:return[2,{opbytes:t.sent(),opOb:{branch:e,contents:n,protocol:i},counter:a}]}}))}))},t.prototype.simulate=function(t){return Zr(this,void 0,void 0,(function(){var r;return Xr(this,(function(e){switch(e.label){case 0:return r={},[4,this.rpc.runOperation(t)];case 1:return[2,(r.opResponse=e.sent(),r.op=t,r.context=this.context.clone(),r)]}}))}))},t.prototype.estimate=function(t,r){var e=t.fee,n=t.gasLimit,i=t.storageLimit,a=Jr(t,["fee","gasLimit","storageLimit"]);return Zr(this,void 0,void 0,(function(){var t,o,s,c;return Xr(this,(function(u){switch(u.label){case 0:return t=e,o=n,s=i,void 0!==e&&void 0!==n&&void 0!==i?[3,2]:[4,r(Qr({fee:e,gasLimit:n,storageLimit:i},a))];case 1:c=u.sent(),void 0===t&&(t=c.suggestedFeeMutez),void 0===o&&(o=c.gasLimit),void 0===s&&(s=c.storageLimit),u.label=2;case 2:return[2,{fee:t,gasLimit:o,storageLimit:s}]}}))}))},t.prototype.signAndInject=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n,i,a,o,s;return Xr(this,(function(c){switch(c.label){case 0:return[4,this.signer.sign(t.opbytes,new Uint8Array([3]))];case 1:return r=c.sent(),t.opbytes=r.sbytes,t.opOb.signature=r.prefixSig,e=[],[4,this.rpc.preapplyOperations([t.opOb])];case 2:if(n=c.sent(),!Array.isArray(n))throw new ve(n);for(i=0;i<n.length;i++)for(a=0;a<n[i].contents.length;a++)e.push(n[i].contents[a]);if((o=be(n)).length)throw new ge(o);return s={},[4,this.context.injector.inject(t.opbytes)];case 3:return[2,(s.hash=c.sent(),s.forgedBytes=t,s.opResponse=e,s.context=this.context.clone(),s)]}}))}))},t}(),Ne=function(){function t(t,r,e,n){var i=this;this.hash=t,this.raw=r,this.results=e,this.context=n,this._pollingConfig$=new g.a(1),this._currentHeadPromise=void 0,this.currentHead$=Object(b.a)((function(){return i._currentHeadPromise||(i._currentHeadPromise=i.context.rpc.getBlock(),Object(w.a)(1e3).pipe(Object(k.a)()).subscribe((function(){i._currentHeadPromise=void 0}))),Object(y.a)(i._currentHeadPromise)})),this.polling$=Object(b.a)((function(){return i._pollingConfig$.pipe(Object(S.a)((function(t){var r=t.timeout,e=t.interval;if(r<=0)throw new Error("Timeout must be more than 0");if(e<=0)throw new Error("Interval must be more than 0")})),Object(N.a)((function(t){return Qr(Qr({},t),{timeoutAt:Math.ceil(t.timeout/t.interval)+1,count:0})})),Object(U.a)((function(t){return Object(w.a)(0,1e3*t.interval).pipe(Object(F.a)(t))})),Object(S.a)((function(t){if(t.count++,t.count>t.timeoutAt)throw new Error("Confirmation polling timed out")})))})),this.confirmed$=this.polling$.pipe(Object(K.a)(this.currentHead$),Object(N.a)((function(t){for(var r=3;r>=0;r--)t.operations[r].forEach((function(r){r.hash===i.hash&&(i._foundAt=t.header.level)}));if(t.header.level-i._foundAt>=0)return i._foundAt})),Object(D.a)((function(t){return void 0!==t})),Object(k.a)(),Object(R.a)()),this._foundAt=Number.POSITIVE_INFINITY,this.confirmed$.pipe(Object(k.a)()).subscribe()}return Object.defineProperty(t.prototype,"includedInBlock",{get:function(){return this._foundAt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"revealOperation",{get:function(){return Array.isArray(this.results)&&this.results.find((function(t){return"reveal"===t.kind}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"revealStatus",{get:function(){return this.revealOperation?this.revealOperation.metadata.operation_result.status:"unknown"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this.results.map((function(t){return de(t)?t.metadata.operation_result.status:"unknown"}))[0]||"unknown"},enumerable:!1,configurable:!0}),t.prototype.confirmation=function(t,r,e){var n=this;if(void 0!==t&&t<1)throw new Error("Confirmation count must be at least 1");var i=this.context.config,a=i.defaultConfirmationCount,o=i.confirmationPollingIntervalSecond,s=i.confirmationPollingTimeoutSecond;this._pollingConfig$.next({interval:r||o,timeout:e||s});var c=void 0!==t?t:a;return new Promise((function(t,r){n.confirmed$.pipe(Object(U.a)((function(){return n.polling$})),Object(U.a)((function(){return n.currentHead$})),Object(D.a)((function(t){return t.header.level-n._foundAt>=c-1})),Object(k.a)()).subscribe((function(r){t(n._foundAt+(c-1))}),r)}))},t}(),De=function(t){function r(r){return t.call(this,r)||this}return Yr(r,t),r.prototype.getBalance=function(t){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(r){return[2,this.rpc.getBalance(t)]}))}))},r.prototype.getDelegate=function(t){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(r){return[2,this.rpc.getDelegate(t)]}))}))},r.prototype.activate=function(t,r){return Zr(this,void 0,void 0,(function(){var e,n,i,a;return Xr(this,(function(o){switch(o.label){case 0:return e={kind:p.ACTIVATION,pkh:t,secret:r},[4,this.prepareAndForge({operation:[e],source:t})];case 1:return n=o.sent(),i=n.opbytes+"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",a=Ne.bind,[4,this.rpc.injectOperation(i)];case 2:return[2,new(a.apply(Ne,[void 0,o.sent(),Qr(Qr({},n),{opbytes:i}),[],this.context.clone()]))]}}))}))},r}(Re),ke=100,xe=function(){function t(t,r,e,n,i){void 0===i&&(i=ke),this._milligasLimit=t,this._storageLimit=r,this.opSize=e,this.minimalFeePerStorageByteMutez=n,this.baseFeeMutez=i}return Object.defineProperty(t.prototype,"burnFeeMutez",{get:function(){return this.roundUp(Number(this.storageLimit)*Number(this.minimalFeePerStorageByteMutez))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storageLimit",{get:function(){var t=Math.max(Number(this._storageLimit),0);return t>0?t:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gasLimit",{get:function(){return this.roundUp(Number(this._milligasLimit)/1e3+100)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"operationFeeMutez",{get:function(){return.1*(Number(this._milligasLimit)/1e3+100)+1*Number(this.opSize)},enumerable:!1,configurable:!0}),t.prototype.roundUp=function(t){return Math.ceil(Number(t))},Object.defineProperty(t.prototype,"minimalFeeMutez",{get:function(){return this.roundUp(ke+this.operationFeeMutez)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"suggestedFeeMutez",{get:function(){return this.roundUp(this.operationFeeMutez+200)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"usingBaseFeeMutez",{get:function(){return Math.max(Number(this.baseFeeMutez),ke)+this.roundUp(this.operationFeeMutez)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalCost",{get:function(){return this.minimalFeeMutez+this.burnFeeMutez},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"consumedMilligas",{get:function(){return Number(this._milligasLimit)},enumerable:!1,configurable:!0}),t}();function Ce(t){switch(t){case"tz":return 6;case"mtz":return 3;case"mutez":default:return 0}}function Ue(t,r,e){void 0===t&&(t="mutez"),void 0===r&&(r="mutez");var n=new Q.a(e);return n.isNaN()?e:n.multipliedBy(Math.pow(10,Ce(t))).dividedBy(Math.pow(10,Ce(r)))}var Le=function(t,r,e){this.smartContractMethodName=t,this.sigs=r,this.args=e,this.name="Invalid parameters error",this.message=t+" Received "+e.length+" arguments while expecting one of the following signatures ("+JSON.stringify(r)+")"},je=function(){this.name="Undefined LambdaContract error",this.message="This might happen if you are using a sandbox. Please provide the address of a lambda contract as a parameter of the read method."},Me=function(t){this.source=t,this.name="Invalid delegation source error",this.message="Since Babylon delegation source can no longer be a contract address "+t+". Please use the smart contract abstraction to set your delegate."},Ge=function(t,r){this.message=t,this.data=r,this.name="InvalidCodeParameter"},Fe=function(t,r){this.message=t,this.data=r,this.name="InvalidInitParameter"},Ke=function(t){var r=t.code,e=t.init,n=t.balance,i=void 0===n?"0":n,a=t.delegate,o=t.storage,s=t.fee,c=void 0===s?ne.ORIGINATION:s,u=t.gasLimit,l=void 0===u?ee.ORIGINATION:u,h=t.storageLimit,f=void 0===h?ie.ORIGINATION:h,m=t.mutez,d=void 0!==m&&m;return Zr(void 0,void 0,void 0,(function(){var t,n,s,u,h;return Xr(this,(function(m){if(void 0!==o&&void 0!==e)throw new Error("Storage and Init cannot be set a the same time. Please either use storage or init but not both.");if(!Array.isArray(r))throw new Ge("Wrong code parameter type, expected an array",r);if(void 0!==o){if(void 0===(null==(n=r.find((function(t){return"prim"in t&&"storage"===t.prim})))?void 0:n.args))throw new Ge("The storage section is missing from the script",r);s=new J.c(n.args[0]),t=s.Encode(o)}else{if(void 0===e||"object"!=typeof e)throw new Fe("Wrong init parameter type, expected JSON Michelson",e);t=e}return u={code:r,storage:t},h={kind:p.ORIGINATION,fee:c,gas_limit:l,storage_limit:f,balance:d?i.toString():Ue("tz","mutez",i).toString(),script:u},a&&(h.delegate=a),[2,h]}))}))},He=function(t){var r=t.to,e=t.amount,n=t.parameter,i=t.fee,a=void 0===i?ne.TRANSFER:i,o=t.gasLimit,s=void 0===o?ee.TRANSFER:o,c=t.storageLimit,u=void 0===c?ie.TRANSFER:c,l=t.mutez,h=void 0!==l&&l;return Zr(void 0,void 0,void 0,(function(){return Xr(this,(function(t){return[2,{kind:p.TRANSACTION,fee:a,gas_limit:s,storage_limit:u,amount:h?e.toString():Ue("tz","mutez",e).toString(),destination:r,parameters:n}]}))}))},Be=function(t){var r=t.delegate,e=t.source,n=t.fee,i=void 0===n?ne.DELEGATION:n,a=t.gasLimit,o=void 0===a?ee.DELEGATION:a,s=t.storageLimit,c=void 0===s?ie.DELEGATION:s;return Zr(void 0,void 0,void 0,(function(){return Xr(this,(function(t){return[2,{kind:p.DELEGATION,source:e,fee:i,gas_limit:o,storage_limit:c,delegate:r}]}))}))},Ve=function(t,r){var e=t.fee,n=void 0===e?ne.DELEGATION:e,i=t.gasLimit,a=void 0===i?ee.DELEGATION:i,o=t.storageLimit,s=void 0===o?ie.DELEGATION:o;return Zr(void 0,void 0,void 0,(function(){return Xr(this,(function(t){return[2,{kind:p.DELEGATION,fee:n,gas_limit:a,storage_limit:s,delegate:r}]}))}))},ze=function(t,r){return{fee:void 0===t.fee?r.fee:t.fee,gasLimit:void 0===t.gasLimit?r.gasLimit:t.gasLimit,storageLimit:void 0===t.storageLimit?r.storageLimit:t.storageLimit}},We=function(t){function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.ALLOCATION_STORAGE=257,r.ORIGINATION_STORAGE=257,r}return Yr(r,t),r.prototype.getAccountLimits=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n,i,a;return Xr(this,(function(o){switch(o.label){case 0:return[4,this.rpc.getBalance(t)];case 1:return r=o.sent(),[4,this.rpc.getConstants()];case 2:return e=o.sent(),n=e.hard_gas_limit_per_operation,i=e.hard_storage_limit_per_operation,a=e.cost_per_byte,[2,{fee:0,gasLimit:n.toNumber(),storageLimit:Math.floor(Q.a.min(r.dividedBy(a),i).toNumber())}]}}))}))},r.prototype.createEstimateFromOperationContent=function(t,r,e){var n=this,i=ye({contents:[t]}),a=0,o=0,s=0;return i.forEach((function(t){s+="originated_contracts"in t&&void 0!==t.originated_contracts?t.originated_contracts.length*n.ORIGINATION_STORAGE:0,s+="allocated_destination_contract"in t?n.ALLOCATION_STORAGE:0,a+=Number(t.consumed_gas)||0,o+=Number(t.consumed_milligas)||0,s+="paid_storage_size_diff"in t&&Number(t.paid_storage_size_diff)||0})),0!==a&&0===o&&(o=1e3*a),fe(t)?new xe(o||0,Number(s||0),r,e.toNumber()):new xe(0,0,r,e.toNumber(),0)},r.prototype.createEstimate=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n,i,a,o,s,c,u,p,l=this;return Xr(this,(function(h){switch(h.label){case 0:return[4,this.prepareAndForge(t)];case 1:return r=h.sent(),e=r.opbytes,n=r.opOb,i=n.branch,a=n.contents,p={operation:{branch:i,contents:a,signature:"edsigtkpiSSschcaCt9pUVrpNPf7TTcgvgDEDD6NCEHMy8NNQJCGnMfLZzYoQj74yLjo9wx6MPVV29CvVzgi7qEcEUok3k7AuMg"}},[4,this.rpc.getChainId()];case 2:return p.chain_id=h.sent(),o=p,[4,this.simulate(o)];case 3:return s=h.sent().opResponse,[4,this.rpc.getConstants()];case 4:if(c=h.sent().cost_per_byte,(u=re(be(s,"backtracked"),be(s))).length)throw new ge(u);for(;s.contents.length!==(Array.isArray(t.operation)?t.operation.length:1);)s.contents.shift();return[2,s.contents.map((function(t){return l.createEstimateFromOperationContent(t,e.length/2/s.contents.length,c)}))]}}))}))},r.prototype.originate=function(t){var r=t.fee,e=t.storageLimit,n=t.gasLimit,i=Jr(t,["fee","storageLimit","gasLimit"]);return Zr(this,void 0,void 0,(function(){var t,a,o,s;return Xr(this,(function(c){switch(c.label){case 0:return[4,this.signer.publicKeyHash()];case 1:return t=c.sent(),[4,this.getAccountLimits(t)];case 2:return a=c.sent(),s=Ke,[4,this.context.parser.prepareCodeOrigination(Qr(Qr({},i),ze({fee:r,storageLimit:e,gasLimit:n},a)))];case 3:return[4,s.apply(void 0,[c.sent()])];case 4:return o=c.sent(),[4,this.createEstimate({operation:o,source:t})];case 5:return[2,c.sent()[0]]}}))}))},r.prototype.transfer=function(t){var r=t.fee,e=t.storageLimit,n=t.gasLimit,i=Jr(t,["fee","storageLimit","gasLimit"]);return Zr(this,void 0,void 0,(function(){var t,a,o;return Xr(this,(function(s){switch(s.label){case 0:return[4,this.signer.publicKeyHash()];case 1:return t=s.sent(),[4,this.getAccountLimits(t)];case 2:return a=s.sent(),[4,He(Qr(Qr({},i),ze({fee:r,storageLimit:e,gasLimit:n},a)))];case 3:return o=s.sent(),[4,this.createEstimate({operation:o,source:t})];case 4:return[2,s.sent()[0]]}}))}))},r.prototype.setDelegate=function(t){var r=t.fee,e=t.gasLimit,n=t.storageLimit,i=Jr(t,["fee","gasLimit","storageLimit"]);return Zr(this,void 0,void 0,(function(){var t,a,o,s;return Xr(this,(function(c){switch(c.label){case 0:return(a=i.source)?[3,2]:[4,this.signer.publicKeyHash()];case 1:a=c.sent(),c.label=2;case 2:return t=a,[4,this.getAccountLimits(t)];case 3:return o=c.sent(),[4,Be(Qr(Qr({},i),ze({fee:r,storageLimit:n,gasLimit:e},o)))];case 4:return s=c.sent(),[4,this.createEstimate({operation:s,source:t})];case 5:return[2,c.sent()[0]]}}))}))},r.prototype.batch=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n,i,a,o,s,c,u,l,h,f,m,d,g,v;return Xr(this,(function(y){switch(y.label){case 0:return r=[],n=this.getAccountLimits,[4,this.signer.publicKeyHash()];case 1:return[4,n.apply(this,[y.sent()])];case 2:e=y.sent(),y.label=3;case 3:y.trys.push([3,16,17,18]),i=$r(t),a=i.next(),y.label=4;case 4:if(a.done)return[3,15];switch(o=a.value,o.kind){case p.TRANSACTION:return[3,5];case p.ORIGINATION:return[3,7];case p.DELEGATION:return[3,10];case p.ACTIVATION:return[3,12]}return[3,13];case 5:return c=(s=r).push,[4,He(Qr(Qr({},o),ze(o,e)))];case 6:return c.apply(s,[y.sent()]),[3,14];case 7:return l=(u=r).push,h=Ke,[4,this.context.parser.prepareCodeOrigination(Qr(Qr({},o),ze(o,e)))];case 8:return[4,h.apply(void 0,[y.sent()])];case 9:return l.apply(u,[y.sent()]),[3,14];case 10:return m=(f=r).push,[4,Be(Qr(Qr({},o),ze(o,e)))];case 11:return m.apply(f,[y.sent()]),[3,14];case 12:return r.push(Qr(Qr({},o),e)),[3,14];case 13:throw new Error("Unsupported operation kind: "+o.kind);case 14:return a=i.next(),[3,4];case 15:return[3,18];case 16:return d=y.sent(),g={error:d},[3,18];case 17:try{a&&!a.done&&(v=i.return)&&v.call(i)}finally{if(g)throw g.error}return[7];case 18:return[2,this.createEstimate({operation:r})]}}))}))},r.prototype.registerDelegate=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n,i,a,o,s;return Xr(this,(function(c){switch(c.label){case 0:return e=this.getAccountLimits,[4,this.signer.publicKeyHash()];case 1:return[4,e.apply(this,[c.sent()])];case 2:return r=c.sent(),i=Ve,a=[Qr(Qr({},t),r)],[4,this.signer.publicKeyHash()];case 3:return[4,i.apply(void 0,a.concat([c.sent()]))];case 4:return n=c.sent(),o=this.createEstimate,s={operation:n},[4,this.signer.publicKeyHash()];case 5:return[4,o.apply(this,[(s.source=c.sent(),s)])];case 6:return[2,c.sent()[0]]}}))}))},r}(Re),qe=function(t){function r(r,e,n,i,a,o){var s=t.call(this,r,i,a,o)||this;return s.params=e,s.source=n,s}return Yr(r,t),Object.defineProperty(r.prototype,"operationResults",{get:function(){var t=Array.isArray(this.results)&&this.results.find((function(t){return"delegation"===t.kind})),r=t&&t.metadata&&t.metadata.operation_result;return r||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"status",{get:function(){var t=this.operationResults;return t?t.status:"unknown"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"delegate",{get:function(){return this.delegate},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isRegisterOperation",{get:function(){return this.delegate===this.source},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fee",{get:function(){return this.params.fee},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"gasLimit",{get:function(){return this.params.gas_limit},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"storageLimit",{get:function(){return this.params.storage_limit},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"consumedGas",{get:function(){var t=this.operationResults&&this.operationResults.consumed_gas;return t||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"errors",{get:function(){return this.operationResults&&this.operationResults.errors},enumerable:!1,configurable:!0}),r}(Ne),Ye=function(t){function r(r,e,n,i,a,o){var s=t.call(this,r,n,i,a)||this;s.params=e,s.contractProvider=o;var c=s.operationResults&&s.operationResults.originated_contracts;return Array.isArray(c)&&(s.contractAddress=c[0]),s}return Yr(r,t),Object.defineProperty(r.prototype,"status",{get:function(){var t=this.operationResults;return t?t.status:"unknown"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"operationResults",{get:function(){var t=Array.isArray(this.results)&&this.results.find((function(t){return"origination"===t.kind})),r=t&&de(t)&&t.metadata.operation_result;return r||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fee",{get:function(){return this.params.fee},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"gasLimit",{get:function(){return this.params.gas_limit},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"storageLimit",{get:function(){return this.params.storage_limit},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"consumedGas",{get:function(){var t=this.operationResults&&this.operationResults.consumed_gas;return t||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"storageDiff",{get:function(){var t=this.operationResults&&this.operationResults.paid_storage_size_diff;return t||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"storageSize",{get:function(){var t=this.operationResults&&this.operationResults.storage_size;return t||void 0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"errors",{get:function(){return this.operationResults&&this.operationResults.errors},enumerable:!1,configurable:!0}),r.prototype.contract=function(t,r,e){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(n){switch(n.label){case 0:if(!this.contractAddress)throw new Error("No contract was originated in this operation");return[4,this.confirmation(t,r,e)];case 1:return n.sent(),[2,this.contractProvider.at(this.contractAddress)]}}))}))},r}(Ne),Qe=function(t){function r(r,e,n,i,a,o){var s=t.call(this,r,i,a,o)||this;return s.params=e,s.source=n,s}return Yr(r,t),Object.defineProperty(r.prototype,"operationResults",{get:function(){var t=Array.isArray(this.results)&&this.results.find((function(t){return"transaction"===t.kind}));return t?[t]:[]},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"status",{get:function(){var t=this.operationResults[0];return t?t.metadata.operation_result.status:"unknown"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"amount",{get:function(){return new Q.a(this.params.amount)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"destination",{get:function(){return this.params.destination},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fee",{get:function(){return this.params.fee},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"gasLimit",{get:function(){return this.params.gas_limit},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"storageLimit",{get:function(){return this.params.storage_limit},enumerable:!1,configurable:!0}),r.prototype.sumProp=function(t,r){return t.reduce((function(t,e){return r in e?Number(e[r])+t:t}),0)},Object.defineProperty(r.prototype,"consumedGas",{get:function(){return String(this.sumProp(ye({contents:this.operationResults}),"consumed_gas"))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"storageDiff",{get:function(){return String(this.sumProp(ye({contents:this.operationResults}),"paid_storage_size_diff"))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"storageSize",{get:function(){return String(this.sumProp(ye({contents:this.operationResults}),"storage_size"))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"errors",{get:function(){return be({contents:this.operationResults})},enumerable:!1,configurable:!0}),r}(Ne);function Je(t,r){return function(e,n){return r(t(e,n),n)}}var Ze=function(){function t(t,r){this.walletProvider=t,this.context=r,this.operations=[]}return t.prototype.withTransfer=function(t){return this.operations.push(Qr({kind:p.TRANSACTION},t)),this},t.prototype.withContractCall=function(t){return this.withTransfer(t.toTransferParams())},t.prototype.withDelegation=function(t){return this.operations.push(Qr({kind:p.DELEGATION},t)),this},t.prototype.withOrigination=function(t){return this.operations.push(Qr({kind:p.ORIGINATION},t)),this},t.prototype.mapOperation=function(t){return Zr(this,void 0,void 0,(function(){var r,e;return Xr(this,(function(n){switch(n.label){case 0:switch(t.kind){case p.TRANSACTION:return[3,1];case p.ORIGINATION:return[3,2];case p.DELEGATION:return[3,4]}return[3,5];case 1:return[2,this.walletProvider.mapTransferParamsToWalletParams(Qr({},t))];case 2:return e=(r=this.walletProvider).mapOriginateParamsToWalletParams,[4,this.context.parser.prepareCodeOrigination(Qr({},t))];case 3:return[2,e.apply(r,[n.sent()])];case 4:return[2,this.walletProvider.mapDelegateParamsToWalletParams(Qr({},t))];case 5:throw new Error("Unsupported operation kind: "+t.kind)}}))}))},t.prototype.with=function(t){var r,e;try{for(var n=$r(t),i=n.next();!i.done;i=n.next()){var a=i.value;switch(a.kind){case p.TRANSACTION:this.withTransfer(a);break;case p.ORIGINATION:this.withOrigination(a);break;case p.DELEGATION:this.withDelegation(a);break;default:throw new Error("Unsupported operation kind: "+a.kind)}}}catch(o){r={error:o}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(r)throw r.error}}return this},t.prototype.send=function(){return Zr(this,void 0,void 0,(function(){var t,r,e,n,i,a,o,s,c,u;return Xr(this,(function(p){switch(p.label){case 0:t=[],p.label=1;case 1:p.trys.push([1,6,7,8]),r=$r(this.operations),e=r.next(),p.label=2;case 2:return e.done?[3,5]:(n=e.value,a=(i=t).push,[4,this.mapOperation(n)]);case 3:a.apply(i,[p.sent()]),p.label=4;case 4:return e=r.next(),[3,2];case 5:return[3,8];case 6:return o=p.sent(),c={error:o},[3,8];case 7:try{e&&!e.done&&(u=r.return)&&u.call(r)}finally{if(c)throw c.error}return[7];case 8:return[4,this.walletProvider.sendOperations(t)];case 9:return s=p.sent(),[2,this.context.operationFactory.createOperation(s)]}}))}))},t}(),Xe=function(){function t(t){this.context=t,this.walletCommand=function(t){return{send:t}}}return Object.defineProperty(t.prototype,"walletProvider",{get:function(){return this.context.walletProvider},enumerable:!1,configurable:!0}),t.prototype.pkh=function(t){var r=(void 0===t?{}:t).forceRefetch;return Zr(this,void 0,void 0,(function(){var t;return Xr(this,(function(e){switch(e.label){case 0:return this._pkh&&!r?[3,2]:(t=this,[4,this.walletProvider.getPKH()]);case 1:t._pkh=e.sent(),e.label=2;case 2:return[2,this._pkh]}}))}))},t.prototype.originate=function(t){var r=this;return this.walletCommand((function(){return Zr(r,void 0,void 0,(function(){var r,e,n,i,a;return Xr(this,(function(o){switch(o.label){case 0:return n=(e=this.walletProvider).mapOriginateParamsToWalletParams,[4,this.context.parser.prepareCodeOrigination(Qr({},t))];case 1:return[4,n.apply(e,[o.sent()])];case 2:return r=o.sent(),[4,this.walletProvider.sendOperations([r])];case 3:return i=o.sent(),this.context.proto?[3,5]:(a=this.context,[4,this.context.rpc.getBlock()]);case 4:a.proto=o.sent().protocol,o.label=5;case 5:return[2,this.context.operationFactory.createOriginationOperation(i)]}}))}))}))},t.prototype.setDelegate=function(t){var r=this;return this.walletCommand((function(){return Zr(r,void 0,void 0,(function(){var r,e;return Xr(this,(function(n){switch(n.label){case 0:return[4,this.walletProvider.mapDelegateParamsToWalletParams(Qr({},t))];case 1:return r=n.sent(),[4,this.walletProvider.sendOperations([r])];case 2:return e=n.sent(),[2,this.context.operationFactory.createDelegationOperation(e)]}}))}))}))},t.prototype.registerDelegate=function(){var t=this;return this.walletCommand((function(){return Zr(t,void 0,void 0,(function(){var t,r,e,n,i;return Xr(this,(function(a){switch(a.label){case 0:return e=(r=this.walletProvider).mapDelegateParamsToWalletParams,i={},[4,this.pkh()];case 1:return[4,e.apply(r,[(i.delegate=a.sent(),i)])];case 2:return t=a.sent(),[4,this.walletProvider.sendOperations([t])];case 3:return n=a.sent(),[2,this.context.operationFactory.createDelegationOperation(n)]}}))}))}))},t.prototype.transfer=function(t){var r=this;return this.walletCommand((function(){return Zr(r,void 0,void 0,(function(){var r,e;return Xr(this,(function(n){switch(n.label){case 0:return[4,this.walletProvider.mapTransferParamsToWalletParams(t)];case 1:return r=n.sent(),[4,this.walletProvider.sendOperations([r])];case 2:return e=n.sent(),[2,this.context.operationFactory.createTransactionOperation(e)]}}))}))}))},t.prototype.batch=function(t){var r=new Ze(this.walletProvider,this.context);return r.with(t),r},t.prototype.at=function(t,r){return void 0===r&&(r=function(t){return t}),Zr(this,void 0,void 0,(function(){var e,n,i,a,o;return Xr(this,(function(s){switch(s.label){case 0:return[4,this.context.rpc.getScript(t)];case 1:return e=s.sent(),[4,this.context.rpc.getEntrypoints(t)];case 2:return n=s.sent(),[4,this.context.rpc.getBlockHeader()];case 3:return i=s.sent(),a=i.chain_id,o=new on(t,e,this,this.context.contract,n,a),[2,r(o,this.context)]}}))}))},t}(),$e=function(){function t(t){this.context=t}return t.prototype.getPKH=function(){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){return[2,this.context.signer.publicKeyHash()]}))}))},t.prototype.mapTransferParamsToWalletParams=function(t){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(r){return[2,pe(t,p.TRANSACTION)]}))}))},t.prototype.mapOriginateParamsToWalletParams=function(t){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(r){return[2,pe(t,p.ORIGINATION)]}))}))},t.prototype.mapDelegateParamsToWalletParams=function(t){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(r){return[2,pe(t,p.DELEGATION)]}))}))},t.prototype.sendOperations=function(t){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(r){switch(r.label){case 0:return[4,this.context.batch.batch(t).send()];case 1:return[2,r.sent().hash]}}))}))},t}(),tn=function(){function t(t,r,e,n){void 0===e&&(e="default"),void 0===n&&(n={prim:"Unit"}),this.lambdaContract=t,this.viewContract=r,this.viewMethod=e,this.contractParameter=n,this.voidLambda=this.createVoidLambda()}return t.prototype.execute=function(){return Zr(this,void 0,void 0,(function(){var t,r;return Xr(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.lambdaContract.methods.default(this.voidLambda).send()];case 1:return e.sent(),[3,3];case 2:if((t=e.sent())instanceof ge)return r=t.errors[t.errors.length-1],[2,r.with];throw t;case 3:return[2]}}))}))},t.prototype.createVoidLambda=function(){var t=te(this.getView(),2),r=t[0],e=t[1],n=[{prim:"pair",args:[r,{prim:"contract",args:[e]}]}];return"default"===this.viewMethod&&(n=[{string:"%default"}].concat(n)),[{prim:"PUSH",args:[{prim:"mutez"},{int:"0"}]},{prim:"NONE",args:[{prim:"key_hash"}]},{prim:"CREATE_CONTRACT",args:[[{prim:"parameter",args:[e]},{prim:"storage",args:[{prim:"unit"}]},{prim:"code",args:[[{prim:"CAR"},{prim:"FAILWITH"}]]}]]},{prim:"DIP",args:[[{prim:"DIP",args:[[{prim:"LAMBDA",args:[{prim:"pair",args:[{prim:"address"},{prim:"unit"}]},{prim:"pair",args:[{prim:"list",args:[{prim:"operation"}]},{prim:"unit"}]},[{prim:"CAR"},{prim:"CONTRACT",args:[e]},{prim:"IF_NONE",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"Callback type unmatched"}]},{prim:"FAILWITH"}],[]]},{prim:"PUSH",args:[r,this.contractParameter]},{prim:"PAIR"},{prim:"DIP",args:[[{prim:"PUSH",args:[{prim:"address"},{string:this.viewContract.address+"%"+this.viewMethod}]},{prim:"DUP"},{prim:"CONTRACT",args:n},{prim:"IF_NONE",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"Contract does not exist"}]},{prim:"FAILWITH"}],[{prim:"DIP",args:[[{prim:"DROP"}]]}]]},{prim:"PUSH",args:[{prim:"mutez"},{int:"0"}]}]]},{prim:"TRANSFER_TOKENS"},{prim:"DIP",args:[[{prim:"NIL",args:[{prim:"operation"}]}]]},{prim:"CONS"},{prim:"DIP",args:[[{prim:"UNIT"}]]},{prim:"PAIR"}]]}]]},{prim:"APPLY"},{prim:"DIP",args:[[{prim:"PUSH",args:[{prim:"address"},{string:this.lambdaContract.address}]},{prim:"DUP"},{prim:"CONTRACT",args:[{prim:"lambda",args:[{prim:"unit"},{prim:"pair",args:[{prim:"list",args:[{prim:"operation"}]},{prim:"unit"}]}]}]},{prim:"IF_NONE",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"Contract does not exists"}]},{prim:"FAILWITH"}],[{prim:"DIP",args:[[{prim:"DROP"}]]}]]},{prim:"PUSH",args:[{prim:"mutez"},{int:"0"}]}]]},{prim:"TRANSFER_TOKENS"},{prim:"DIP",args:[[{prim:"NIL",args:[{prim:"operation"}]}]]},{prim:"CONS"}]]},{prim:"CONS"},{prim:"DIP",args:[[{prim:"UNIT"}]]},{prim:"PAIR"}]},t.prototype.getView=function(){var t=this.viewContract.entrypoints.entrypoints[this.viewMethod];if(!t)throw Error("Contract at "+this.viewContract.address+" does not have entrypoint: "+this.viewMethod);if(!("prim"in t)||!t.args)throw Error("Entrypoint args undefined");var r,e=Array.from(t.args),n=te(e,2),i=n[0],a=n[1];if("annots"in i&&delete i.annots,!("prim"in a)||!a.args)throw Error("Callback contract args undefined");if("pair"!==t.prim?r="Expected {'prim': 'pair', ..} but found {'prim': "+t.prim+", ..}":2!==e.length?r="Expected an Array of length 2, but found: "+e:"contract"!==a.prim?r="Expected a {prim: 'contract', ...}, but found: "+a.prim:a.args&&1!==a.args.length&&(r="Expected a single argument to 'contract', but found: "+a.args),r)throw Error(r);return[i,a.args[0]]},t}(),rn="default",en=function(){function t(t,r,e,n,i,a,o){void 0===a&&(a=!0),void 0===o&&(o=!1),this.provider=t,this.address=r,this.parameterSchema=e,this.name=n,this.args=i,this.isMultipleEntrypoint=a,this.isAnonymous=o}return Object.defineProperty(t.prototype,"schema",{get:function(){return this.isAnonymous?this.parameterSchema.ExtractSchema()[this.name]:this.parameterSchema.ExtractSchema()},enumerable:!1,configurable:!0}),t.prototype.send=function(t){return void 0===t&&(t={}),this.provider instanceof Xe?this.provider.transfer(this.toTransferParams(t)).send():this.provider.transfer(this.toTransferParams(t))},t.prototype.toTransferParams=function(t){var r,e,n=void 0===t?{}:t,i=n.fee,a=n.gasLimit,o=n.storageLimit,s=n.source,c=n.amount,u=void 0===c?0:c,p=n.mutez,l=void 0!==p&&p;return{to:this.address,amount:u,fee:i,mutez:l,source:s,gasLimit:a,storageLimit:o,parameter:{entrypoint:this.isMultipleEntrypoint?this.name:"default",value:this.isAnonymous?(r=this.parameterSchema).Encode.apply(r,re([this.name],this.args)):(e=this.parameterSchema).Encode.apply(e,re(this.args))}}},t}(),nn=function(){function t(t,r,e,n,i,a,o){this.currentContract=t,this.provider=r,this.name=e,this.chainId=n,this.callbackParametersSchema=i,this.parameterSchema=a,this.args=o}return t.prototype.read=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n,i,a;return Xr(this,(function(o){switch(o.label){case 0:if(t)r=t;else if(this.chainId===Se.CARTHAGENET)r=Ie.CARTHAGENET;else if(this.chainId===Se.DELPHINET)r=Ie.DELPHINET;else if(this.chainId===Se.EDONET)r=Ie.EDONET;else{if(this.chainId!==Se.MAINNET)throw new je;r=Ie.MAINNET}return[4,this.provider.at(r)];case 1:return e=o.sent(),n=(a=this.parameterSchema).Encode.apply(a,re(this.args)),[4,new tn(e,this.currentContract,this.name,n).execute()];case 2:return i=o.sent(),[2,this.callbackParametersSchema.Execute(i)]}}))}))},t}(),an=function(t,r,e){var n=r.ExtractSignatures();if(!n.find((function(r){return r.length===t.length})))throw new Le(e,n,t)},on=function(){function t(t,r,e,n,i,a){this.address=t,this.script=r,this.storageProvider=n,this.entrypoints=i,this.chainId=a,this.methods={},this.views={},this.schema=J.c.fromRPCResponse({script:this.script}),this.parameterSchema=J.b.fromRPCResponse({script:this.script}),this._initializeMethods(this,t,e,this.entrypoints.entrypoints,this.chainId)}return t.prototype._initializeMethods=function(t,r,e,n,i){var a=this,o=this.parameterSchema,s=Object.keys(n);if(o.isMultipleEntryPoint){s.forEach((function(o){var s=new J.b(n[o]);if(a.methods[o]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return an(t,s,o),new en(e,r,s,o,t)},void 0!==e.contractProviderTypeSymbol&&function(t){var r=!1,e=t.ExtractSignatures();return"contract"===e[0][e[0].length-1]&&(r=!0),r}(s)){a.views[o]=function(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var s=n[o].args[0],c=new J.b(s),u=n[o].args[1].args[0],p=new J.b(u);return an(r,c,o),new nn(t,e,o,i,p,c,r)}}})),Object.keys(o.ExtractSchema()).filter((function(t){return-1===Object.keys(n).indexOf(t)})).forEach((function(t){a.methods[t]=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return an(re([t],n),o,t),new en(e,r,o,t,n,!1,!0)}}))}else{var c=this.parameterSchema;this.methods.default=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return an(t,o,rn),new en(e,r,c,rn,t,!1)}}},t.prototype.storage=function(){return this.storageProvider.getStorage(this.address,this.schema)},t.prototype.bigMap=function(t){return this.storageProvider.getBigMapKey(this.address,t,this.schema)},t}(),sn=function(){function t(t,r,e){this.id=t,this.schema=r,this.provider=e}return t.prototype.get=function(t){return Zr(this,void 0,void 0,(function(){var r;return Xr(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.provider.getBigMapKeyByID(this.id.toString(),t,this.schema)];case 1:return[2,e.sent()];case 2:if((r=e.sent())instanceof n.b&&r.status===n.c.NOT_FOUND)return[2,void 0];throw r;case 3:return[2]}}))}))},t.prototype.toJSON=function(){return this.id.toString()},t.prototype.toString=function(){return this.id.toString()},t}(),cn=function(t){return{big_map:function(r,e){if(r&&"int"in r&&void 0!==r.int){var n=new J.c(e);return new sn(new Q.a(r.int),n,t)}return{}}}},un=function(t){function r(r,e){var n=t.call(this,r)||this;return n.estimator=e,n.contractProviderTypeSymbol=Symbol.for("taquito--provider-type-symbol"),n}return Yr(r,t),r.prototype.getStorage=function(t,r){return Zr(this,void 0,void 0,(function(){var e,n;return Xr(this,(function(i){switch(i.label){case 0:return r?[3,2]:[4,this.rpc.getScript(t)];case 1:r=i.sent(),i.label=2;case 2:return e=J.c.isSchema(r)?r:J.c.fromRPCResponse({script:r}),[4,this.rpc.getStorage(t)];case 3:return n=i.sent(),[2,e.Execute(n,cn(this))]}}))}))},r.prototype.getBigMapKey=function(t,r,e){return Zr(this,void 0,void 0,(function(){var n,i,a;return Xr(this,(function(o){switch(o.label){case 0:return e?[3,2]:[4,this.rpc.getScript(t)];case 1:e=o.sent(),o.label=2;case 2:return n=J.c.isSchema(e)?e:J.c.fromRPCResponse({script:e}),i=n.EncodeBigMapKey(r),[4,this.rpc.getBigMapKey(t,i)];case 3:return a=o.sent(),[2,n.ExecuteOnBigMapValue(a)]}}))}))},r.prototype.getBigMapKeyByID=function(t,r,e){return Zr(this,void 0,void 0,(function(){var n,i,a,o,s,c;return Xr(this,(function(u){switch(u.label){case 0:return n=e.EncodeBigMapKey(r),i=n.key,a=n.type,[4,this.context.rpc.packData({data:i,type:a})];case 1:return o=u.sent().packed,s=Object(Z.g)(o),[4,this.context.rpc.getBigMapExpr(t.toString(),s)];case 2:return c=u.sent(),[2,e.ExecuteOnBigMapValue(c,cn(this))]}}))}))},r.prototype.originate=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n,i,a,o,s,c,u,p,l;return Xr(this,(function(h){switch(h.label){case 0:return[4,this.estimate(t,this.estimator.originate.bind(this.estimator))];case 1:return r=h.sent(),[4,this.signer.publicKeyHash()];case 2:return e=h.sent(),i=Ke,[4,this.context.parser.prepareCodeOrigination(Qr(Qr({},t),r))];case 3:return[4,i.apply(void 0,[h.sent()])];case 4:return n=h.sent(),[4,this.prepareOperation({operation:n,source:e})];case 5:return a=h.sent(),[4,this.forge(a)];case 6:return o=h.sent(),[4,this.signAndInject(o)];case 7:return s=h.sent(),c=s.hash,u=s.context,p=s.forgedBytes,l=s.opResponse,[2,new Ye(c,n,p,l,u,this)]}}))}))},r.prototype.setDelegate=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n,i,a,o,s,c,u,p;return Xr(this,(function(l){switch(l.label){case 0:if(/kt1/i.test(t.source))throw new Me(t.source);return[4,this.estimate(t,this.estimator.setDelegate.bind(this.estimator))];case 1:return r=l.sent(),[4,Be(Qr(Qr({},t),r))];case 2:return e=l.sent(),(i=t.source)?[3,4]:[4,this.signer.publicKeyHash()];case 3:i=l.sent(),l.label=4;case 4:return n=i,[4,this.prepareAndForge({operation:e,source:n})];case 5:return a=l.sent(),[4,this.signAndInject(a)];case 6:return o=l.sent(),s=o.hash,c=o.context,u=o.forgedBytes,p=o.opResponse,[2,new qe(s,e,n,u,p,c)]}}))}))},r.prototype.registerDelegate=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n,i,a,o,s,c,u;return Xr(this,(function(p){switch(p.label){case 0:return[4,this.estimate(t,this.estimator.registerDelegate.bind(this.estimator))];case 1:return r=p.sent(),[4,this.signer.publicKeyHash()];case 2:return e=p.sent(),[4,Ve(Qr(Qr({},t),r),e)];case 3:return n=p.sent(),[4,this.prepareAndForge({operation:n})];case 4:return i=p.sent(),[4,this.signAndInject(i)];case 5:return a=p.sent(),o=a.hash,s=a.context,c=a.forgedBytes,u=a.opResponse,[2,new qe(o,n,e,c,u,s)]}}))}))},r.prototype.transfer=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n,i,a,o,s,c,u,p;return Xr(this,(function(l){switch(l.label){case 0:return[4,this.estimate(t,this.estimator.transfer.bind(this.estimator))];case 1:return r=l.sent(),[4,He(Qr(Qr({},t),r))];case 2:return e=l.sent(),(i=t.source)?[3,4]:[4,this.signer.publicKeyHash()];case 3:i=l.sent(),l.label=4;case 4:return n=i,[4,this.prepareAndForge({operation:e,source:t.source})];case 5:return a=l.sent(),[4,this.signAndInject(a)];case 6:return o=l.sent(),s=o.hash,c=o.context,u=o.forgedBytes,p=o.opResponse,[2,new Qe(s,e,n,u,p,c)]}}))}))},r.prototype.at=function(t,r){return void 0===r&&(r=function(t){return t}),Zr(this,void 0,void 0,(function(){var e,n,i,a,o;return Xr(this,(function(s){switch(s.label){case 0:return[4,this.rpc.getScript(t)];case 1:return e=s.sent(),[4,this.rpc.getEntrypoints(t)];case 2:return n=s.sent(),[4,this.rpc.getBlockHeader()];case 3:return i=s.sent(),a=i.chain_id,o=new on(t,e,this,this,n,a),[2,r(o,this.context)]}}))}))},r}(Re),pn=function(t){function r(r,e,n,i,a,o){var s=t.call(this,r,i,a,o)||this;return s.params=e,s.source=n,s}return Yr(r,t),r.prototype.sumProp=function(t,r){return t.reduce((function(t,e){return r in e?Number(e[r])+t:t}),0)},Object.defineProperty(r.prototype,"status",{get:function(){return this.results.filter((function(t){return-1!==ln.indexOf(t.kind)})).map((function(t){return de(t)?t.metadata.operation_result.status:"unknown"}))[0]||"unknown"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fee",{get:function(){return this.sumProp(this.params,"fee")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"gasLimit",{get:function(){return this.sumProp(this.params,"gas_limit")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"storageLimit",{get:function(){return this.sumProp(this.params,"storage_limit")},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"consumedGas",{get:function(){return String(this.sumProp(ye({contents:this.results}),"consumed_gas"))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"storageDiff",{get:function(){return String(this.sumProp(ye({contents:this.results}),"paid_storage_size_diff"))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"errors",{get:function(){return be({contents:this.results})},enumerable:!1,configurable:!0}),r}(Ne),ln=[p.ACTIVATION,p.ORIGINATION,p.TRANSACTION,p.DELEGATION],hn=function(t){function r(r,e){var n=t.call(this,r)||this;return n.estimator=e,n.operations=[],n}return Yr(r,t),r.prototype.withTransfer=function(t){return this.operations.push(Qr({kind:p.TRANSACTION},t)),this},r.prototype.withContractCall=function(t){return this.withTransfer(t.toTransferParams())},r.prototype.withDelegation=function(t){return this.operations.push(Qr({kind:p.DELEGATION},t)),this},r.prototype.withActivation=function(t){var r=t.pkh,e=t.secret;return this.operations.push({kind:p.ACTIVATION,pkh:r,secret:e}),this},r.prototype.withOrigination=function(t){return this.operations.push(Qr({kind:p.ORIGINATION},t)),this},r.prototype.getRPCOp=function(t){return Zr(this,void 0,void 0,(function(){var r;return Xr(this,(function(e){switch(e.label){case 0:switch(t.kind){case p.TRANSACTION:return[3,1];case p.ORIGINATION:return[3,2];case p.DELEGATION:return[3,4];case p.ACTIVATION:return[3,5]}return[3,6];case 1:return[2,He(Qr({},t))];case 2:return r=Ke,[4,this.context.parser.prepareCodeOrigination(Qr({},t))];case 3:return[2,r.apply(void 0,[e.sent()])];case 4:return[2,Be(Qr({},t))];case 5:return[2,Qr({},t)];case 6:throw new Error("Unsupported operation kind: "+t.kind)}}))}))},r.prototype.with=function(t){var r,e;try{for(var n=$r(t),i=n.next();!i.done;i=n.next()){var a=i.value;switch(a.kind){case p.TRANSACTION:this.withTransfer(a);break;case p.ORIGINATION:this.withOrigination(a);break;case p.DELEGATION:this.withDelegation(a);break;case p.ACTIVATION:this.withActivation(a);break;default:throw new Error("Unsupported operation kind: "+a.kind)}}}catch(o){r={error:o}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(r)throw r.error}}return this},r.prototype.send=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n,i,a,o,s,c,u,p,l,h,f,m,d,g,v,y,b,E,w=this;return Xr(this,(function(O){switch(O.label){case 0:return[4,this.estimator.batch(this.operations)];case 1:r=O.sent(),e=[],n=0,O.label=2;case 2:O.trys.push([2,10,11,12]),i=$r(this.operations),a=i.next(),O.label=3;case 3:return a.done?[3,9]:(o=a.value,fe(o)?[4,this.estimate(o,(function(){return Zr(w,void 0,void 0,(function(){return Xr(this,(function(t){return[2,r[n]]}))}))}))]:[3,6]);case 4:return s=O.sent(),u=(c=e).push,[4,this.getRPCOp(Qr(Qr({},o),s))];case 5:return u.apply(c,[O.sent()]),[3,7];case 6:e.push(Qr({},o)),O.label=7;case 7:n++,O.label=8;case 8:return a=i.next(),[3,3];case 9:return[3,12];case 10:return p=O.sent(),b={error:p},[3,12];case 11:try{a&&!a.done&&(E=i.return)&&E.call(i)}finally{if(b)throw b.error}return[7];case 12:return(h=t&&t.source)?[3,14]:[4,this.signer.publicKeyHash()];case 13:h=O.sent(),O.label=14;case 14:return l=h,[4,this.prepareAndForge({operation:e,source:l})];case 15:return f=O.sent(),[4,this.signAndInject(f)];case 16:return m=O.sent(),d=m.hash,g=m.context,v=m.forgedBytes,y=m.opResponse,[2,new pn(d,e,l,v,y,g)]}}))}))},r}(Re),fn=function(){function t(t,r){this.context=t,this.estimator=r}return t.prototype.batch=function(t){var r=new hn(this.context,this.estimator);return Array.isArray(t)&&r.with(t),r},t}(),mn=function(){function t(t){this.context=t}return t.prototype.getNextProto=function(){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(t){switch(t.label){case 0:return[4,this.context.rpc.getBlockMetadata()];case 1:return[2,t.sent().next_protocol]}}))}))},t.prototype.parseScript=function(t){return Zr(this,void 0,void 0,(function(){var r,e;return Xr(this,(function(n){switch(n.label){case 0:return r=Mt.bind,e={},[4,this.getNextProto()];case 1:return[2,(new(r.apply(Mt,[void 0,(e.protocol=n.sent(),e)]))).parseScript(t)]}}))}))},t.prototype.parseMichelineExpression=function(t){return Zr(this,void 0,void 0,(function(){var r,e;return Xr(this,(function(n){switch(n.label){case 0:return r=Mt.bind,e={},[4,this.getNextProto()];case 1:return[2,(new(r.apply(Mt,[void 0,(e.protocol=n.sent(),e)]))).parseMichelineExpression(t)]}}))}))},t.prototype.parseJSON=function(t){return Zr(this,void 0,void 0,(function(){var r,e;return Xr(this,(function(n){switch(n.label){case 0:return r=Mt.bind,e={},[4,this.getNextProto()];case 1:return[2,(new(r.apply(Mt,[void 0,(e.protocol=n.sent(),e)]))).parseJSON(t)]}}))}))},t.prototype.prepareCodeOrigination=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n;return Xr(this,(function(i){switch(i.label){case 0:return e=r=t,[4,this.formatCodeParam(t.code)];case 1:return e.code=i.sent(),t.init?(n=r,[4,this.formatInitParam(t.init)]):[3,3];case 2:n.init=i.sent(),i.label=3;case 3:return[2,r]}}))}))},t.prototype.formatCodeParam=function(t){return Zr(this,void 0,void 0,(function(){var r,e,n;return Xr(this,(function(i){switch(i.label){case 0:return"string"!=typeof t?[3,2]:[4,this.parseScript(t)];case 1:if(null===(e=i.sent()))throw new Ge("Invalid code parameter",t);return r=e,[3,4];case 2:return[4,this.parseJSON(t)];case 3:e=i.sent(),n=["parameter","storage","code"],r=e.sort((function(t,r){return n.indexOf(t.prim)-n.indexOf(r.prim)})),i.label=4;case 4:return[2,r]}}))}))},t.prototype.formatInitParam=function(t){return Zr(this,void 0,void 0,(function(){var r,e;return Xr(this,(function(n){switch(n.label){case 0:return"string"!=typeof t?[3,2]:[4,this.parseMichelineExpression(t)];case 1:if(null===(e=n.sent()))throw new Fe("Invalid init parameter",t);return r=e,[3,4];case 2:return[4,this.parseJSON(t)];case 3:r=n.sent(),n.label=4;case 4:return[2,r]}}))}))},t}(),dn={confirmationPollingIntervalSecond:10,defaultConfirmationCount:1,confirmationPollingTimeoutSecond:180,shouldObservableSubscriptionRetry:!1},gn=function(){function t(t,r,e,n,i,a,o,s){void 0===r&&(r=new ue),this._rpc=t,this._signer=r,this._proto=e,this._config=n,this.tz=new De(this),this.estimate=new We(this),this.contract=new un(this,this.estimate),this.batch=new fn(this,this.estimate),this.wallet=new Xe(this),"string"==typeof this._rpc?this._rpcClient=new d(this._rpc):this._rpcClient=this._rpc,this.config=n,this._forger=i||new oe(this),this._injector=a||new se(this),this.operationFactory=new _e(this),this._walletProvider=o||new $e(this),this._parser=s||new mn(this)}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},set:function(t){this._config=Qr(Qr({},dn),t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rpc",{get:function(){return this._rpcClient},set:function(t){this._rpcClient=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"injector",{get:function(){return this._injector},set:function(t){this._injector=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"forger",{get:function(){return this._forger},set:function(t){this._forger=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"signer",{get:function(){return this._signer},set:function(t){this._signer=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"walletProvider",{get:function(){return this._walletProvider},set:function(t){this._walletProvider=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"proto",{get:function(){return this._proto},set:function(t){this._proto=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parser",{get:function(){return this._parser},set:function(t){this._parser=t},enumerable:!1,configurable:!0}),t.prototype.isAnyProtocolActive=function(t){return void 0===t&&(t=[]),Zr(this,void 0,void 0,(function(){var r;return Xr(this,(function(e){switch(e.label){case 0:return this._proto?[2,t.includes(this._proto)]:[3,1];case 1:return[4,this.rpc.getBlockMetadata()];case 2:return r=e.sent().next_protocol,[2,t.includes(r)]}}))}))},t.prototype.clone=function(){return new t(this.rpc,this.signer,this.proto,this.config,this.forger,this._injector)},t}(),vn=function(t,r){return"opHash"in r?function(t,r){return t.hash===r.opHash}(t,r):"source"in r?function(t,r){switch(t.kind){case"endorsement":return"metadata"in t&&t.metadata.delegate===r.source;case"activate_account":return"metadata"in t&&t.pkh===r.source;default:return"source"in t&&t.source===r.source}}(t,r):"kind"in r?function(t,r){return"kind"in t&&t.kind===r.kind}(t,r):"destination"in r&&function(t,r){switch(t.kind){case"delegation":return t.delegate===r.destination;case"origination":if("metadata"in t&&"operation_result"in t.metadata&&"originated_contracts"in t.metadata.operation_result&&Array.isArray(t.metadata.operation_result.originated_contracts))return t.metadata.operation_result.originated_contracts.some((function(t){return t===r.destination}));break;case"transaction":return t.destination===r.destination;default:return!1}}(t,r)},yn=function(t,r){if(Array.isArray(r.and))return r.and.every((function(r){return bn(t,r)}));if(Array.isArray(r.or))return r.or.some((function(r){return bn(t,r)}));throw new Error("Filter expression must contains either and/or property")},bn=function(t,r){var e=[];return Array.isArray(r)?e.push.apply(e,re(r)):e.push(r),e.every((function(r){return"and"in r||"or"in r?yn(t,r):vn(t,r)}))},En=function(){function t(t,r){var e=this;void 0===r&&(r=!1),this.shouldRetry=r,this.errorListeners=[],this.messageListeners=[],this.closeListeners=[],this.completed$=new T.a,t.pipe(Object(H.a)(this.completed$),Object(S.a)((function(t){e.call(e.messageListeners,t)}),(function(t){e.call(e.errorListeners,t)}),(function(){e.call(e.closeListeners)})),this.shouldRetry?Object(B.a)():Object(S.a)(),Object(V.a)((function(){return _.a}))).subscribe()}return t.prototype.call=function(t,r){var e,n;try{for(var i=$r(t),a=i.next();!a.done;a=i.next()){var o=a.value;try{o(r)}catch(s){console.error(s)}}}catch(c){e={error:c}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.remove=function(t,r){var e=t.indexOf(r);-1!==e&&t.splice(e,1)},t.prototype.on=function(t,r){switch(t){case"data":this.messageListeners.push(r);break;case"error":this.errorListeners.push(r);break;case"close":this.closeListeners.push(r);break;default:throw new Error("Trying to register on an unsupported event: "+t)}},t.prototype.off=function(t,r){switch(t){case"data":this.remove(this.messageListeners,r);break;case"error":this.remove(this.errorListeners,r);break;case"close":this.remove(this.closeListeners,r);break;default:throw new Error("Trying to unregister on an unsupported event: "+t)}},t.prototype.close=function(){this.completed$.next()},t}(),wn=function(t){return Object(y.a)(t.rpc.getBlock()).pipe(Object(k.a)())},On=function(){function t(t,r){var e=this;void 0===r&&(r=2e4),this.context=t,this.POLL_INTERVAL=r,this.newBlock$=Object(w.a)(0,this.POLL_INTERVAL).pipe(Object(N.a)((function(){return e.context})),Object(U.a)(wn),Object(L.a)("hash"),Object(z.a)(),Object(W.a)())}return t.prototype.subscribe=function(t){return new En(this.newBlock$.pipe(Object(q.a)("hash")),this.context.config.shouldObservableSubscriptionRetry)},t.prototype.subscribeOperation=function(t){return new En(this.newBlock$.pipe(function(t){return Object(G.a)((function(r){return new I.a((function(e){var n,i,a,o,s,c;try{for(var u=$r(r.operations),p=u.next();!p.done;p=u.next()){var l=p.value;try{for(var h=(a=void 0,$r(l)),f=h.next();!f.done;f=h.next()){var m=f.value;try{for(var d=(s=void 0,$r(m.contents)),g=d.next();!g.done;g=d.next()){var v=g.value;bn(Qr({hash:m.hash},v),t)&&e.next(Qr({hash:m.hash},v))}}catch(y){s={error:y}}finally{try{g&&!g.done&&(c=d.return)&&c.call(d)}finally{if(s)throw s.error}}}}catch(b){a={error:b}}finally{try{f&&!f.done&&(o=h.return)&&o.call(h)}finally{if(a)throw a.error}}}}catch(E){n={error:E}}finally{try{p&&!p.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}e.complete()}))}))}(t)),this.context.config.shouldObservableSubscriptionRetry)},t}(),An=function(t){this.results=t,this.name="ForgingMismatchError",this.message="Forging mismatch error"},Pn=(function(){function t(t){if(this.forgers=t,0===t.length)throw new Error("At least one forger must be specified")}t.prototype.forge=function(t){var r=t.branch,e=t.contents;return Zr(this,void 0,void 0,(function(){var t,n,i;return Xr(this,(function(a){switch(a.label){case 0:return[4,Promise.all(this.forgers.map((function(t){return t.forge({branch:r,contents:e})})))];case 1:if(0===(t=a.sent()).length)throw new Error("At least one forger must be specified");for(n=t.pop();t.length;){if((i=t.pop())!==n)throw new An([n,i]);n=i}return[2,n]}}))}))}}(),function(){function t(){}t.prototype.prepareCodeOrigination=function(t){return Zr(this,void 0,void 0,(function(){return Xr(this,(function(r){return[2,t]}))}))}}(),function(){function t(t){this._rpc=t,this._options={},this.format=Ue,"string"==typeof this._rpc?this._rpcClient=new d(this._rpc):this._rpcClient=this._rpc,this._context=new gn(t),this._wallet=new Xe(this._context),this.setProvider({rpc:this._rpcClient}),this.batch=this._context.batch.batch.bind(this._context.batch)}return t.prototype.setProvider=function(t){var r=t.rpc,e=t.stream,n=t.signer,i=t.protocol,a=t.config,o=t.forger,s=t.wallet;this.setRpcProvider(r),this.setStreamProvider(e),this.setSignerProvider(n),this.setForgerProvider(o),this.setWalletProvider(s),this._context.proto=i,this._context.config=a},t.prototype.setSignerProvider=function(t){this._options.signer||void 0!==t?void 0!==t&&(this._context.signer=t,this._options.signer=t):(this._context.signer=new ue,this._options.signer=t)},t.prototype.setRpcProvider=function(t){"string"==typeof t?this._rpcClient=new d(t):t instanceof d&&(this._rpcClient=t),this._options.rpc=this._rpcClient,this._context.rpc=this._rpcClient},t.prototype.setForgerProvider=function(t){var r=void 0===t?this.getFactory(oe)():t;this._options.forger=r,this._context.forger=r},t.prototype.setStreamProvider=function(t){"string"==typeof t?this._stream=new On(new gn(new d(t))):void 0!==t?this._stream=t:void 0===this._options.stream&&(this._stream=this.getFactory(On)()),this._options.stream=t},t.prototype.setWalletProvider=function(t){if(this._options.wallet||void 0!==t)void 0!==t&&(this._options.wallet=t,this._context.walletProvider=t);else{var r=this.getFactory($e)();this._options.wallet=r,this._context.walletProvider=r}},Object.defineProperty(t.prototype,"tz",{get:function(){return this._context.tz},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contract",{get:function(){return this._context.contract},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wallet",{get:function(){return this._wallet},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"operation",{get:function(){return this._context.operationFactory},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"estimate",{get:function(){return this._context.estimate},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stream",{get:function(){return this._stream},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rpc",{get:function(){return this._context.rpc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"signer",{get:function(){return this._context.signer},enumerable:!1,configurable:!0}),t.prototype.addExtension=function(t){t.configureContext(this._context)},t.prototype.getFactory=function(t){var r=this;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new(t.bind.apply(t,re([void 0,r._context],e)))}},t}())},214:function(t,r,e){"use strict";var n=e(3),i=e(7),a=e(0),o=e.n(a),s=e(154),c=e.n(s),u=e(141),p=e(23),l=e(143),h=e(57),f=e.n(h);function m(t){var r=t.to,e=t.href,a=t.label,s=Object(i.a)(t,["to","href","label"]),c=Object(l.a)(r);return o.a.createElement(u.a,Object(n.a)({className:"footer__link-item"},e?{target:"_blank",rel:"noopener noreferrer",href:e}:{to:c},s),a)}var d=function(t){var r=t.url,e=t.alt;return o.a.createElement("img",{className:"footer__logo",alt:e,src:r})};r.a=function(){var t=Object(p.default)().siteConfig,r=(void 0===t?{}:t).themeConfig,e=(void 0===r?{}:r).footer,n=e||{},i=n.copyright,a=n.links,s=void 0===a?[]:a,u=n.logo,h=void 0===u?{}:u,g=Object(l.a)(h.src);return e?o.a.createElement("footer",{className:c()("footer",{"footer--dark":"dark"===e.style})},o.a.createElement("div",{className:"container"},s&&s.length>0&&o.a.createElement("div",{className:"row footer__links"},s.map((function(t,r){return o.a.createElement("div",{key:r,className:"col footer__col"},null!=t.title?o.a.createElement("h4",{className:"footer__title"},t.title):null,null!=t.items&&Array.isArray(t.items)&&t.items.length>0?o.a.createElement("ul",{className:"footer__items"},t.items.map((function(t,r){return t.html?o.a.createElement("div",{key:r,dangerouslySetInnerHTML:{__html:t.html}}):o.a.createElement("li",{key:t.href||t.to,className:"footer__item"},o.a.createElement(m,t))}))):null)}))),(h||i)&&o.a.createElement("div",{className:"text--center"},h&&h.src&&o.a.createElement("div",{className:"margin-bottom--sm"},h.href?o.a.createElement("a",{href:h.href,target:"_blank",rel:"noopener noreferrer",className:f.a.footerLogoLink},o.a.createElement(d,{alt:h.alt,url:g})):o.a.createElement(d,{alt:h.alt,url:g})),i))):null}},215:function(t,r,e){"use strict";(function(t){var n;e.d(r,"a",(function(){return s})),e.d(r,"b",(function(){return a})),e.d(r,"c",(function(){return n})),function(t){t[t.CONTINUE=100]="CONTINUE",t[t.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",t[t.PROCESSING=102]="PROCESSING",t[t.OK=200]="OK",t[t.CREATED=201]="CREATED",t[t.ACCEPTED=202]="ACCEPTED",t[t.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",t[t.NO_CONTENT=204]="NO_CONTENT",t[t.RESET_CONTENT=205]="RESET_CONTENT",t[t.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",t[t.MULTI_STATUS=207]="MULTI_STATUS",t[t.ALREADY_REPORTED=208]="ALREADY_REPORTED",t[t.IM_USED=226]="IM_USED",t[t.MULTIPLE_CHOICES=300]="MULTIPLE_CHOICES",t[t.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",t[t.FOUND=302]="FOUND",t[t.SEE_OTHER=303]="SEE_OTHER",t[t.NOT_MODIFIED=304]="NOT_MODIFIED",t[t.USE_PROXY=305]="USE_PROXY",t[t.SWITCH_PROXY=306]="SWITCH_PROXY",t[t.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",t[t.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",t[t.BAD_REQUEST=400]="BAD_REQUEST",t[t.UNAUTHORIZED=401]="UNAUTHORIZED",t[t.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",t[t.FORBIDDEN=403]="FORBIDDEN",t[t.NOT_FOUND=404]="NOT_FOUND",t[t.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",t[t.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",t[t.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",t[t.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",t[t.CONFLICT=409]="CONFLICT",t[t.GONE=410]="GONE",t[t.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",t[t.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",t[t.PAYLOAD_TOO_LARGE=413]="PAYLOAD_TOO_LARGE",t[t.URI_TOO_LONG=414]="URI_TOO_LONG",t[t.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",t[t.RANGE_NOT_SATISFIABLE=416]="RANGE_NOT_SATISFIABLE",t[t.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",t[t.I_AM_A_TEAPOT=418]="I_AM_A_TEAPOT",t[t.MISDIRECTED_REQUEST=421]="MISDIRECTED_REQUEST",t[t.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",t[t.LOCKED=423]="LOCKED",t[t.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",t[t.UPGRADE_REQUIRED=426]="UPGRADE_REQUIRED",t[t.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",t[t.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",t[t.REQUEST_HEADER_FIELDS_TOO_LARGE=431]="REQUEST_HEADER_FIELDS_TOO_LARGE",t[t.UNAVAILABLE_FOR_LEGAL_REASONS=451]="UNAVAILABLE_FOR_LEGAL_REASONS",t[t.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",t[t.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",t[t.BAD_GATEWAY=502]="BAD_GATEWAY",t[t.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",t[t.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",t[t.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",t[t.VARIANT_ALSO_NEGOTIATES=506]="VARIANT_ALSO_NEGOTIATES",t[t.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",t[t.LOOP_DETECTED=508]="LOOP_DETECTED",t[t.NOT_EXTENDED=510]="NOT_EXTENDED",t[t.NETWORK_AUTHENTICATION_REQUIRED=511]="NETWORK_AUTHENTICATION_REQUIRED"}(n||(n={}));var i=void 0!==t&&null!=t.versions&&null!=t.versions.node?e(446).XMLHttpRequest:XMLHttpRequest,a=function(t,r,e,n,i){this.message=t,this.status=r,this.statusText=e,this.body=n,this.url=i,this.name="HttpResponse"},o=function(t,r){this.url=t,this.innerEvent=r,this.name="HttpRequestFailed",this.message="Request to "+t+" failed"},s=function(){function t(){}return t.prototype.serialize=function(t){if(!t)return"";var r=[],e=function(e){if(t.hasOwnProperty(e)&&void 0!==t[e]){var n="function"==typeof t[e].toJSON?t[e].toJSON():t[e];if(null===n)return r.push(encodeURIComponent(e)),"continue";if(Array.isArray(n))return n.forEach((function(t){r.push(encodeURIComponent(e)+"="+encodeURIComponent(t))})),"continue";r.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}};for(var n in t)e(n);var i=r.join("&");return i?"?"+i:""},t.prototype.createXHR=function(){return new i},t.prototype.createRequest=function(t,r){var e=this,n=t.url,i=t.method,s=t.timeout,c=t.query,u=t.headers,p=void 0===u?{}:u,l=t.json,h=void 0===l||l,f=t.mimeType,m=void 0===f?void 0:f;return new Promise((function(t,u){var l=e.createXHR();for(var f in l.open(i||"GET",""+n+e.serialize(c)),p["Content-Type"]||l.setRequestHeader("Content-Type","application/json"),m&&l.overrideMimeType(""+m),p)l.setRequestHeader(f,p[f]);if(l.timeout=s||3e4,l.onload=function(){if(this.status>=200&&this.status<300)if(h)try{t(JSON.parse(l.response))}catch(r){u(new Error("Unable to parse response: "+l.response))}else t(l.response);else u(new a("Http error response: ("+this.status+") "+l.response,this.status,l.statusText,l.response,n))},l.ontimeout=function(){u(new Error("Request timed out after: "+l.timeout+"ms"))},l.onerror=function(t){u(new o(n,t))},r){var d=JSON.stringify(r);l.send(d)}else l.send()}))},t}()}).call(this,e(113))},322:function(t,r){},391:function(t,r){},412:function(t,r){},413:function(t,r,e){"use strict";(function(t){e.d(r,"a",(function(){return G})),e.d(r,"b",(function(){return M})),e.d(r,"c",(function(){return k})),e.d(r,"d",(function(){return U})),e.d(r,"e",(function(){return F})),e.d(r,"f",(function(){return g})),e.d(r,"g",(function(){return j}));var n=e(215),i=e(164),a=e(165),o=e(733),s=e.n(o),c=e(192),u=e(757),p=e.n(u);function l(t,r,e,n){return new(e||(e=Promise))((function(i,a){function o(t){try{c(n.next(t))}catch(r){a(r)}}function s(t){try{c(n.throw(t))}catch(r){a(r)}}function c(t){var r;t.done?i(t.value):(r=t.value,r instanceof e?r:new e((function(t){t(r)}))).then(o,s)}c((n=n.apply(t,r||[])).next())}))}function h(t,r){var e,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=r.call(t,o)}catch(s){a=[6,s],n=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function f(t){var r="function"==typeof Symbol&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(t,r){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var n,i,a=e.call(t),o=[];try{for(;(void 0===r||r-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(e=a.return)&&e.call(a)}finally{if(i)throw i.error}}return o}var d=function(){function t(){this.httpBackend=new n.a}return t.prototype.getMetadata=function(t,r,e){var n=r.protocol,i=r.location;return l(this,void 0,void 0,(function(){return h(this,(function(t){return[2,this.httpBackend.createRequest({url:n+":"+decodeURIComponent(i),method:"GET",mimeType:"text; charset=utf-8",json:!1})]}))}))},t}();function g(r){return t.from(Object(a.k)(r)).toString("utf8")}var v,y=function(){this.name="BigMapMetadataNotFound",this.message="Non-compliance with the TZIP-016 standard. No big map named metadata was found in the contract storage."},b=function(t){this.info=t,this.name="MetadataNotFound",this.message="No metadata was found in the contract storage. "+t},E=function(){this.name="UriNotFound",this.message="Non-compliance with the TZIP-016 standard. No URI found in the contract storage."},w=function(t){this.uri=t,this.name="InvalidUri",this.message="Non-compliance with the TZIP-016 standard. The URI is invalid: "+t+"."},O=function(t){this.invalidMetadata=t,this.name="InvalidMetadata",this.message="The metadata found at the pointed ressource are not compliant with tzip16 standard: "+t+"."},A=function(t){this.protocol=t,this.name="ProtocolNotSupported",this.message="The protocol found in the URI is not supported: "+t+"."},P=function(){this.name="InvalidMetadataType",this.message="The contract does not comply with the tzip16 standard. The type of metadata should be bytes."},T=function(){this.name="UnconfiguredMetadataProviderError",this.message="No metadata provider has been configured. The default one can be configured by calling addExtension(new Tzip16Module()) on your TezosToolkit instance."},_=function(t){this.instruction=t,this.name="ForbiddenInstructionInViewCode",this.message="Erreur found in the code of the view. It contains a forbidden instruction: "+t+"."},I=function(t,r){this.viewName=t,this.args=r,this.name="NoParameterExpectedError",this.message=t+" Received "+r.length+" arguments while expecting no parameter or 'Unit'"},S=function(t,r,e){this.viewName=t,this.sigs=r,this.args=e,this.name="InvalidViewParameterError",this.message=t+" Received "+e.length+" arguments while expecting one of the following signatures ("+JSON.stringify(r)+")"},R={prim:"big_map",args:[{prim:"string"},{prim:"bytes"}],annots:["%metadata"]},N=function(){function t(){this.TEZOS_STORAGE_REGEX=/^(?:\/\/(KT1\w{33})(?:\.(.+))?\/)?([\w|\%]+)$/}return t.prototype.getMetadata=function(t,r,e){var n=r.location;return l(this,void 0,void 0,(function(){var r,a,o,s;return h(this,(function(c){switch(c.label){case 0:if(!(r=this.parseTezosStorageUri(n)))throw new w("tezos-storage:"+n);return[4,e.rpc.getScript(r.contractAddress||t.address)];case 1:if(a=c.sent(),!(o=i.c.fromRPCResponse({script:a}).FindFirstInTopLevelPair(a.storage,R)))throw new y;return[4,e.contract.getBigMapKeyByID(o.int.toString(),r.path,new i.c(R))];case 2:if(!(s=c.sent()))throw new b("No '"+r.path+"' key found in the big map %metadata of the contract "+(r.contractAddress||t.address));if(!/^[0-9a-fA-F]*$/.test(s))throw new P;return[2,g(s)]}}))}))},t.prototype.parseTezosStorageUri=function(t){var r=this.TEZOS_STORAGE_REGEX.exec(t);if(r)return{contractAddress:r[1],network:r[2],path:decodeURIComponent(r[3])}},t}(),D=function(){function t(t){this._httpBackend=new n.a,this._ipfsGateway=t||"ipfs.io"}return t.prototype.getMetadata=function(t,r,e){var n=r.location;return l(this,void 0,void 0,(function(){return h(this,(function(t){return[2,this._httpBackend.createRequest({url:"https://"+this._ipfsGateway+"/ipfs/"+n.substring(2)+"/",method:"GET",headers:{"Content-Type":"text/plain"},mimeType:"text; charset=utf-8",json:!1})]}))}))},t}();!function(t){t.MICHELSON_STORAGE="michelsonStorageView",t.REST_API_QUERY="restApiQuery"}(v||(v={}));var k=function(){function t(t,r,e,n,i,a){this.viewName=t,this.contract=r,this.rpc=e,this.returnType=n,this.code=i,this.viewParameterType=a,this.validateArgs=function(t,r,e){var n=r.ExtractSignatures();if(!n.find((function(r){return r.length===t.length})))throw new S(e,n,t)}}return t.prototype.findForbiddenInstructionInViewCode=function(t){var r,e,n,i;try{for(var a=f(["AMOUNT","CREATE_CONTRACT","SENDER","SET_DELEGATE","SOURCE","TRANSFER_TOKENS"]),o=a.next();!o.done;o=a.next()){var s=o.value;try{for(var c=(n=void 0,f(t)),u=c.next();!u.done;u=c.next()){var p=u.value;if(p.prim===s)throw new _(s);p.args&&0!==p.args.length&&this.findForbiddenInstructionInViewCode(p.args)}}catch(l){n={error:l}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}}}catch(h){r={error:h}}finally{try{o&&!o.done&&(e=a.return)&&e.call(a)}finally{if(r)throw r.error}}},t.prototype.illegalUseOfSelfInstruction=function(t){var r,e;try{for(var n=f(t),i=n.next();!i.done;i=n.next()){var a=i.value;if("SELF"===a.prim){var o=t.indexOf(a);if("ADDRESS"!==(t[o+1]?t[o+1].prim:void 0))throw new _("the instruction SELF should only be used before ADDRESS")}a.args&&0!==a.args.length&&this.illegalUseOfSelfInstruction(a.args)}}catch(s){r={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(r)throw r.error}}},t.prototype.adaptViewCodeToContext=function(t,r,e,n){var i=this,a={SELF:[{prim:"PUSH",args:[{prim:"address"},{string:this.contract.address}]},{prim:"CONTRACT",args:[{prim:"unit"}]},{prim:"IF_NONE",args:[[{prim:"UNIT"},{prim:"FAILWITH"}],[]]}],BALANCE:[{prim:"PUSH",args:[{prim:"mutez"},{int:r}]}],NOW:[{prim:"PUSH",args:[{prim:"timestamp"},{string:e}]}],CHAIN_ID:[{prim:"PUSH",args:[{prim:"string"},{string:n}]}]};return t.forEach((function(o,s){for(var c in a)o.prim===c&&(t[s]=Object(a)[c]),o.args&&0!==o.args.length&&i.adaptViewCodeToContext(o.args,r,e,n)})),t},t.prototype.formatArgsAndParameter=function(t){var r=t,e=this.viewParameterType;if(e||(e={args:[],prim:"unit",annots:[]}),"unit"===e.prim&&(0===r.length&&(r=["Unit"]),0!==r.length&&"Unit"!==r[0]))throw new I(this.viewName,t);var n=new i.b(e);return this.validateArgs(r,n,this.viewName),{arg:n.Encode.apply(n,function(){for(var t=[],r=0;r<arguments.length;r++)t=t.concat(m(arguments[r]));return t}(r)),viewParameterType:e}},t.prototype.executeView=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return l(this,void 0,void 0,(function(){var r,e,n,a,o,s,u,p,l,f,m,d,g,v;return h(this,(function(h){switch(h.label){case 0:return this.findForbiddenInstructionInViewCode(this.code),this.illegalUseOfSelfInstruction(this.code),r=this.formatArgsAndParameter(t),e=r.arg,n=r.viewParameterType,a=this.contract.script.code.find((function(t){return"storage"===t.prim})),o=a.args[0],s=this.contract.script.storage,[4,this.rpc.getChainId()];case 1:return u=h.sent(),[4,this.rpc.getBalance(this.contract.address)];case 2:return p=h.sent().toString(),[4,this.rpc.getBlock()];case 3:return l=h.sent(),f=l.header.timestamp.toString(),m=l.protocol,d=this.adaptViewCodeToContext(this.code,p,f,u),this.viewParameterType||d.unshift({prim:"CDR"}),g={script:[{prim:"parameter",args:[{prim:"pair",args:[n,o]}]},{prim:"storage",args:[{prim:"option",args:[this.returnType]}]},{prim:"code",args:[[{prim:"CAR"},d,{prim:"SOME"},{prim:"NIL",args:[{prim:"operation"}]},{prim:"PAIR"}]]}],storage:{prim:"None"},input:{prim:"Pair",args:[e,s]},amount:"0",chain_id:u},m===c.c.PtEdo2Zk&&Object.assign(g,{balance:"0"}),[4,this.rpc.runCode(g)];case 4:return v=h.sent(),[2,new i.b(this.returnType).Execute(v.storage.args[0])]}}))}))},t}(),x=function(){function t(){}return t.prototype.getView=function(t,r,e,n){if(this.isMichelsonStorageView(n)){var i=n[v.MICHELSON_STORAGE];return i.returnType&&i.code?function(){return new k(t,e,r,i.returnType,i.code,i.parameter)}:void console.warn(t+" is missing mandatory code or returnType property therefore it will be skipped.")}},t.prototype.getImplementationType=function(t){return Object.keys(t)[0]},t.prototype.isMichelsonStorageView=function(t){return this.getImplementationType(t)===v.MICHELSON_STORAGE},t}(),C={prim:"big_map",args:[{prim:"string"},{prim:"bytes"}],annots:["%metadata"]},U=function(){function t(t,r){this.constractAbstraction=t,this.context=r,this._viewFactory=new x,this._metadataViewsObject={},this._metadataProvider=r.metadataProvider}return t.prototype.findMetadataBigMap=function(){var t=this.constractAbstraction.schema.FindFirstInTopLevelPair(this.constractAbstraction.script.storage,C);if(!t)throw new y;return new c.a(new p.a(t.int),new i.c(C),this.context.contract)},t.prototype.getUriOrFail=function(){return l(this,void 0,void 0,(function(){var t;return h(this,(function(r){switch(r.label){case 0:return[4,this.findMetadataBigMap().get("")];case 1:if(!(t=r.sent()))throw new E;return[2,t]}}))}))},t.prototype.getMetadata=function(){return l(this,void 0,void 0,(function(){var t,r;return h(this,(function(e){switch(e.label){case 0:if(!this._metadataProvider)throw new T;return this._metadataEnvelope?[3,3]:[4,this.getUriOrFail()];case 1:return t=e.sent(),r=this,[4,this._metadataProvider.provideMetadata(this.constractAbstraction,g(t),this.context)];case 2:r._metadataEnvelope=e.sent(),e.label=3;case 3:return[2,this._metadataEnvelope]}}))}))},t.prototype.metadataViews=function(){return l(this,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return 0!==Object.keys(this._metadataViewsObject).length?[3,2]:[4,this.initializeMetadataViewsList()];case 1:t.sent(),t.label=2;case 2:return[2,this._metadataViewsObject]}}))}))},t.prototype.initializeMetadataViewsList=function(){var t;return l(this,void 0,void 0,(function(){var r,e,n=this;return h(this,(function(i){switch(i.label){case 0:return[4,this.getMetadata()];case 1:return r=i.sent().metadata,e={},null===(t=r.views)||void 0===t||t.forEach((function(t){return n.createViewImplementations(t,e)})),this._metadataViewsObject=e,[2]}}))}))},t.prototype.generateIndexedViewName=function(t,r){var e=1;if(t in r){for(;""+t+e in r;)e++;t=""+t+e}return t},t.prototype.createViewImplementations=function(t,r){var e,n,i;try{for(var a=f(null!==(i=null==t?void 0:t.implementations)&&void 0!==i?i:[]),o=a.next();!o.done;o=a.next()){var s=o.value;if(t.name){var c=this.generateIndexedViewName(t.name,r),u=this._viewFactory.getView(c,this.context.rpc,this.constractAbstraction,s);u?r[c]=u:console.warn("Skipped generating "+c+" because the view has an unsupported type: "+this._viewFactory.getImplementationType(s))}}}catch(p){e={error:p}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}},t}(),L=Symbol("Tzip16ContractAbstractionObjectKey");function j(t,r){return Object.assign(t,{tzip16:function(){return this[L]||(this[L]=new U(this,r)),this[L]}})}var M=function(){function t(t){this.handlers=t,this.PROTOCOL_REGEX=/(?:sha256\:\/\/0x(.*)\/)?(https?|ipfs|tezos-storage)\:(.*)/}return t.prototype.provideMetadata=function(t,r,e){return l(this,void 0,void 0,(function(){var n,i,a,o,c;return h(this,(function(u){switch(u.label){case 0:if(!(n=this.extractProtocolInfo(r))||!n.location)throw new w(r);if(!(i=this.handlers.get(n.protocol)))throw new A(n.protocol);return[4,i.getMetadata(t,n,e)];case 1:a=u.sent(),p=a,o=s.a.SHA256(p).toString(s.a.enc.Hex);try{c=JSON.parse(a)}catch(l){throw new O(a)}return[2,{uri:r,metadata:c,integrityCheckResult:n.sha256hash?n.sha256hash===o:void 0,sha256Hash:n.sha256hash?o:void 0}]}var p}))}))},t.prototype.extractProtocolInfo=function(t){var r=this.PROTOCOL_REGEX.exec(t);if(r)return{sha256hash:r[1],protocol:r[2],location:r[3]}},t}(),G=new Map([["http",new d],["https",new d],["tezos-storage",new N],["ipfs",new D]]),F=function(){function t(t){this._metadataProvider=t||new M(G)}return t.prototype.configureContext=function(t){Object.assign(t,{metadataProvider:this._metadataProvider})},t}()}).call(this,e(111).Buffer)},451:function(t,r){},453:function(t,r){},522:function(t,r){},524:function(t,r){},537:function(t,r){},539:function(t,r){},559:function(t,r){},561:function(t,r){},589:function(t,r){},591:function(t,r){},592:function(t,r){},597:function(t,r){},599:function(t,r){},618:function(t,r){},630:function(t,r){},633:function(t,r){},640:function(t,r){},641:function(t,r){},662:function(t,r){},664:function(t,r){},692:function(t,r){},694:function(t,r){},730:function(t,r,e){"use strict";(function(t){e.d(r,"a",(function(){return c})),e.d(r,"b",(function(){return l}));var n=e(165),i=e(731),a=e.n(i);function o(t,r,e,n){return new(e||(e=Promise))((function(i,a){function o(t){try{c(n.next(t))}catch(r){a(r)}}function s(t){try{c(n.throw(t))}catch(r){a(r)}}function c(t){var r;t.done?i(t.value):(r=t.value,r instanceof e?r:new e((function(t){t(r)}))).then(o,s)}c((n=n.apply(t,r||[])).next())}))}function s(t,r){var e,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=r.call(t,o)}catch(s){a=[6,s],n=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var c;function u(r){var e=[];r.split("/").forEach((function(t){var r=parseInt(t,10);Number.isNaN(r)||(t.length>1&&"'"===t[t.length-1]&&(r+=2147483648),e.push(r))}));var n=t.alloc(1+4*e.length);return n[0]=e.length,e.forEach((function(t,r){n.writeUInt32BE(t,1+4*r)})),n}function p(r,e){var n=t.alloc(32);n.fill(0);var i=e[r],a=r+1;return i>32&&(a+=i-32,i=32),e.copy(n,32-i,a,a+i),{buffer:n,idxValueStart:a,length:i}}!function(t){t[t.ED25519=0]="ED25519",t[t.SECP256K1=1]="SECP256K1",t[t.P256=2]="P256"}(c||(c={}));var l=function(){function r(t,r,e,n){if(void 0===r&&(r="44'/1729'/0'/0'"),void 0===e&&(e=!0),void 0===n&&(n=c.ED25519),this.transport=t,this.path=r,this.prompt=e,this.derivationType=n,this.CLA=128,this.INS_GET_PUBLIC_KEY=2,this.INS_PROMPT_PUBLIC_KEY=3,this.INS_SIGN=4,this.FIRST_MESSAGE_SEQUENCE=0,this.LAST_MESSAGE_SEQUENCE=129,this.OTHER_MESSAGE_SEQUENCE=1,this.transport.setScrambleKey("XTZ"),!r.startsWith("44'/1729'"))throw new Error("The derivation path must start with 44'/1729'");if(!Object.values(c).includes(n))throw new Error("The derivation type must be DerivationType.ED25519, DerivationType.SECP256K1 or DerivationType.P256")}return r.prototype.publicKeyHash=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this._publicKeyHash?[3,2]:[4,this.publicKey()];case 1:t.sent(),t.label=2;case 2:if(this._publicKeyHash)return[2,this._publicKeyHash];throw new Error("Unable to get the public key hash.")}}))}))},r.prototype.publicKey=function(){return o(this,void 0,void 0,(function(){var t,r,e,i,o,u,p,l;return s(this,(function(s){switch(s.label){case 0:return this._publicKey?[2,this._publicKey]:[4,this.getLedgerpublicKey()];case 1:return t=s.sent(),r=t[0],e=t.slice(1,1+r),i=function(t,r){return 0===r?t=t.slice(1):(t[0]=2+(1&t[64]),t=t.slice(0,33)),t}(e,this.derivationType),o=n.n[n.a.EDPK],u=n.n[n.a.TZ1],this.derivationType===c.SECP256K1?(o=n.n[n.a.SPPK],u=n.n[n.a.TZ2]):this.derivationType===c.P256&&(o=n.n[n.a.P2PK],u=n.n[n.a.TZ3]),p=Object(n.d)(i,o),[4,a.a.ready];case 2:return s.sent(),l=Object(n.d)(a.a.crypto_generichash(20,i),u),this._publicKey=p,this._publicKeyHash=l,[2,p]}}))}))},r.prototype.getLedgerpublicKey=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=this.INS_PROMPT_PUBLIC_KEY,!1===this.prompt&&(t=this.INS_GET_PUBLIC_KEY),[4,this.transport.send(this.CLA,t,this.FIRST_MESSAGE_SEQUENCE,this.derivationType,u(this.path))];case 1:return[2,r.sent()];case 2:throw r.sent(),new Error("Unable to retrieve public key");case 3:return[2]}}))}))},r.prototype.secretKey=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){throw new Error("Secret key cannot be exposed")}))}))},r.prototype.sign=function(r,e){return o(this,void 0,void 0,(function(){var i,a,o,l,h,f,m,d,g;return s(this,(function(s){switch(s.label){case 0:return i=function(r,e){var n=r;return void 0!==e&&(n=t.from(e).toString("hex").concat(r)),n}(r,e),a=t.from(i,"hex"),(o=[]).push(u(this.path)),o=function(r,e){for(var n=0;n!==e.length;){var i=n+230>=e.length?e.length-n:230,a=t.alloc(i);e.copy(a,0,n,n+i),r.push(a),n+=i}return r}(o,a),[4,this.signWithLedger(o)];case 1:if(l=s.sent(),this.derivationType===c.ED25519)h=l.slice(0,l.length-2).toString("hex");else{if(!function(t){var r=!0;49!==t[0]&&48!==t[0]&&(r=!1),t[1]+4!==t.length&&(r=!1),2!==t[2]&&(r=!1);var e=t[3];2!==t[4+e]&&(r=!1);var n=5+e;return n+1+t[n]+2!==t.length&&(r=!1),r}(l))throw new Error("Cannot parse ledger response.");3,f=p(3,l),m=f.idxValueStart+f.length+1,d=p(m,l),g=t.concat([f.buffer,d.buffer]),h=g.toString("hex")}return[2,{bytes:r,sig:Object(n.d)(h,n.n[n.a.SIG]),prefixSig:Object(n.d)(h,n.n[n.a.SIG]),sbytes:r+h}]}}))}))},r.prototype.signWithLedger=function(t){return o(this,void 0,void 0,(function(){var r,e,n;return s(this,(function(i){switch(i.label){case 0:return[4,this.transport.send(this.CLA,this.INS_SIGN,this.FIRST_MESSAGE_SEQUENCE,this.derivationType,t[0])];case 1:r=i.sent(),e=1,i.label=2;case 2:return e<t.length?(n=e===t.length-1?this.LAST_MESSAGE_SEQUENCE:this.OTHER_MESSAGE_SEQUENCE,[4,this.transport.send(this.CLA,this.INS_SIGN,n,this.derivationType,t[e])]):[3,5];case 3:r=i.sent(),i.label=4;case 4:return e++,[3,2];case 5:return[2,r]}}))}))},r}()}).call(this,e(111).Buffer)},802:function(t,r,e){"use strict";var n=e(3),i=e(7),a=e(23),o=e(192),s=e(556),c=e.n(s),u=e(165),p=e(636),l=e.n(p),h=e(638),f=e.n(h),m=e(372),d=e.n(m),g=e(674);function v(t,r,e,n){return new(e||(e=Promise))((function(i,a){function o(t){try{c(n.next(t))}catch(r){a(r)}}function s(t){try{c(n.throw(t))}catch(r){a(r)}}function c(t){var r;t.done?i(t.value):(r=t.value,r instanceof e?r:new e((function(t){t(r)}))).then(o,s)}c((n=n.apply(t,r||[])).next())}))}function y(t,r){var e,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=r.call(t,o)}catch(s){a=[6,s],n=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var b=function(){function t(t,r,e){this.key=t;var n=t.substr(0,r?5:4);if(!Object(u.l)(n))throw new Error("key contains invalid prefix");if(this._key=e(Object(u.c)(this.key,u.n[n])),this._publicKey=this._key.slice(32),!this._key)throw new Error("Unable to decode key");this.isInit=this.init()}return t.prototype.init=function(){return v(this,void 0,void 0,(function(){var t,r,e;return y(this,(function(n){switch(n.label){case 0:return[4,c.a.ready];case 1:return n.sent(),64!==this._key.length&&(t=c.a.crypto_sign_seed_keypair(new Uint8Array(this._key),"uint8array"),r=t.publicKey,e=t.privateKey,this._publicKey=r,this._key=e),[2,!0]}}))}))},t.prototype.sign=function(t,r){return v(this,void 0,void 0,(function(){var e,n,i;return y(this,(function(a){switch(a.label){case 0:return[4,this.isInit];case 1:return a.sent(),e=c.a.crypto_sign_detached(new Uint8Array(r),new Uint8Array(this._key)),n=l()(e),i=t+Object(u.f)(n),[2,{bytes:t,sig:Object(u.d)(e,u.n.sig),prefixSig:Object(u.d)(e,u.n.edsig),sbytes:i}]}}))}))},t.prototype.publicKey=function(){return v(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this.isInit];case 1:return t.sent(),[2,Object(u.d)(this._publicKey,u.n.edpk)]}}))}))},t.prototype.publicKeyHash=function(){return v(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,this.isInit];case 1:return t.sent(),[4,c.a.ready];case 2:return t.sent(),[2,Object(u.d)(c.a.crypto_generichash(20,new Uint8Array(this._publicKey)),u.n.tz1)]}}))}))},t.prototype.secretKey=function(){return v(this,void 0,void 0,(function(){var t,r;return y(this,(function(e){switch(e.label){case 0:return[4,this.isInit];case 1:return e.sent(),[4,c.a.ready];case 2:return e.sent(),t=this._key,r=c.a.crypto_sign_seed_keypair(new Uint8Array(t).slice(0,32),"uint8array").privateKey,t=l()(r),[2,Object(u.d)(t,u.n.edsk)]}}))}))},t}(),E={p256:{pk:u.n.p2pk,sk:u.n.p2sk,pkh:u.n.tz3,sig:u.n.p2sig},secp256k1:{pk:u.n.sppk,sk:u.n.spsk,pkh:u.n.tz2,sig:u.n.spsig}},w=function(){function t(t,r,e,n){this.curve=t,this.key=r;var i=r.substr(0,e?5:4);if(!Object(u.l)(i))throw new Error("key contains invalid prefix");this._key=n(Object(u.c)(this.key,u.n[i]));var a=new f.a.ec(this.curve).keyFromPrivate(this._key),o=a.getPublic().getY().toArray()[31]%2?3:2,s=new Array(32).fill(0);this._publicKey=l()(new Uint8Array([o].concat(s.concat(a.getPublic().getX().toArray()).slice(-32))))}return t.prototype.sign=function(t,r){return v(this,void 0,void 0,(function(){var e,n,i,a;return y(this,(function(o){return e=new f.a.ec(this.curve).keyFromPrivate(this._key),n=e.sign(r,{canonical:!0}),i=n.r.toString("hex",64)+n.s.toString("hex",64),a=t+i,[2,{bytes:t,sig:Object(u.d)(i,u.n.sig),prefixSig:Object(u.d)(i,E[this.curve].sig),sbytes:a}]}))}))},t.prototype.publicKey=function(){return v(this,void 0,void 0,(function(){return y(this,(function(t){return[2,Object(u.d)(this._publicKey,E[this.curve].pk)]}))}))},t.prototype.publicKeyHash=function(){return v(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,c.a.ready];case 1:return t.sent(),[2,Object(u.d)(c.a.crypto_generichash(20,new Uint8Array(this._publicKey)),E[this.curve].pkh)]}}))}))},t.prototype.secretKey=function(){return v(this,void 0,void 0,(function(){var t;return y(this,(function(r){return t=this._key,[2,Object(u.d)(t,E[this.curve].sk)]}))}))},t}(),O=w.bind(null,"p256"),A=w.bind(null,"secp256k1");function P(t,r,e,n,i){return v(this,void 0,void 0,(function(){var a,o,s,c;return y(this,(function(u){switch(u.label){case 0:return r&&e&&n&&i?(c=T.fromFundraiser(r,e,n),t.setProvider({signer:c}),[4,c.publicKeyHash()]):[3,8];case 1:a=u.sent(),o=void 0,u.label=2;case 2:return u.trys.push([2,4,,5]),[4,t.tz.activate(a,i)];case 3:return o=u.sent(),[3,5];case 4:if(s=u.sent(),!(s&&s.body&&/Invalid activation/.test(s.body)))throw s;return[3,5];case 5:return o?[4,o.confirmation()]:[3,7];case 6:u.sent(),u.label=7;case 7:return[3,10];case 8:return[4,T.fromSecretKey(r,e)];case 9:c=u.sent(),t.setProvider({signer:c}),u.label=10;case 10:return[2]}}))}))}var T=function(){function t(t,r){var e="e"===t.substring(2,3),n=function(t){return t};if(e){if(!r)throw new Error("Encrypted key provided without a passphrase.");n=function(t){var e=l()(t.slice(0,8)),n=t.slice(8),i=d.a.pbkdf2Sync(r,e,32768,32,"sha512");return c.a.crypto_secretbox_open_easy(new Uint8Array(n),new Uint8Array(24),new Uint8Array(i))}}switch(t.substr(0,4)){case"edes":case"edsk":this._key=new b(t,e,n);break;case"spsk":case"spes":this._key=new A(t,e,n);break;case"p2sk":case"p2es":this._key=new O(t,e,n);break;default:throw new Error("Unsupported key type")}}return t.fromFundraiser=function(r,e,n){var i=Object(g.mnemonicToSeedSync)(n,""+r+e);return new t(Object(u.d)(i.slice(0,32),u.n.edsk2))},t.fromSecretKey=function(r,e){return v(this,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return[4,c.a.ready];case 1:return n.sent(),[2,new t(r,e)]}}))}))},t.prototype.sign=function(t,r){return v(this,void 0,void 0,(function(){var e,n;return y(this,(function(i){switch(i.label){case 0:return e=Object(u.k)(t),void 0!==r&&(e=Object(u.m)(r,e)),[4,c.a.ready];case 1:return i.sent(),n=l()(c.a.crypto_generichash(32,e)),[2,this._key.sign(t,n)]}}))}))},t.prototype.publicKey=function(){return v(this,void 0,void 0,(function(){return y(this,(function(t){return[2,this._key.publicKey()]}))}))},t.prototype.publicKeyHash=function(){return v(this,void 0,void 0,(function(){return y(this,(function(t){return[2,this._key.publicKeyHash()]}))}))},t.prototype.secretKey=function(){return v(this,void 0,void 0,(function(){return y(this,(function(t){return[2,this._key.secretKey()]}))}))},t}(),_=e(212),I=function(){return(I=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var i in r=arguments[e])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};function S(t,r,e,n){return new(e||(e=Promise))((function(i,a){function o(t){try{c(n.next(t))}catch(r){a(r)}}function s(t){try{c(n.throw(t))}catch(r){a(r)}}function c(t){var r;t.done?i(t.value):(r=t.value,r instanceof e?r:new e((function(t){t(r)}))).then(o,s)}c((n=n.apply(t,r||[])).next())}))}function R(t,r){var e,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=r.call(t,o)}catch(s){a=[6,s],n=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var N=function(){this.name="BeaconWalletNotInitialized",this.message="You need to initialize BeaconWallet by calling beaconWallet.requestPermissions first"},D=function(t){this.requiredScopes=t,this.name="MissingRequiredScopes",this.message="Required permissions scopes were not granted: "+t.join(",")},k=function(){function t(t){this.client=new _.i(t)}return t.prototype.validateRequiredScopesOrFail=function(t,r){var e,n,i=new Set(r);try{for(var a=function(t){var r="function"==typeof Symbol&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),o=a.next();!o.done;o=a.next()){var s=o.value;i.has(s)&&i.delete(s)}}catch(c){e={error:c}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}if(i.size>0)throw new D(Array.from(i))},t.prototype.requestPermissions=function(t){return S(this,void 0,void 0,(function(){return R(this,(function(r){switch(r.label){case 0:return[4,this.client.requestPermissions(t)];case 1:return r.sent(),[2]}}))}))},t.prototype.removeFeeAndLimit=function(t){return t.fee,t.gas_limit,t.storage_limit,function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(e[n[i]]=t[n[i]])}return e}(t,["fee","gas_limit","storage_limit"])},t.prototype.getPKH=function(){return S(this,void 0,void 0,(function(){var t;return R(this,(function(r){switch(r.label){case 0:return[4,this.client.getActiveAccount()];case 1:if(!(t=r.sent()))throw new N;return[2,t.address]}}))}))},t.prototype.mapTransferParamsToWalletParams=function(t){return Object(o.i)(t)},t.prototype.mapOriginateParamsToWalletParams=function(t){return Object(o.g)(t)},t.prototype.mapDelegateParamsToWalletParams=function(t){return Object(o.h)(t)},t.prototype.sendOperations=function(t){return S(this,void 0,void 0,(function(){var r,e,n=this;return R(this,(function(i){switch(i.label){case 0:return[4,this.client.getActiveAccount()];case 1:if(!(r=i.sent()))throw new N;return e=r.scopes,this.validateRequiredScopesOrFail(e,[_.x.OPERATION_REQUEST]),[4,this.client.requestOperation({operationDetails:t.map((function(t){return I({},n.removeFeeAndLimit(t))}))})];case 2:return[2,i.sent().transactionHash]}}))}))},t.prototype.disconnect=function(){return S(this,void 0,void 0,(function(){return R(this,(function(t){switch(t.label){case 0:return[4,this.client.destroy()];case 1:return t.sent(),[2]}}))}))},t.prototype.clearActiveAccount=function(){return S(this,void 0,void 0,(function(){return R(this,(function(t){switch(t.label){case 0:return[4,this.client.setActiveAccount()];case 1:return t.sent(),[2]}}))}))},t}(),x=e(730),C=function(){return(C=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var i in r=arguments[e])Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);return t}).apply(this,arguments)};function U(t,r,e,n){return new(e||(e=Promise))((function(i,a){function o(t){try{c(n.next(t))}catch(r){a(r)}}function s(t){try{c(n.throw(t))}catch(r){a(r)}}function c(t){var r;t.done?i(t.value):(r=t.value,r instanceof e?r:new e((function(t){t(r)}))).then(o,s)}c((n=n.apply(t,r||[])).next())}))}function L(t,r){var e,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=r.call(t,o)}catch(s){a=[6,s],n=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var j=function(){this.name="TezBridgeNotDetectedError",this.message="tezbridge plugin could not be detected in your browser"},M=function(){function t(){if("undefined"==typeof tezbridge)throw new j}return t.prototype.getPKH=function(){return U(this,void 0,void 0,(function(){return L(this,(function(t){return[2,tezbridge.request({method:"get_source"})]}))}))},t.prototype.setHost=function(t){return U(this,void 0,void 0,(function(){return L(this,(function(r){switch(r.label){case 0:return[4,tezbridge.request({method:"set_host",host:t})];case 1:return r.sent(),[2]}}))}))},t.prototype.mapTransferParamsToWalletParams=function(t){return Object(o.i)(t)},t.prototype.mapOriginateParamsToWalletParams=function(t){return Object(o.g)(t)},t.prototype.mapDelegateParamsToWalletParams=function(t){return Object(o.h)(t)},t.prototype.sendOperations=function(t){return U(this,void 0,void 0,(function(){var r=this;return L(this,(function(e){switch(e.label){case 0:return[4,tezbridge.request({method:"inject_operations",operations:t.map((function(t){return C({},r.removeFeeAndLimit(t))}))})];case 1:return[2,e.sent().operation_id]}}))}))},t.prototype.removeFeeAndLimit=function(t){return t.fee,t.gas_limit,t.storage_limit,function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(e[n[i]]=t[n[i]])}return e}(t,["fee","gas_limit","storage_limit"])},t}(),G=e(413),F=e(164);function K(t,r,e,n){return new(e||(e=Promise))((function(i,a){function o(t){try{c(n.next(t))}catch(r){a(r)}}function s(t){try{c(n.throw(t))}catch(r){a(r)}}function c(t){var r;t.done?i(t.value):(r=t.value,r instanceof e?r:new e((function(t){t(r)}))).then(o,s)}c((n=n.apply(t,r||[])).next())}))}function H(t,r){var e,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;o;)try{if(e=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=r.call(t,o)}catch(s){a=[6,s],n=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function B(t){var r="function"==typeof Symbol&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}var V=function(t){this.address=t,this.name="TokenMetadataNotFound",this.message="No token metadata was found for the contract: "+t},z=function(t){this.tokenId=t,this.name="TokenIdNotFound",this.message="Could not find token metadata for the token ID: "+t},W=function(){this.name="InvalidTokenMetadata",this.message="Non-compliance with the TZIP-012 standard. The required property `decimals` is missing."},q={prim:"big_map",args:[{prim:"nat"},{prim:"pair",args:[{prim:"nat",annots:["%token_id"]},{prim:"map",args:[{prim:"string"},{prim:"bytes"}],annots:["%token_info"]}]}],annots:["%token_metadata"]},Y=function(){function t(t,r){this.contractAbstraction=t,this.context=r,this._tzip16ContractAbstraction=new G.d(this.contractAbstraction,this.context)}return t.prototype.getContractMetadata=function(){return K(this,void 0,void 0,(function(){return H(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this._tzip16ContractAbstraction.getMetadata()];case 1:return[2,t.sent().metadata];case 2:return t.sent(),[3,3];case 3:return[2]}}))}))},t.prototype.isTzip12Compliant=function(){var t;return K(this,void 0,void 0,(function(){var r,e,n;return H(this,(function(i){switch(i.label){case 0:return r=!1,[4,this.getContractMetadata()];case 1:return(e=i.sent())&&(n=null===(t=e.interfaces)||void 0===t?void 0:t.filter((function(t){return"TZIP-012"===t.substring(0,8)})),r=!(!n||0===n.length)),[2,r]}}))}))},t.prototype.getTokenMetadata=function(t){return K(this,void 0,void 0,(function(){return H(this,(function(r){switch(r.label){case 0:return[4,this.retrieveTokenMetadataFromView(t)];case 1:return[2,r.sent()||this.retrieveTokenMetadataFromBigMap(t)]}}))}))},t.prototype.retrieveTokenMetadataFromView=function(t){return K(this,void 0,void 0,(function(){var r;return H(this,(function(e){switch(e.label){case 0:return[4,this.getContractMetadata()];case 1:return e.sent()?[4,this._tzip16ContractAbstraction.metadataViews()]:[3,3];case 2:if((r=e.sent())&&this.hasTokenMetadataView(r))return[2,this.executeTokenMetadataView(r.token_metadata(),t)];e.label=3;case 3:return[2]}}))}))},t.prototype.hasTokenMetadataView=function(t){var r,e;try{for(var n=B(Object.keys(t)),i=n.next();!i.done;i=n.next()){if("token_metadata"===i.value)return!0}}catch(a){r={error:a}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(r)throw r.error}}return!1},t.prototype.executeTokenMetadataView=function(t,r){return K(this,void 0,void 0,(function(){var e,n,i;return H(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,t.executeView(r)];case 1:return e=a.sent(),[3,3];case 2:throw a.sent(),new z(r);case 3:if(n=Object.values(e)[1],!F.a.isMichelsonMap(n))throw new V(this.contractAbstraction.address);return[4,this.fetchTokenMetadataFromUri(n)];case 4:return i=a.sent(),[2,this.formatMetadataToken(r,n,i)]}}))}))},t.prototype.fetchTokenMetadataFromUri=function(t){return K(this,void 0,void 0,(function(){var r,e;return H(this,(function(n){switch(n.label){case 0:if(!(r=t.get("")))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.context.metadataProvider.provideMetadata(this.contractAbstraction,Object(G.f)(r),this.context)];case 2:return[2,n.sent().metadata];case 3:if("InvalidUri"!==(e=n.sent()).name)throw e;return console.warn("The URI "+Object(G.f)(r)+" is present in the token metadata, but is invalid."),[3,4];case 4:return[2]}}))}))},t.prototype.formatMetadataToken=function(t,r,e){var n,i,a,o,s,c={token_id:t};try{for(var u=B(r.keys()),p=u.next();!p.done;p=u.next()){var l=p.value;"decimals"===l?Object.assign(c,((a={})[l]=Number(Object(G.f)(r.get(l))),a)):""!==l&&Object.assign(c,((o={})[l]=Object(G.f)(r.get(l)),o))}}catch(f){n={error:f}}finally{try{p&&!p.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}if(e)for(var h in e)Object.assign(c,((s={})[h]=e[h],s));if(!("decimals"in c))throw new W;return c},t.prototype.retrieveTokenMetadataFromBigMap=function(t){return K(this,void 0,void 0,(function(){var r,e,n,i;return H(this,(function(a){switch(a.label){case 0:r=this.findTokenMetadataBigMap(),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.context.contract.getBigMapKeyByID(r.int.toString(),t.toString(),new F.c(q))];case 2:return e=a.sent(),[3,4];case 3:throw a.sent(),new z(t);case 4:if(n=e.token_info,!F.a.isMichelsonMap(n))throw new z(t);return[4,this.fetchTokenMetadataFromUri(n)];case 5:return i=a.sent(),[2,this.formatMetadataToken(t,n,i)]}}))}))},t.prototype.findTokenMetadataBigMap=function(){var t=this.contractAbstraction.schema.FindFirstInTopLevelPair(this.contractAbstraction.script.storage,q);if(!t)throw new V(this.contractAbstraction.address);return t},t}(),Q=Symbol("Tzip12ContractAbstractionObjectKey");function J(t,r){return Object.assign(t,{tzip12:function(){return this[Q]||(this[Q]=new Y(this,r)),this[Q]}})}var Z=function(){function t(t){this._metadataProvider=t||new G.b(G.a)}return t.prototype.configureContext=function(t){Object.assign(t,{metadataProvider:this._metadataProvider})},t}(),X=e(803),$=e(758),tt=e(4),rt=e(154),et=e.n(rt),nt=e(416),it=e.n(nt),at=e(0),ot=e.n(at),st=e(764),ct=e(70),ut=e.n(ct),pt=function(t){function r(){var r;return(r=t.call(this)||this).onChange=function(t){r.code=t},r}Object(tt.a)(r,t);var e=r.prototype;return e.UNSAFE_componentWillMount=function(){this.code=this.props.code},e.componentDidUpdate=function(){},e.run=function(){var t=this.props,r=t.scope,e=t.transformCode,n=t.noInline,i='\nlet _printlnBuffer = "";\n\nfunction println(value) {\n  _printlnBuffer += value + "\\n";\n\n  render(_printlnBuffer);\n}\n\nTezos.setProvider({ rpc: \'https://api.tez.ie/rpc/delphinet\' });\n\n'+(this.props.wallet?'const network = {type:"delphinet"};\n  wallet.requestPermissions({network})\n  .then(permission => {\n    return Tezos.setWalletProvider(wallet);\n  })\n  .then(() => {\n    '+this.code+"\n  });":"fetch('https://api.tez.ie/keys/delphinet/', {\n    method: 'POST',\n    headers: { Authorization: 'Bearer taquito-example' },\n  })\n  .then(response => response.text())\n  .then(privateKey => {\n    return importKey(Tezos, privateKey);\n   })\n  .then(() => {\n    "+this.code+"\n   });")+'\n\n//contract used in example "estimate a contract origination"\nconst genericMultisigJSONfile = \n[ { "prim": "parameter","args":[ { "prim": "or","args":[ { "prim": "unit", "annots": [ "%default" ] },{ "prim": "pair","args":[ { "prim": "pair","args":[ { "prim": "nat","annots": [ "%counter" ] },{ "prim": "or","args":[ { "prim": "lambda","args":[ { "prim": "unit" },{ "prim": "list","args":[ { "prim":"operation" } ] } ],"annots":[ "%operation" ] },{ "prim": "pair", "args":[ { "prim": "nat","annots":[ "%threshold" ] },{ "prim": "list",\n"args":[ { "prim": "key" } ],"annots":[ "%keys" ] } ],"annots":[ "%change_keys" ] } ],"annots": [ ":action" ] } ],"annots": [ ":payload" ] },{ "prim": "list","args":[ { "prim": "option","args":[ { "prim": "signature" } ] } ],"annots": [ "%sigs" ] } ],"annots": [ "%main" ] } ] } ] },\n{ "prim": "storage","args":[ { "prim": "pair","args":[ { "prim": "nat","annots": [ "%stored_counter" ] },{ "prim": "pair","args":[ { "prim": "nat", "annots": [ "%threshold" ] },{ "prim": "list","args": [ { "prim": "key" } ],"annots": [ "%keys" ] } ] } ] } ] },\n{ "prim": "code","args":[ [ [ [ { "prim": "DUP" }, { "prim": "CAR" },{ "prim": "DIP","args": [ [ { "prim": "CDR" } ] ] } ] ],{ "prim": "IF_LEFT","args":[ [ { "prim": "DROP" },{ "prim": "NIL","args": [ { "prim": "operation" } ] },{ "prim": "PAIR" } ],[ { "prim": "PUSH","args":[ { "prim": "mutez" },{ "int": "0" } ] },{ "prim": "AMOUNT" },[ [ { "prim": "COMPARE" },{ "prim": "EQ" } ], { "prim": "IF","args":[ [],[ [ { "prim": "UNIT" },{ "prim": "FAILWITH" } ] ] ] } ],{ "prim": "SWAP" }, \n{ "prim": "DUP" },{ "prim": "DIP","args": [ [ { "prim": "SWAP" } ] ] },{ "prim": "DIP","args":[ [ [ [ { "prim": "DUP" },{ "prim": "CAR" },{ "prim": "DIP","args":[ [ { "prim": "CDR" } ] ] } ] ],{ "prim": "DUP" },{ "prim": "SELF" },{ "prim": "ADDRESS" },{ "prim": "PAIR" },{ "prim": "PACK" },{ "prim": "DIP","args":[ [ [ [ { "prim": "DUP" },{ "prim": "CAR","annots":[ "@counter" ] },{ "prim": "DIP","args":[ [ { "prim":"CDR" } ] ] } ] ],{ "prim": "DIP","args":[ [ { "prim": "SWAP" } ] ] } ] ] },{ "prim": "SWAP" } ] ] },\n[ [ { "prim": "DUP" },{ "prim": "CAR","annots": [ "@stored_counter" ] },{ "prim": "DIP","args": [ [ { "prim": "CDR" } ] ] } ] ],{ "prim": "DIP","args": [ [ { "prim": "SWAP" } ] ] },[ [ { "prim": "COMPARE" },{ "prim": "EQ" } ],{ "prim": "IF","args":[ [],[ [ { "prim": "UNIT" },{ "prim": "FAILWITH" } ] ] ] } ],{ "prim": "DIP","args": [ [ { "prim": "SWAP" } ] ] },[ [ { "prim": "DUP" },{ "prim": "CAR","annots": [ "@threshold" ] },{ "prim": "DIP","args":[ [ { "prim": "CDR","annots": [ "@keys" ] } ] ] } ] ],\n{ "prim": "DIP","args":[ [ { "prim": "PUSH","args":[ { "prim": "nat" },{ "int": "0" } ],"annots": [ "@valid" ] },{ "prim": "SWAP" },{ "prim": "ITER","args":[ [ { "prim": "DIP","args":[ [ { "prim": "SWAP" } ] ] },{ "prim": "SWAP" },{ "prim": "IF_CONS","args":[ [ [ { "prim":"IF_NONE","args":[ [ { "prim":"SWAP" },{ "prim":"DROP" } ],[ { "prim":"SWAP" },{ "prim":"DIP","args":[ [ { "prim":"SWAP" },{ "prim":"DIP","args":[ { "int":"2" },[ [ { "prim":"DIP","args":[ [ { "prim":"DUP" } ] ] },{ "prim":"SWAP" } ] ] ] },\n[ [ { "prim":"DIP","args":[ { "int":"2" },[ { "prim":"DUP" } ] ] },{ "prim":"DIG","args":[ { "int":"3" } ] } ],{ "prim":"DIP","args":[ [ { "prim":"CHECK_SIGNATURE" } ] ] },{ "prim":"SWAP" },{ "prim":"IF","args":[ [ { "prim":"DROP" } ],[ { "prim":"FAILWITH" } ] ] } ],{ "prim":"PUSH","args":[ { "prim":"nat" },{ "int":"1" } ] },{ "prim":"ADD","annots":[ "@valid" ] } ] ] } ] ] } ] ],[ [ { "prim":"UNIT" },{ "prim":"FAILWITH" } ] ] ] },{ "prim": "SWAP" } ] ] } ] ] },[ [ { "prim": "COMPARE" },{ "prim": "LE" } ],{ "prim": "IF","args":[ [],\n[ [ { "prim": "UNIT" },{ "prim": "FAILWITH" } ] ] ] } ],{ "prim": "IF_CONS","args":[ [ [ { "prim": "UNIT" },{ "prim": "FAILWITH" } ] ],[] ] }, { "prim": "DROP" },{ "prim": "DIP","args":[ [ [ [ { "prim": "DUP" },{ "prim": "CAR" },{ "prim": "DIP","args":[ [ { "prim": "CDR" } ] ] } ] ],{ "prim": "PUSH","args":[ { "prim": "nat" },{ "int": "1" } ] },{ "prim": "ADD","annots": [ "@new_counter" ] },{ "prim": "PAIR" } ] ] },{ "prim": "IF_LEFT","args":[ [ { "prim": "UNIT" },{ "prim": "EXEC" } ],[ { "prim": "DIP","args":[ [ { "prim": "CAR" } ] ] },\n{ "prim": "SWAP" },{ "prim": "PAIR" },{ "prim": "NIL","args":[ { "prim": "operation" } ] } ] ] },{ "prim": "PAIR" } ] ] } ] ] } ]\n\n//contract for the example "Contract origination with map in storage having initial values"\nconst contractMapTacoShop = \n[ { "prim": "parameter", "args": [ { "prim": "nat" } ] },\n{ "prim": "storage","args":[ { "prim": "map","args":[ { "prim": "nat" },{ "prim": "pair","args":[ { "prim": "nat", "annots": [ "%current_stock" ] },{ "prim": "mutez", "annots": [ "%max_price" ] } ] } ] } ] },\n{ "prim": "code","args":[ [ { "prim": "DUP" }, { "prim": "CAR" },{ "prim": "DIG", "args": [ { "int": "1" } ] }, { "prim": "DUP" },{ "prim": "DUG", "args": [ { "int": "2" } ] }, { "prim": "CDR" },{ "prim": "DUP" }, { "prim": "DIG", "args": [ { "int": "2" } ] },{ "prim": "DUP" }, { "prim": "DUG", "args": [ { "int": "3" } ] },{ "prim": "GET" },{ "prim": "IF_NONE","args":[ [ { "prim": "PUSH","args":[ { "prim": "string" },{ "string": "Unknown kind of taco." } ] },{ "prim": "FAILWITH" } ],[ { "prim": "DUP" },{ "prim": "DIP", "args": [ [ { "prim": "DROP" } ] ] } ] ] },\n{ "prim": "DUP" }, { "prim": "CAR" },{ "prim": "DIG", "args": [ { "int": "1" } ] }, { "prim": "DUP" },{ "prim": "DUG", "args": [ { "int": "2" } ] }, { "prim": "CDR" },{ "prim": "EDIV" },{ "prim": "IF_NONE","args":[ [ { "prim": "PUSH","args":[ { "prim": "string" }, { "string": "DIV by 0" } ] },{ "prim": "FAILWITH" } ], [] ] }, { "prim": "CAR" },{ "prim": "DUP" }, { "prim": "AMOUNT" }, { "prim": "COMPARE" },{ "prim": "NEQ" },{ "prim": "IF","args":[ [ { "prim": "PUSH","args":[ { "prim": "string" },{ "string":"Sorry, the taco you are trying to purchase has a different price" } ] },\n{ "prim": "FAILWITH" } ],[ { "prim": "PUSH","args": [ { "prim": "unit" }, { "prim": "Unit" } ] } ] ] },{ "prim": "DIG", "args": [ { "int": "2" } ] }, { "prim": "DUP" },{ "prim": "DUG", "args": [ { "int": "3" } ] },{ "prim": "PUSH", "args": [ { "prim": "nat" }, { "int": "1" } ] },{ "prim": "DIG", "args": [ { "int": "4" } ] }, { "prim": "DUP" },{ "prim": "DUG", "args": [ { "int": "5" } ] }, { "prim": "CAR" },{ "prim": "SUB" }, { "prim": "ABS" }, { "prim": "SWAP" },{ "prim": "CDR" }, { "prim": "SWAP" }, { "prim": "PAIR" },{ "prim": "DIG", "args": [ { "int": "4" } ] }, { "prim": "DUP" },\n{ "prim": "DUG", "args": [ { "int": "5" } ] },{ "prim": "DIG", "args": [ { "int": "1" } ] }, { "prim": "DUP" },{ "prim": "DUG", "args": [ { "int": "2" } ] },{ "prim": "DIG", "args": [ { "int": "7" } ] }, { "prim": "DUP" },{ "prim": "DUG", "args": [ { "int": "8" } ] }, { "prim": "SWAP" },{ "prim": "SOME" }, { "prim": "SWAP" }, { "prim": "UPDATE" },{ "prim": "NIL", "args": [ { "prim": "operation" } ] },{ "prim": "PAIR" },{ "prim": "DIP","args": [ [ { "prim": "DROP", "args": [ { "int": "7" } ] } ] ] } ] ] } ]\n\n\n//contract for the example of map wih pair key\nconst contractMapPairKey = \n[ { "prim": "parameter", "args": [ { "prim": "unit" } ] },\n{ "prim": "storage","args":[ { "prim": "pair","args":[ { "prim": "pair","args":[ { "prim": "address", "annots": [ "%theAddress" ] },\n{ "prim": "map","args":[ { "prim": "pair","args":[ { "prim": "nat" }, { "prim": "address" } ] },{ "prim": "pair","args":[ { "prim": "mutez", "annots": [ "%amount" ] },{ "prim": "int", "annots": [ "%quantity" ] } ] } ],"annots": [ "%theMap" ] } ] },{ "prim": "int", "annots": [ "%theNumber" ] } ] } ] },\n{ "prim": "code","args":[ [ { "prim": "DUP" }, { "prim": "CDR" },{ "prim": "NIL", "args": [ { "prim": "operation" } ] },{ "prim": "PAIR" },{ "prim": "DIP", "args": [ [ { "prim": "DROP" } ] ] } ] ] } ]\n\n//contract for the example of map in storage with 8 nested pairs\nconst contractMap8pairs = \n[{ "prim": "parameter", "args": [{ "prim": "unit" }] },{"prim": "storage","args":[{prim: \'map\',args: [{prim: "pair", args: [{ prim: "int" },{prim: "pair", args: [{ prim: "nat" },{prim: "pair", args: [{ prim: "string" },{prim: "pair", args: [{ prim: "bytes" },{prim: "pair", args: [{ prim: "mutez" },{prim: "pair", args: [{ prim: "bool" },{prim: "pair", args: [{ prim: "key_hash" },{prim: "pair", args: [{ prim: "timestamp" },{ prim: "address" }]}]}]}]}]}]}]}]}, { prim: "int" }]},]},{"prim": "code","args":[[{ "prim": "DUP" }, { "prim": "CDR" },{ "prim": "NIL", "args": [{ "prim": "operation" }] },\n{ "prim": "PAIR" },{ "prim": "DIP", "args": [[{ "prim": "DROP" }]] }]]}]\n\n//contract for map and bigmap combined example\nconst contractMapBigMap = \n[ { "prim": "parameter", "args": [ { "prim": "unit" } ] },{ "prim": "storage","args":[ { "prim": "pair","args":[ { "prim": "big_map","args":[ { "prim": "pair","args": [ { "prim": "nat" }, { "prim": "address" } ] },{ "prim": "int" } ], "annots": [ "%thebigmap" ] },{ "prim": "map","args":[ { "prim": "pair","args": [ { "prim": "nat" }, { "prim": "address" } ] },{ "prim": "int" } ], "annots": [ "%themap" ] } ] } ] },{ "prim": "code","args":[ [ { "prim": "DUP" }, { "prim": "CDR" },{ "prim": "NIL", "args": [ { "prim": "operation" } ] },{ "prim": "PAIR" },{ "prim": "DIP", "args": [ [ { "prim": "DROP" } ] ] } ] ] } ]\n\n//signer required for examples in complex_parameter.md\nconst emailExample = "zsjpcmui.oysiavbv@tezos.example.org"\nconst passwordExample = "4rW0D22yXt"\nconst mnemonicExample = "arrange ceiling whisper churn congress double step carpet empty rice prevent swallow silk casual champion"\nconst secretExample = "af552679c4943509bd77643b8ef3f8dcf42e61b3"\n\n// This is the code of the contract use in complex_parameter.md\nconst contractJson = [{"prim":"parameter","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"lambda","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"address","annots":["%owner"]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"option","args":[{"prim":"address"}],"annots":["%address"]},{"prim":"map","args":[{"prim":"string"},{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"address","annots":["%address"]},{"prim":"bool","annots":["%bool"]}]},\n{"prim":"or","args":[{"prim":"bytes","annots":["%bytes"]},{"prim":"int","annots":["%int"]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"key","annots":["%key"]},{"prim":"key_hash","annots":["%key_hash"]}]},{"prim":"or","args":[{"prim":"nat","annots":["%nat"]},{"prim":"signature","annots":["%signature"]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"string","annots":["%string"]},{"prim":"mutez","annots":["%tez"]}]},{"prim":"timestamp","annots":["%timestamp"]}]}]}],"annots":["%data"]}]},{"prim":"pair","args":[{"prim":"address","annots":["%owner"]},{"prim":"option","args":[{"prim":"nat"}],"annots":["%ttl"]}]}]},\n{"prim":"option","args":[{"prim":"nat"}],"annots":["%validator"]}]}],"annots":["%records"]}]},{"prim":"map","args":[{"prim":"nat"},{"prim":"address"}],"annots":["%validators"]}]},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"address","annots":["%owner"]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"option","args":[{"prim":"address"}],"annots":["%address"]},{"prim":"map","args":[{"prim":"string"},{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"address","annots":["%address"]},\n{"prim":"bool","annots":["%bool"]}]},{"prim":"or","args":[{"prim":"bytes","annots":["%bytes"]},{"prim":"int","annots":["%int"]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"key","annots":["%key"]},{"prim":"key_hash","annots":["%key_hash"]}]},{"prim":"or","args":[{"prim":"nat","annots":["%nat"]},{"prim":"signature","annots":["%signature"]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"string","annots":["%string"]},{"prim":"mutez","annots":["%tez"]}]},{"prim":"timestamp","annots":["%timestamp"]}]}]}],"annots":["%data"]}]},{"prim":"pair","args":[{"prim":"address","annots":["%owner"]},\n{"prim":"option","args":[{"prim":"nat"}],"annots":["%ttl"]}]}]},{"prim":"option","args":[{"prim":"nat"}],"annots":["%validator"]}]}],"annots":["%records"]}]},{"prim":"map","args":[{"prim":"nat"},{"prim":"address"}],"annots":["%validators"]}]}],"annots":["%admin_update"]},{"prim":"pair","args":[{"prim":"contract","args":[{"prim":"option","args":[{"prim":"address"}]}],"annots":["%callback"]},{"prim":"bytes","annots":["%name"]}],"annots":["%resolve"]}]},{"prim":"or","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"option","args":[{"prim":"address"}],"annots":["%address"]},\n{"prim":"map","args":[{"prim":"string"},{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"address","annots":["%address"]},{"prim":"bool","annots":["%bool"]}]},{"prim":"or","args":[{"prim":"bytes","annots":["%bytes"]},{"prim":"int","annots":["%int"]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"key","annots":["%key"]},{"prim":"key_hash","annots":["%key_hash"]}]},{"prim":"or","args":[{"prim":"nat","annots":["%nat"]},{"prim":"signature","annots":["%signature"]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"string","annots":["%string"]},{"prim":"mutez","annots":["%tez"]}]},\n{"prim":"timestamp","annots":["%timestamp"]}]}]}],"annots":["%data"]}]},{"prim":"pair","args":[{"prim":"bytes","annots":["%label"]},{"prim":"address","annots":["%owner"]}]}]},{"prim":"pair","args":[{"prim":"bytes","annots":["%parent"]},{"prim":"option","args":[{"prim":"nat"}],"annots":["%ttl"]}]}],"annots":["%set_child_record"]},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"option","args":[{"prim":"address"}],"annots":["%address"]},{"prim":"map","args":[{"prim":"string"},{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"address","annots":["%address"]},\n{"prim":"bool","annots":["%bool"]}]},{"prim":"or","args":[{"prim":"bytes","annots":["%bytes"]},{"prim":"int","annots":["%int"]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"key","annots":["%key"]},{"prim":"key_hash","annots":["%key_hash"]}]},{"prim":"or","args":[{"prim":"nat","annots":["%nat"]},{"prim":"signature","annots":["%signature"]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"string","annots":["%string"]},{"prim":"mutez","annots":["%tez"]}]},{"prim":"timestamp","annots":["%timestamp"]}]}]}],"annots":["%data"]}]},{"prim":"pair","args":[{"prim":"bytes","annots":["%name"]},{"prim":"address","annots":["%owner"]}]}]},\n{"prim":"option","args":[{"prim":"nat"}],"annots":["%ttl"]}],"annots":["%update_record"]}]}]}]},{"prim":"storage","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"address","annots":["%owner"]},{"prim":"big_map","args":[{"prim":"bytes"},{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"pair","args":[{"prim":"option","args":[{"prim":"address"}],"annots":["%address"]},{"prim":"map","args":[{"prim":"string"},{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"or","args":[{"prim":"address","annots":["%address"]},{"prim":"bool","annots":["%bool"]}]},{"prim":"or","args":[{"prim":"bytes","annots":["%bytes"]},\n{"prim":"int","annots":["%int"]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"key","annots":["%key"]},{"prim":"key_hash","annots":["%key_hash"]}]},{"prim":"or","args":[{"prim":"nat","annots":["%nat"]},{"prim":"signature","annots":["%signature"]}]}]}]},{"prim":"or","args":[{"prim":"or","args":[{"prim":"string","annots":["%string"]},{"prim":"mutez","annots":["%tez"]}]},{"prim":"timestamp","annots":["%timestamp"]}]}]}],"annots":["%data"]}]},{"prim":"pair","args":[{"prim":"address","annots":["%owner"]},{"prim":"option","args":[{"prim":"nat"}],"annots":["%ttl"]}]}]},{"prim":"option","args":[{"prim":"nat"}],"annots":["%validator"]}]}],"annots":["%records"]}]},\n{"prim":"map","args":[{"prim":"nat"},{"prim":"address"}],"annots":["%validators"]}]}]},{"prim":"code","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"PUSH","args":[{"prim":"mutez"},{"int":"0"}]},{"prim":"AMOUNT"},{"prim":"COMPARE"},{"prim":"GT"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"AMOUNT_NOT_ZERO"}]},{"prim":"FAILWITH"}],[{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"IF_LEFT","args":[[{"prim":"DUP"},{"prim":"IF_LEFT","args":[[{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},\n{"prim":"DUG","args":[{"int":"2"}]},{"prim":"SWAP"},{"prim":"EXEC"},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DROP"}]]}],[{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"4"}]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"PAIR"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},\n{"prim":"DUG","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"NONE","args":[{"prim":"address"}]}],[{"prim":"DUP"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"mutez"},{"int":"0"}]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"4"}]},{"prim":"TRANSFER_TOKENS"},{"prim":"CONS"},{"prim":"DIP","args":[[{"prim":"DROP","args":[{"int":"3"}]}]]},{"prim":"PAIR"},\n{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]}],[{"prim":"DUP"},{"prim":"IF_LEFT","args":[[{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"PAIR"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"CDR"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"CDR"},{"prim":"CAR"},{"prim":"GET"},\n{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"PARENT_NOT_FOUND"}]},{"prim":"FAILWITH"}],[{"prim":"SENDER"},{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"COMPARE"},{"prim":"NEQ"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"NOT_AUTHORIZED"}]},{"prim":"FAILWITH"}],[{"prim":"PUSH","args":[{"prim":"bytes"},{"bytes":""}]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"4"}]},{"prim":"CDR"},{"prim":"CAR"},{"prim":"COMPARE"},{"prim":"EQ"},\n{"prim":"IF","args":[[{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CAR"}],[{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"CDR"},{"prim":"CAR"},{"prim":"PUSH","args":[{"prim":"bytes"},{"bytes":"2e"}]},{"prim":"CONCAT"},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"4"}]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"CONCAT"}]]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"4"}]},\n{"prim":"CAR"},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"4"}]},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"6"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"7"}]},{"prim":"CDR"},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"7"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"8"}]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"PAIR"},{"prim":"DIG","args":[{"int":"7"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"8"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"8"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"9"}]},{"prim":"CAR"},{"prim":"CAR"},\n{"prim":"CAR"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"SOME"},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"4"}]},{"prim":"UPDATE"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"SWAP"},{"prim":"CAR"},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"DIG","args":[{"int":"3"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"4"}]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},\n{"prim":"DUG","args":[{"int":"3"}]},{"prim":"CDR"},{"prim":"IF_NONE","args":[[{"prim":"NIL","args":[{"prim":"operation"}]}],[{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"DIG","args":[{"int":"7"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"8"}]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"DIG","args":[{"int":"7"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"8"}]},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"CDR"},\n{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"INVALID_VALIDATOR_INDEX"}]},{"prim":"FAILWITH"}],[{"prim":"DUP"},{"prim":"CONTRACT","args":[{"prim":"bytes"}],"annots":["%validate"]},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"INVALID_VALIDATOR_CONTRACT"}]},{"prim":"FAILWITH"}],[{"prim":"DUP"},{"prim":"PUSH","args":[{"prim":"mutez"},{"int":"0"}]},{"prim":"DIG","args":[{"int":"4"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"5"}]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"TRANSFER_TOKENS"},{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},\n{"prim":"DIP","args":[[{"prim":"DROP"}]]},{"prim":"CONS"},{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]}],[{"prim":"DROP"},{"prim":"NIL","args":[{"prim":"operation"}]}]]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"DIP","args":[[{"prim":"DROP","args":[{"int":"4"}]}]]}],[{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"PAIR"},{"prim":"DUP"},{"prim":"CAR"},{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"CDR"},\n{"prim":"DUP"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"GET"},{"prim":"IF_NONE","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"RECORD_NOT_FOUND"}]},{"prim":"FAILWITH"}],[{"prim":"SENDER"},{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"2"}]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"COMPARE"},{"prim":"NEQ"},{"prim":"IF","args":[[{"prim":"PUSH","args":[{"prim":"string"},{"string":"NOT_AUTHORIZED"}]},{"prim":"FAILWITH"}],[{"prim":"DIG","args":[{"int":"1"}]},{"prim":"DUP"},\n{"prim":"DUG","args":[{"int":"2"}]},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"2"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"3"}]},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"5"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"6"}]},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"6"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"7"}]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CDR"},{"prim":"PAIR"},{"prim":"DIG","args":[{"int":"6"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"7"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CDR"},{"prim":"DIG","args":[{"int":"7"}]},\n{"prim":"DUP"},{"prim":"DUG","args":[{"int":"8"}]},{"prim":"CAR"},{"prim":"CAR"},{"prim":"CAR"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"PAIR"},{"prim":"SOME"},{"prim":"DIG","args":[{"int":"5"}]},{"prim":"DUP"},{"prim":"DUG","args":[{"int":"6"}]},{"prim":"CAR"},{"prim":"CDR"},{"prim":"CAR"},{"prim":"UPDATE"},{"prim":"DIP","args":[[{"prim":"DUP"},{"prim":"CDR"},{"prim":"SWAP"},{"prim":"CAR"},{"prim":"CAR"}]]},{"prim":"SWAP"},{"prim":"PAIR"},{"prim":"PAIR"}]]},{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},{"prim":"DIP","args":[[{"prim":"DROP","args":[{"int":"3"}]}]]},{"prim":"NIL","args":[{"prim":"operation"}]},{"prim":"PAIR"},{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]},\n{"prim":"DIP","args":[[{"prim":"DROP"}]]}]]}]]},{"prim":"DIP","args":[[{"prim":"DROP","args":[{"int":"2"}]}]]}]]}]\n\n//contracts for examples of storage with and without annotations\nconst contractStorageAnnot = \n[ { "prim": "parameter", "args": [ { "prim": "unit" } ] },{ "prim": "storage","args":[ { "prim": "pair","args":[ { "prim": "pair","args":[ { "prim": "pair","args":[ { "prim": "address", "annots": [ "%theAddress" ] },{ "prim": "bool", "annots": [ "%theBool" ] } ] },{ "prim": "pair","args":[ { "prim": "nat", "annots": [ "%theNat" ] },{ "prim": "int", "annots": [ "%theNumber" ] } ] } ] },{ "prim": "mutez", "annots": [ "%theTez" ] } ] } ] },{ "prim": "code","args":[ [ { "prim": "DUP" }, { "prim": "CDR" },{ "prim": "NIL", "args": [ { "prim": "operation" } ] },{ "prim": "PAIR" },{ "prim": "DIP", "args": [ [ { "prim": "DROP" } ] ] } ] ] } ]\n\nconst contractStorageWithAndWithoutAnnot =\n[ { "prim": "parameter", "args": [ { "prim": "unit" } ] },{ "prim": "storage","args":[ { "prim": "pair","args":[ { "prim": "pair","args":[ { "prim": "pair","args":[ { "prim": "address"},{ "prim": "bool"} ] },{ "prim": "pair","args":[ { "prim": "nat", "annots": [ "%theNat" ] },{ "prim": "int", "annots": [ "%theNumber" ] } ] } ] },{ "prim": "mutez" } ] } ] },{ "prim": "code","args":[ [ { "prim": "DUP" }, { "prim": "CDR" },{ "prim": "NIL", "args": [ { "prim": "operation" } ] },{ "prim": "PAIR" },{ "prim": "DIP", "args": [ [ { "prim": "DROP" } ] ] } ] ] } ]\n\nconst contractStorageWithoutAnnot =\n[ { "prim": "parameter", "args": [ { "prim": "unit" } ] },{ "prim": "storage","args":[ { "prim": "pair","args":[ { "prim": "pair","args":[ { "prim": "pair","args":[ { "prim": "address"},{ "prim": "bool"} ] },{ "prim": "pair","args":[ { "prim": "nat" },{ "prim": "int" } ] } ] },{ "prim": "mutez" } ] } ] },{ "prim": "code","args":[ [ { "prim": "DUP" }, { "prim": "CDR" },{ "prim": "NIL", "args": [ { "prim": "operation" } ] },{ "prim": "PAIR" },{ "prim": "DIP", "args": [ [ { "prim": "DROP" } ] ] } ] ] } ]\n\nconst managerCode = [{"prim": "parameter","args":[{"prim": "or","args":[{"prim": "lambda","args":[{ "prim": "unit" },{"prim": "list","args": [{ "prim": "operation" }]}],"annots": ["%do"]},{ "prim": "unit", "annots": ["%default"] }]}]},{ "prim": "storage", "args": [{ "prim": "key_hash" }] },{"prim": "code","args":[[[[{ "prim": "DUP" }, { "prim": "CAR" },{"prim": "DIP","args": [[{ "prim": "CDR" }]]}]],{"prim": "IF_LEFT","args":[[{"prim": "PUSH","args":[{ "prim": "mutez" },{ "int": "0" }]},{ "prim": "AMOUNT" },[[{ "prim": "COMPARE" },{ "prim": "EQ" }],{"prim": "IF","args":[[],[[{ "prim": "UNIT" },{ "prim": "FAILWITH" }]]]}],\n[{"prim": "DIP","args": [[{ "prim": "DUP" }]]},{ "prim": "SWAP" }],{ "prim": "IMPLICIT_ACCOUNT" },{ "prim": "ADDRESS" },{ "prim": "SENDER" },[[{ "prim": "COMPARE" },{ "prim": "EQ" }],{"prim": "IF","args":[[],[[{ "prim": "UNIT" },{ "prim": "FAILWITH" }]]]}],{ "prim": "UNIT" }, { "prim": "EXEC" },{ "prim": "PAIR" }],[{ "prim": "DROP" },{"prim": "NIL","args": [{ "prim": "operation" }]},{ "prim": "PAIR" }]]}]]}]\n\n';this.transpile({code:i,scope:r,transformCode:e,noInline:n})},r}(st.d);var lt=function(t){var r=t.children,e=t.theme,a=t.transformCode,o=Object(i.a)(t,["children","theme","transformCode"]),s=Object(at.useState)(!1),c=s[0],u=s[1],p=Object(at.useRef)(null),l=Object(at.useRef)(null);return Object(at.useEffect)((function(){var t;return l.current&&(t=new it.a(l.current,{text:function(){return p.current.code}})),function(){t&&t.destroy()}}),[l.current,p.current]),ot.a.createElement(pt,Object(n.a)({ref:p,code:r,transformCode:a||function(t){return t+";"},theme:e},o),ot.a.createElement("div",{className:ut.a.playgroundEditorWrapper},ot.a.createElement("div",{className:et()(ut.a.playgroundHeader,ut.a.playgroundEditorHeader)},"Live Editor"),ot.a.createElement(st.a,null),ot.a.createElement("button",{ref:l,type:"button","aria-label":"Copy code to clipboard",className:et()(ut.a.button,ut.a.copyButton),onClick:function(){window.getSelection().empty(),u(!0),setTimeout((function(){return u(!1)}),2e3)}},c?"Copied":"Copy")),ot.a.createElement("div",{className:et()(ut.a.playgroundHeader,ut.a.playgroundPreviewHeader)},"Result",ot.a.createElement("button",{type:"button","aria-label":"Execute example",className:et()(ut.a.button,ut.a.runButton),onClick:function(){p.current&&p.current.run()}},"Run code")),ot.a.createElement("div",{className:ut.a.playgroundPreview},ot.a.createElement(st.c,null),ot.a.createElement(st.b,null)))},ht=e(793),ft=e.n(ht),mt=e(426),dt=e(794),gt=e(71),vt=e.n(gt),yt=/{([\d,-]+)}/;r.a=function(t){var r=t.children,e=t.className,s=t.live,c=t.metastring,p=Object(i.a)(t,["children","className","live","metastring"]),l=Object(a.default)().siteConfig.themeConfig.prism,h=void 0===l?{}:l,f=Object(at.useState)(!1),m=f[0],d=f[1],g=Object(at.useRef)(null),v=Object(at.useRef)(null),y=[];if(c&&yt.test(c)){var b=c.match(yt)[1];y=ft.a.parse(b).filter((function(t){return t>0}))}if(Object(at.useEffect)((function(){var t;return v.current&&(t=new it.a(v.current,{target:function(){return g.current}})),function(){t&&t.destroy()}}),[v.current,g.current]),s){var E=new o.e("https://api.tez.ie/rpc/delphinet"),w=new k({name:"exampleWallet"});return ot.a.createElement(lt,Object(n.a)({scope:Object.assign({},ot.a,{Tezos:E,wallet:w,importKey:P,validateAddress:u.o,validateChain:u.p,validateKeyHash:u.r,validateContractAddress:u.q,validatePublicKey:u.s,validateSignature:u.t,b58cencode:u.d,prefix:u.n,Prefix:u.a,MichelsonMap:o.b,BeaconWallet:k,InMemorySigner:T,LedgerSigner:x.b,Tzip16Module:G.e,tzip16:G.g,bytes2Char:G.f,MichelsonStorageView:G.c,Tzip12Module:Z,tzip12:J,TezBridgeWallet:M,ThanosWallet:X.a,DerivationType:x.a,TransportU2F:$.a,compose:o.f}),code:r.trim(),theme:h.theme||dt.a,transformCode:function(t){return t.replace(/import .*/g,"")}},p))}var O=e&&e.replace(/language-/,"");!O&&h.defaultLanguage&&(O=h.defaultLanguage);var A=function(){window.getSelection().empty(),d(!0),setTimeout((function(){return d(!1)}),2e3)};return ot.a.createElement(mt.a,Object(n.a)({},mt.b,{theme:h.theme||dt.a,code:r.trim(),language:O}),(function(t){var r=t.className,e=t.style,i=t.tokens,a=t.getLineProps,o=t.getTokenProps;return ot.a.createElement("div",{className:vt.a.codeBlockWrapper},ot.a.createElement("pre",{ref:g,className:et()(r,vt.a.codeBlock),style:e},i.map((function(t,r){var e=a({line:t,key:r});return y.includes(r+1)&&(e.className=e.className+" docusaurus-highlight-code-line"),ot.a.createElement("div",Object(n.a)({key:r},e),t.map((function(t,r){return ot.a.createElement("span",Object(n.a)({key:r},o({token:t,key:r})))})))}))),ot.a.createElement("button",{ref:v,type:"button","aria-label":"Copy code to clipboard",className:vt.a.copyButton,onClick:A},m?"Copied":"Copy"))}))}}}]);